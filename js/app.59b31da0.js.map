{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/CanvasBox.vue?c72c","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/data/weather.filtered.csv","webpack:///./src/App.vue?d96c","webpack:///./src/core/utils.ts","webpack:///./src/components/CanvasBox.vue?3679","webpack:///./src/store/index.js","webpack:///./src/components/expandRow.vue?8aa9","webpack:///src/components/expandRow.vue","webpack:///./src/components/expandRow.vue?624d","webpack:///./src/components/expandRow.vue","webpack:///./src/core/util.js","webpack:///./src/core/kdtree.js","webpack:///src/components/CanvasBox.vue","webpack:///./src/components/CanvasBox.vue?a571","webpack:///./src/components/CanvasBox.vue","webpack:///./src/core/data-gen.ts","webpack:///src/App.vue","webpack:///./src/App.vue?a7d1","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/data/reading.filtered.csv","webpack:///./src/App.vue?f446","webpack:///./src/components/expandRow.vue?9378","webpack:///./src/data/airline.filtered.csv","webpack:///./src/data/mergeSMART194month.filtered.csv","webpack:///./src/data/stocks.filtered.csv"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","map","webpackContext","req","id","webpackContextResolve","e","Error","code","keys","resolve","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","on","eventHandler","directives","rawName","expression","ref","readFileHandler","slot","style","width","margin","padding","display","flexDirection","staticStyle","$event","model","callback","$$v","aggregateAttr","_l","attr","_s","timeAttr","inferTypes","_e","valueAttr","canvasWidth","canvasHeight","headers","generateCharts","exportFig","exportData","chartConfigs","config","aggregateName","timeName","valueName","height","timeIndex","valueIndex","filter","layers","handleFilterChange","staticRenderFns","exportCanvas","canvas","upsideDown","opacityConfig","document","createElement","context","getContext","scale","console","log","cvs","globalAlpha","drawImage","exportBtn","href","toDataURL","replace","download","click","option","canvasMousedown","canvasMouseup","canvasMousemove","canvasWheel","mouseContextmenu","canvasMouseleave","filterMode","attributeColumn","header","title","attributeData","handleSearch","attributeValue","addAttrQuery","_m","rawMode","repCount","maxDiverse","cnt","diverse","colormapIndexCache","maxDensity","layer","opacity","$set","colormapOverlayIndexCache","maxOverlayDensity","showCursorValue","normalizeDensity","enlargeFont","calClassName","tableColumns","tableData","hoveringQuery","scopedSlots","_u","fn","row","index","query","selectedQuery","deleteQuery","deleteAllQuery","repModal","repColumns","repStaticInformation","aggregatedData","interResult","unionResult","querys","repIds","weightCache","background","color","showData","props","Array","methods","$Modal","info","closable","render","align","$nextTick","then","svg","component","require","default","mix","point1","point2","x","Math","max","min","y","getAngle2","atan","sqr","dist2","v","w","eq","abs","updatePoint","oldPoint","testPoint","newPoint","movePoint","point","offsetX","offsetY","distToSegmentSquared","l2","lineRectCollide","line","rect","x1","y1","p2","x2","y2","q","q2","lineSegmentsCollide","p0","p1","p3","unknownA","unknownB","denominator","isIntersecting","calculateCurvature","points","step1","step2","step","lstPoint","nxtPoint","f1","f2","isNaN","pow","calculateDifference","line1","line2","sum","pos1","pos2","brensenhamArr","ls","hashmap","lineId","slope","xx","floor","yy","brensenhamArrHigh","brensenhamArrLow","x0","y0","delta","isFinite","dx","dy","yi","D","first","xi","kdparam","deg","b","k","cuveq","globalHashCache","CCHTree","lines","precision","tsrd","pos","undefined","cuv","offsets","sizes","fastID","lineID","segIndex","totalPoints","reduce","maxPoints","lineIndexType","Uint32Array","Uint16Array","pointIndexType","sizeType","Uint8Array","Float32Array","pointer","forEach","computeCurvature","size","beginIndex","endIndex","splitIntoSegmentsByMaximumDistance","distance","pointDist","right","pointSub","left","z","allci","curSegIndex","ci","aabb","from","to","sp","updateAABB","lastIndex","cs","stacks","segMapping","Map","si","minv","maxv","pointMin","a","pointMax","leftResult","rightResult","allc2","countSegs","pass","dim","expectPos","level","startDim","endDim","dimIndex","dim2xyz","candidates","candidatePos","cpos1","cpos2","getMidWeightedVal","splitCurves","leftC2","rightC2","leftCurveCount","rightCurveCount","cost","computeCost","root","connectNode","pop","segs","nl","currIndex","mapKey","diff","lid","set","Heap","toArray","values","lo","hi","Set","Infinity","removal","has","node","top","search","seg","ap","dir","len","sqrt","pointDot","pointDiv","dv","dis","pointDist2D","pointAdd","pointMul","obj","heap","pushpop","updateItem","s1","s2","skipLeft","skipRight","add","cosC","sinC","curvature","scalar","pointNormalize","threshold","applySegment","beginPos","endPos","maximumDis","bestIndex","curPos","abLen","curDis","org","count","weight","sort","resultLeft","resultRight","temp","candidateIndex","newci","lastNewci","curIsLeft","changed","checkSpUnion","lc","canUnion","shiftFlag","popFlag","ai","bi","cosLimit","cos","PI","dirAB","dirBC","cosValue","factor","leftV","leftRatio","rightV","rightRatio","cost1","cost2","father","isLeft","Number","String","components","draggable","contextHandler","canvasContext","rawLineContext","brushMethod","calculatedMaxDiverse","cursor","mouseDown","listener","hoverListener","hoveringInd","coord","boxes","rawLines","colorMap","previewIndex","initDensityCache","initDensityBufferCache","initDensityMaxCache","currentDensityMax","currentDensity","distanceCache","colorCache","preview","modify","mark","selectionLayerContext","repLayerContext","rawLinesLayerContext","mouseLayerContext","queryResult","xScale","yScaleC","yScale","cursorHelper","tr","renderSelectedDensity","computed","rawLineNames","upsideDownFactor","previewData","brush","ang","knn","rnn","hover","res","_expanded","mp","reps","watch","newValue","select","renderColorMap","renderAllDensity","renderColorMapOverlay","renderDensity","renderBoxes","deep","handler","rearrangeLayer","setReverseY","rerender","getTopK","oldV","initCanvas","clearTimeout","oldValue","clearRect","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","convertPoint","reconvertPoint","inRadius","ids","leaveQuery","datas","hovering","type","ind","val","flag","setTimeout","button","cache","box","instance","lastPos","startPoint","onBorder","start","end","time","timeEnd","preventDefault","renderAxisHelper","findBox","radius","hoverLines","kArray","$refs","removeEventListener","addEventListener","findKTop","resetFilter","$emit","startMouse","startFilter","drawBoxes","cursorShape","moveMouse","movementX","movementY","fillStyle","fillRect","offset","fill","bottom","filterResult","angleConfirm","showRepData","hightlightRow","ret","calcLineDistance","aid","bid","aPointer","bPointer","aLine","bLine","drawRawLines","shuffle","drawLineWithLayer","renderQuerys","ctner","innerHTML","icon","borderRadius","borderBottom","borderRight","borderLeft","borderTop","desc","innerText","conf","confInput","parseFloat","append","del","element","border","hoverBox","appendChild","colorSpan","renderResult","getElementById","renderBox","base","minY","maxY","yyds","endX","slopeBase","angBase","angMax","angMin","slopeMax","tan","slopeMin","endYMax","endYMin","tmpQueries","result1","result2","drawLine","selectedIds","getSelectedIds","selectAll","each","_","d3","text","getColorMap","colormaps","rgb","colorMapCache","round","colormap","pixelCache","initFlag","tempBuffer","bgContext","maxWeight","ratio","tempImageBuffer","putImageData","tempImageData","getImageData","renderFlag","ele","zIndex","range","transform","scaleY","remove","getStaticInformation","minT","maxT","minV","toFixed","maxV","mean","var","variance","getColor","luminance","g","contrast","rgb1","rgb2","lum1","lum2","brightest","darkest","calcRepLines","lineWeights","topIds","calcLineWeight","passedPixels","px","lineLen","errC","err","sx","sy","hasBrush","mounted","sets","column","headerMap","minX","maxX","copy","conversion2","xScaleData","conversion","ee","tableId","path","counter","beforeDestroy","destroy","thisArg","_arguments","P","generator","adopt","Promise","reject","next","rejected","done","body","f","label","sent","trys","ops","verb","iterator","op","TypeError","exampleDataURL","generateData","idx","_a","skip_empty_lines","readData","file","reader","FileReader","onload","readAsText","parseField","Date","CanvasBox","filters","$Spin","show","startsWith","split","upload","handleClick","hide","preProcessData","includes","isDate","test","indexOf","aggrMap","aggrKey","aggrList","clear","find","raw","previousId","previousName","Vue","use","iView","locale","productionTip","h","App","$mount","gl","debugInfo","getExtension","getParameter","UNMASKED_RENDERER_WEBGL","toLowerCase"],"mappings":"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okB,SAASC,GACdvgB,QAAQqb,QAAQ,0CAGhBrb,QAAQC,IAAI,kCAGdugB,eA/7CJ,SA+7CA,GAEM,MAAqC,kBAAvBtkB,KAAKkH,cAAzB,eACA,oCACA,4BACA,cACA,eAGImY,iBAx8CJ,SAw8CA,GACM,IAAN,YACA,qDACA,wBACA,0CAEA,EACA,iBACA,6BACA,aAEA,kBACA,mBACA,WACA,UACA,UACA,8CACUrf,KAAKqG,iBACPrG,KAAKob,aAAamJ,UAAU,QAAQC,MAAK,SAAUC,EAAG3oB,GACpD4oB,EAAV,WACA,qBACA,yCACA,aACA,sBACA,gCAAY,OAAZ,YAGQ1kB,KAAKob,aAAamJ,UAAU,QAAQC,MAAK,SAAUC,EAAG3oB,GACpD4oB,EAAV,WACA,sCACA,KACA,IACA,kDAEA,2BACA,+BAGQ1kB,KAAKob,aACb,kBACA,aACA,aACA,aACA,aAEQpb,KAAKob,aAAamJ,UAAU,QAAQI,KAAK,MAI7CC,YAz/CJ,WAy/CA,8DACA,GACA,CACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,YACA,YACA,YACA,WAEA,CACA,cACA,cACA,cACA,aACA,aACA,aACA,aACA,aACA,YACA,WACA,SAEA,CACA,cACA,aACA,aACA,aACA,YACA,YACA,aACA,aACA,YACA,WACA,SAEA,CACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,aACA,YACA,WACA,YAEA,CACA,aACA,aACA,cACA,cACA,cACA,cACA,cACA,YACA,YACA,YACA,WAEA,CACA,WACA,WACA,YACA,aACA,aACA,aACA,aACA,aACA,aACA,YACA,YAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,YACA,YACA,YACA,YAEA,CACA,cACA,cACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,cAEA,CACA,cACA,aACA,aACA,aACA,aACA,YACA,YACA,YACA,YACA,YACA,aAEA,CACA,cACA,aACA,aACA,aACA,aACA,aACA,YACA,YACA,YACA,YACA,aAEA,CACA,cACA,aACA,aACA,aACA,aACA,aACA,YACA,YACA,YACA,YACA,aAEA,CACA,cACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,aACA,aAEA,CACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,YACA,YACA,YACA,WAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,YACA,YACA,WAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,aACA,WACA,YAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,YACA,WACA,YAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,YACA,YACA,aAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,aACA,aACA,YACA,YACA,aAEA,CACA,cACA,cACA,cACA,cACA,cACA,aACA,YACA,YACA,YACA,YACA,WAEA,CACA,cACA,cACA,aACA,aACA,aACA,aACA,aACA,YACA,WACA,WACA,YAEA,CACA,cACA,cACA,aACA,aACA,aACA,aACA,YACA,YACA,YACA,YACA,aAGM,OAAOC,EACb,2DAIItI,eAlxDJ,WAoxDM9Y,SAASwf,eACf,aACA,iBAFA,oCAEA,mBACA,KACA,gBAAQ,MAAR,cACA,aADA,cACA,4BACA,GAFA,QAKA,WATA,MAYIxG,sBAhyDJ,WAkyDMhZ,SAASwf,eACf,qBACA,iBAFA,oCAEA,qBACA,KACA,gBAAQ,MAAR,cACA,aADA,cACA,4BACA,GAFA,QAKA,WATA,MAYI6B,IA9yDJ,SA8yDA,mEACA,IACA,+BACA,wBACM,GAAN,yDACQ,OAAOC,GAAcpU,GAAIxH,KAAK6b,MAAU,IAAJlpB,IAEtC,IAAN,sBACA,mBACM,GAAIA,GAAK,EAAG,OAAOmpB,EAAS,GAC5B,GAAInpB,GAAK,EAAG,OAAOmpB,EAAS,SACLtW,IAAnBsW,EAAS9B,IAAqBrf,QAAQC,IAAIkhB,EAAU9B,EAAMrnB,GAC9D,IAAN,YACA,cAAQ,OAAR,4BAMM,OAJKipB,GAAcpU,KACjBoU,GAAcpU,GAAM,IAEtBoU,GAAcpU,GAAIxH,KAAK6b,MAAU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","file":"js/app.59b31da0.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CanvasBox.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CanvasBox.vue?vue&type=style&index=0&lang=scss&\"","var map = {\n\t\"./af\": \"2bfb\",\n\t\"./af.js\": \"2bfb\",\n\t\"./ar\": \"8e73\",\n\t\"./ar-dz\": \"a356\",\n\t\"./ar-dz.js\": \"a356\",\n\t\"./ar-kw\": \"423e\",\n\t\"./ar-kw.js\": \"423e\",\n\t\"./ar-ly\": \"1cfd\",\n\t\"./ar-ly.js\": \"1cfd\",\n\t\"./ar-ma\": \"0a84\",\n\t\"./ar-ma.js\": \"0a84\",\n\t\"./ar-sa\": \"8230\",\n\t\"./ar-sa.js\": \"8230\",\n\t\"./ar-tn\": \"6d83\",\n\t\"./ar-tn.js\": \"6d83\",\n\t\"./ar.js\": \"8e73\",\n\t\"./az\": \"485c\",\n\t\"./az.js\": \"485c\",\n\t\"./be\": \"1fc1\",\n\t\"./be.js\": \"1fc1\",\n\t\"./bg\": \"84aa\",\n\t\"./bg.js\": \"84aa\",\n\t\"./bm\": \"a7fa\",\n\t\"./bm.js\": \"a7fa\",\n\t\"./bn\": \"9043\",\n\t\"./bn-bd\": \"9686\",\n\t\"./bn-bd.js\": \"9686\",\n\t\"./bn.js\": \"9043\",\n\t\"./bo\": \"d26a\",\n\t\"./bo.js\": \"d26a\",\n\t\"./br\": \"6887\",\n\t\"./br.js\": \"6887\",\n\t\"./bs\": \"2554\",\n\t\"./bs.js\": \"2554\",\n\t\"./ca\": \"d716\",\n\t\"./ca.js\": \"d716\",\n\t\"./cs\": \"3c0d\",\n\t\"./cs.js\": \"3c0d\",\n\t\"./cv\": \"03ec\",\n\t\"./cv.js\": \"03ec\",\n\t\"./cy\": \"9797\",\n\t\"./cy.js\": \"9797\",\n\t\"./da\": \"0f14\",\n\t\"./da.js\": \"0f14\",\n\t\"./de\": \"b469\",\n\t\"./de-at\": \"b3eb\",\n\t\"./de-at.js\": \"b3eb\",\n\t\"./de-ch\": \"bb71\",\n\t\"./de-ch.js\": \"bb71\",\n\t\"./de.js\": \"b469\",\n\t\"./dv\": \"598a\",\n\t\"./dv.js\": \"598a\",\n\t\"./el\": \"8d47\",\n\t\"./el.js\": \"8d47\",\n\t\"./en-au\": \"0e6b\",\n\t\"./en-au.js\": \"0e6b\",\n\t\"./en-ca\": \"3886\",\n\t\"./en-ca.js\": \"3886\",\n\t\"./en-gb\": \"39a6\",\n\t\"./en-gb.js\": \"39a6\",\n\t\"./en-ie\": \"e1d3\",\n\t\"./en-ie.js\": \"e1d3\",\n\t\"./en-il\": \"7333\",\n\t\"./en-il.js\": \"7333\",\n\t\"./en-in\": \"ec2e\",\n\t\"./en-in.js\": \"ec2e\",\n\t\"./en-nz\": \"6f50\",\n\t\"./en-nz.js\": \"6f50\",\n\t\"./en-sg\": \"b7e9\",\n\t\"./en-sg.js\": \"b7e9\",\n\t\"./eo\": \"65db\",\n\t\"./eo.js\": \"65db\",\n\t\"./es\": \"898b\",\n\t\"./es-do\": \"0a3c\",\n\t\"./es-do.js\": \"0a3c\",\n\t\"./es-mx\": \"b5b7\",\n\t\"./es-mx.js\": \"b5b7\",\n\t\"./es-us\": \"55c9\",\n\t\"./es-us.js\": \"55c9\",\n\t\"./es.js\": \"898b\",\n\t\"./et\": \"ec18\",\n\t\"./et.js\": \"ec18\",\n\t\"./eu\": \"0ff2\",\n\t\"./eu.js\": \"0ff2\",\n\t\"./fa\": \"8df4\",\n\t\"./fa.js\": \"8df4\",\n\t\"./fi\": \"81e9\",\n\t\"./fi.js\": \"81e9\",\n\t\"./fil\": \"d69a\",\n\t\"./fil.js\": \"d69a\",\n\t\"./fo\": \"0721\",\n\t\"./fo.js\": \"0721\",\n\t\"./fr\": \"9f26\",\n\t\"./fr-ca\": \"d9f8\",\n\t\"./fr-ca.js\": \"d9f8\",\n\t\"./fr-ch\": \"0e49\",\n\t\"./fr-ch.js\": \"0e49\",\n\t\"./fr.js\": \"9f26\",\n\t\"./fy\": \"7118\",\n\t\"./fy.js\": \"7118\",\n\t\"./ga\": \"5120\",\n\t\"./ga.js\": \"5120\",\n\t\"./gd\": \"f6b4\",\n\t\"./gd.js\": \"f6b4\",\n\t\"./gl\": \"8840\",\n\t\"./gl.js\": \"8840\",\n\t\"./gom-deva\": \"aaf2\",\n\t\"./gom-deva.js\": \"aaf2\",\n\t\"./gom-latn\": \"0caa\",\n\t\"./gom-latn.js\": \"0caa\",\n\t\"./gu\": \"e0c5\",\n\t\"./gu.js\": \"e0c5\",\n\t\"./he\": \"c7aa\",\n\t\"./he.js\": \"c7aa\",\n\t\"./hi\": \"dc4d\",\n\t\"./hi.js\": \"dc4d\",\n\t\"./hr\": \"4ba9\",\n\t\"./hr.js\": \"4ba9\",\n\t\"./hu\": \"5b14\",\n\t\"./hu.js\": \"5b14\",\n\t\"./hy-am\": \"d6b6\",\n\t\"./hy-am.js\": \"d6b6\",\n\t\"./id\": \"5038\",\n\t\"./id.js\": \"5038\",\n\t\"./is\": \"0558\",\n\t\"./is.js\": \"0558\",\n\t\"./it\": \"6e98\",\n\t\"./it-ch\": \"6f12\",\n\t\"./it-ch.js\": \"6f12\",\n\t\"./it.js\": \"6e98\",\n\t\"./ja\": \"079e\",\n\t\"./ja.js\": \"079e\",\n\t\"./jv\": \"b540\",\n\t\"./jv.js\": \"b540\",\n\t\"./ka\": \"201b\",\n\t\"./ka.js\": \"201b\",\n\t\"./kk\": \"6d79\",\n\t\"./kk.js\": \"6d79\",\n\t\"./km\": \"e81d\",\n\t\"./km.js\": \"e81d\",\n\t\"./kn\": \"3e92\",\n\t\"./kn.js\": \"3e92\",\n\t\"./ko\": \"22f8\",\n\t\"./ko.js\": \"22f8\",\n\t\"./ku\": \"2421\",\n\t\"./ku.js\": \"2421\",\n\t\"./ky\": \"9609\",\n\t\"./ky.js\": \"9609\",\n\t\"./lb\": \"440c\",\n\t\"./lb.js\": \"440c\",\n\t\"./lo\": \"b29d\",\n\t\"./lo.js\": \"b29d\",\n\t\"./lt\": \"26f9\",\n\t\"./lt.js\": \"26f9\",\n\t\"./lv\": \"b97c\",\n\t\"./lv.js\": \"b97c\",\n\t\"./me\": \"293c\",\n\t\"./me.js\": \"293c\",\n\t\"./mi\": \"688b\",\n\t\"./mi.js\": \"688b\",\n\t\"./mk\": \"6909\",\n\t\"./mk.js\": \"6909\",\n\t\"./ml\": \"02fb\",\n\t\"./ml.js\": \"02fb\",\n\t\"./mn\": \"958b\",\n\t\"./mn.js\": \"958b\",\n\t\"./mr\": \"39bd\",\n\t\"./mr.js\": \"39bd\",\n\t\"./ms\": \"ebe4\",\n\t\"./ms-my\": \"6403\",\n\t\"./ms-my.js\": \"6403\",\n\t\"./ms.js\": \"ebe4\",\n\t\"./mt\": \"1b45\",\n\t\"./mt.js\": \"1b45\",\n\t\"./my\": \"8689\",\n\t\"./my.js\": \"8689\",\n\t\"./nb\": \"6ce3\",\n\t\"./nb.js\": \"6ce3\",\n\t\"./ne\": \"3a39\",\n\t\"./ne.js\": \"3a39\",\n\t\"./nl\": \"facd\",\n\t\"./nl-be\": \"db29\",\n\t\"./nl-be.js\": \"db29\",\n\t\"./nl.js\": \"facd\",\n\t\"./nn\": \"b84c\",\n\t\"./nn.js\": \"b84c\",\n\t\"./oc-lnc\": \"167b\",\n\t\"./oc-lnc.js\": \"167b\",\n\t\"./pa-in\": \"f3ff\",\n\t\"./pa-in.js\": \"f3ff\",\n\t\"./pl\": \"8d57\",\n\t\"./pl.js\": \"8d57\",\n\t\"./pt\": \"f260\",\n\t\"./pt-br\": \"d2d4\",\n\t\"./pt-br.js\": \"d2d4\",\n\t\"./pt.js\": \"f260\",\n\t\"./ro\": \"972c\",\n\t\"./ro.js\": \"972c\",\n\t\"./ru\": \"957c\",\n\t\"./ru.js\": \"957c\",\n\t\"./sd\": \"6784\",\n\t\"./sd.js\": \"6784\",\n\t\"./se\": \"ffff\",\n\t\"./se.js\": \"ffff\",\n\t\"./si\": \"eda5\",\n\t\"./si.js\": \"eda5\",\n\t\"./sk\": \"7be6\",\n\t\"./sk.js\": \"7be6\",\n\t\"./sl\": \"8155\",\n\t\"./sl.js\": \"8155\",\n\t\"./sq\": \"c8f3\",\n\t\"./sq.js\": \"c8f3\",\n\t\"./sr\": \"cf1e\",\n\t\"./sr-cyrl\": \"13e9\",\n\t\"./sr-cyrl.js\": \"13e9\",\n\t\"./sr.js\": \"cf1e\",\n\t\"./ss\": \"52bd\",\n\t\"./ss.js\": \"52bd\",\n\t\"./sv\": \"5fbd\",\n\t\"./sv.js\": \"5fbd\",\n\t\"./sw\": \"74dc\",\n\t\"./sw.js\": \"74dc\",\n\t\"./ta\": \"3de5\",\n\t\"./ta.js\": \"3de5\",\n\t\"./te\": \"5cbb\",\n\t\"./te.js\": \"5cbb\",\n\t\"./tet\": \"576c\",\n\t\"./tet.js\": \"576c\",\n\t\"./tg\": \"3b1b\",\n\t\"./tg.js\": \"3b1b\",\n\t\"./th\": \"10e8\",\n\t\"./th.js\": \"10e8\",\n\t\"./tk\": \"5aff\",\n\t\"./tk.js\": \"5aff\",\n\t\"./tl-ph\": \"0f38\",\n\t\"./tl-ph.js\": \"0f38\",\n\t\"./tlh\": \"cf75\",\n\t\"./tlh.js\": \"cf75\",\n\t\"./tr\": \"0e81\",\n\t\"./tr.js\": \"0e81\",\n\t\"./tzl\": \"cf51\",\n\t\"./tzl.js\": \"cf51\",\n\t\"./tzm\": \"c109\",\n\t\"./tzm-latn\": \"b53d\",\n\t\"./tzm-latn.js\": \"b53d\",\n\t\"./tzm.js\": \"c109\",\n\t\"./ug-cn\": \"6117\",\n\t\"./ug-cn.js\": \"6117\",\n\t\"./uk\": \"ada2\",\n\t\"./uk.js\": \"ada2\",\n\t\"./ur\": \"5294\",\n\t\"./ur.js\": \"5294\",\n\t\"./uz\": \"2e8c\",\n\t\"./uz-latn\": \"010e\",\n\t\"./uz-latn.js\": \"010e\",\n\t\"./uz.js\": \"2e8c\",\n\t\"./vi\": \"2921\",\n\t\"./vi.js\": \"2921\",\n\t\"./x-pseudo\": \"fd7e\",\n\t\"./x-pseudo.js\": \"fd7e\",\n\t\"./yo\": \"7f33\",\n\t\"./yo.js\": \"7f33\",\n\t\"./zh-cn\": \"5c3a\",\n\t\"./zh-cn.js\": \"5c3a\",\n\t\"./zh-hk\": \"49ab\",\n\t\"./zh-hk.js\": \"49ab\",\n\t\"./zh-mo\": \"3a6c\",\n\t\"./zh-mo.js\": \"3a6c\",\n\t\"./zh-tw\": \"90ea\",\n\t\"./zh-tw.js\": \"90ea\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"4678\";","export default __webpack_public_path__ + \"e452c15f48fdd4b19f51a37672e837f7.csv\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('Layout',[_c('Header',[_c('h1',{staticClass:\"layout-logo\"},[_vm._v(\"KD-Box\")]),_c('Menu',{attrs:{\"mode\":\"horizontal\",\"theme\":\"dark\"},on:{\"on-select\":_vm.eventHandler}},[_c('div',{staticClass:\"layout-nav\"},[_c('Upload',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}],ref:\"upload\",attrs:{\"action\":\"/\",\"before-upload\":_vm.readFileHandler}}),_c('Submenu',{attrs:{\"name\":\"3\"}},[_c('template',{slot:\"title\"},[_c('Icon',{attrs:{\"type\":\"ios-archive\"}}),_vm._v(\" Example data \")],1),_c('MenuItem',{attrs:{\"name\":\"1-1\"}},[_vm._v(\"Stocks(25.2MB)\")]),_c('MenuItem',{attrs:{\"name\":\"1-2\"}},[_vm._v(\"Airline(10.6MB)\")]),_c('MenuItem',{attrs:{\"name\":\"1-3\"}},[_vm._v(\"Weather(29.6MB)\")]),_c('MenuItem',{attrs:{\"name\":\"1-4\"}},[_vm._v(\"Reading(18.5MB)\")]),_c('MenuItem',{attrs:{\"name\":\"1-5\"}},[_vm._v(\"HardDrive(66.3MB)\")])],2),_c('MenuItem',{attrs:{\"name\":\"2\"}},[_c('Icon',{attrs:{\"type\":\"ios-cloud-upload-outline\"}}),_vm._v(\" Load data \")],1)],1)])],1),_c('Content',{style:({\n        width: '1850px',\n        margin: '0 auto',\n        padding: '0 50px',\n        display: 'flex',\n        flexDirection: 'row',\n      })},[_c('Card',{staticClass:\"sticky-content\"},[_c('div',[_c('Button',{staticStyle:{\"width\":\"200px\"},attrs:{\"type\":\"info\"},on:{\"click\":function($event){return _vm.eventHandler('2')}}},[_c('Icon',{attrs:{\"type\":\"ios-cloud-upload-outline\"}}),_vm._v(\" Load data \")],1),_c('Poptip',{staticStyle:{\"width\":\"200px\",\"display\":\"block\"}},[_c('Button',{staticStyle:{\"width\":\"200px\"}},[_vm._v(\"Example Data\")]),_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"column\"},attrs:{\"slot\":\"content\"},slot:\"content\"},[_c('Button',{staticStyle:{\"width\":\"200px\"},on:{\"click\":function($event){return _vm.eventHandler('1-1')}}},[_vm._v(\"Stocks(25.2MB)\")]),_c('Button',{staticStyle:{\"width\":\"200px\"},on:{\"click\":function($event){return _vm.eventHandler('1-2')}}},[_vm._v(\"Airline(10.6MB)\")]),_c('Button',{staticStyle:{\"width\":\"200px\"},on:{\"click\":function($event){return _vm.eventHandler('1-3')}}},[_vm._v(\"Weather(29.6MB)\")]),_c('Button',{staticStyle:{\"width\":\"200px\"},on:{\"click\":function($event){return _vm.eventHandler('1-4')}}},[_vm._v(\"Reading(18.5MB)\")]),_c('Button',{staticStyle:{\"width\":\"200px\"},on:{\"click\":function($event){return _vm.eventHandler('1-5')}}},[_vm._v(\"HardDrive(66.3MB)\")])],1)],1),_c('Upload',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}],ref:\"upload\",attrs:{\"action\":\"/\",\"before-upload\":_vm.readFileHandler}}),_c('p',{staticStyle:{\"margin-top\":\"100px\"}},[_vm._v(\"Line Aggregation Attribute:\")]),_c('Select',{staticStyle:{\"width\":\"200px\"},model:{value:(_vm.aggregateAttr),callback:function ($$v) {_vm.aggregateAttr=$$v},expression:\"aggregateAttr\"}},_vm._l((_vm.headers),function(attr,i){return _c('Option',{key:i,attrs:{\"value\":i}},[_vm._v(_vm._s(attr)+\" \")])}),1),_c('p',[_vm._v(\"Time Attribute:\")]),_c('Select',{staticStyle:{\"width\":\"200px\"},model:{value:(_vm.timeAttr),callback:function ($$v) {_vm.timeAttr=$$v},expression:\"timeAttr\"}},[_vm._l((_vm.headers),function(attr,i){return [(_vm.inferTypes[i] != 'string')?_c('Option',{key:i,attrs:{\"value\":i}},[_vm._v(_vm._s(attr)+\" \")]):_vm._e()]})],2),_c('p',[_vm._v(\"Value Attribute:\")]),_c('Select',{staticStyle:{\"width\":\"200px\"},model:{value:(_vm.valueAttr),callback:function ($$v) {_vm.valueAttr=$$v},expression:\"valueAttr\"}},[_vm._l((_vm.headers),function(attr,i){return [(_vm.inferTypes[i] == 'number')?_c('Option',{key:i,attrs:{\"value\":i}},[_vm._v(_vm._s(attr)+\" \")]):_vm._e()]})],2),_c('br'),_c('br'),_c('p',[_vm._v(\"Resolution:\")]),_c('div',{staticStyle:{\"margin-bottom\":\"20px\"}},[_c('InputNumber',{model:{value:(_vm.canvasWidth),callback:function ($$v) {_vm.canvasWidth=$$v},expression:\"canvasWidth\"}}),_c('Icon',{attrs:{\"type\":\"ios-close\"}}),_c('InputNumber',{model:{value:(_vm.canvasHeight),callback:function ($$v) {_vm.canvasHeight=$$v},expression:\"canvasHeight\"}})],1),_c('Button',{staticStyle:{\"width\":\"200px\"},attrs:{\"type\":\"primary\",\"disabled\":!_vm.headers.length},on:{\"click\":_vm.generateCharts}},[_vm._v(\"generate chart \")]),_c('div',{staticStyle:{\"margin-top\":\"100px\"}},[_c('Button',{staticStyle:{\"width\":\"200px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.exportFig}},[_vm._v(\"export figure \")]),_c('br'),_c('Button',{staticStyle:{\"margin-top\":\"12px\",\"width\":\"200px\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.exportData(1)}}},[_vm._v(\"export representative lines \")]),_c('br'),_c('Button',{staticStyle:{\"margin-top\":\"12px\",\"width\":\"200px\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.exportData(0)}}},[_vm._v(\"export select lines \")])],1)],1)]),_c('Card',{staticStyle:{\"padding-left\":\"20px\",\"flex-grow\":\"1\"},attrs:{\"dis-hover\":\"\",\"bordered\":false}},[(!_vm.headers.length)?_c('div',{staticStyle:{\"min-height\":\"200px\",\"color\":\"red\"}},[_vm._v(\" Please load a dataset (.csv file) first! \"),_c('Button',{staticStyle:{\"margin\":\"0 12px\"},attrs:{\"type\":\"primary\",\"icon\":\"ios-archive\"},on:{\"click\":function($event){return _vm.eventHandler('1-1')}}},[_vm._v(\"Example Stocks(25.2MB) \")]),_c('Button',{staticStyle:{\"margin\":\"0 12px\"},attrs:{\"type\":\"primary\",\"icon\":\"ios-archive\"},on:{\"click\":function($event){return _vm.eventHandler('1-2')}}},[_vm._v(\"Example Airline(10.6MB) \")]),_c('Button',{staticStyle:{\"margin\":\"0 12px\"},attrs:{\"type\":\"primary\",\"icon\":\"ios-archive\"},on:{\"click\":function($event){return _vm.eventHandler('1-3')}}},[_vm._v(\"Example Weather(29.6MB) \")]),_c('Button',{staticStyle:{\"margin\":\"0 12px\"},attrs:{\"type\":\"primary\",\"icon\":\"ios-archive\"},on:{\"click\":function($event){return _vm.eventHandler('1-4')}}},[_vm._v(\"Example Reading(18.5MB) \")]),_c('Button',{staticStyle:{\"margin\":\"0 12px\"},attrs:{\"type\":\"primary\",\"icon\":\"ios-archive\"},on:{\"click\":function($event){return _vm.eventHandler('1-5')}}},[_vm._v(\"Example HardDrive(66.3MB) \")]),_c('Button',{staticStyle:{\"margin\":\"0 12px\"},attrs:{\"type\":\"primary\",\"icon\":\"ios-cloud-upload-outline\"},on:{\"click\":function($event){return _vm.eventHandler('2')}}},[_vm._v(\"Load data \")])],1):_c('div',[(!_vm.chartConfigs.length)?_c('div',{staticStyle:{\"min-height\":\"200px\",\"color\":\"red\"}},[_vm._v(\" Please use a valid configuration in left panel! \")]):_c('div',[_vm._l((_vm.chartConfigs),function(config,i){return [_c('CanvasBox',{key:config.aggregateName +\n                    '#' +\n                    config.timeName +\n                    '#' +\n                    config.valueName +\n                    '#' +\n                    _vm.width +\n                    '#' +\n                    _vm.height,attrs:{\"timeIndex\":config.timeIndex,\"valueIndex\":config.valueIndex,\"timeName\":config.timeName,\"valueName\":config.valueName,\"filter\":config.filter,\"layers\":_vm.layers,\"option\":{height: _vm.height, width: _vm.width}},on:{\"filterChange\":function($event){return _vm.handleFilterChange(i, $event)}}})]})],2)])])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nimport ndarray from \"ndarray\";\nimport tile from \"ndarray-tile\";\nimport unpack from \"ndarray-unpack\";\nimport pack from \"ndarray-pack\";\nexport function range(n) {\n    var out = new Float32Array(n);\n    for (var i = 0; i < n; i++) {\n        out[i] = i;\n    }\n    return out;\n}\nexport function rangeDup(n, multi) {\n    if (multi === void 0) { multi = 4; }\n    var out = new Float32Array(n * multi);\n    for (var i = 0; i < n * multi; i++) {\n        out[i] = Math.floor(i / multi);\n    }\n    return out;\n}\nexport function duplicate(arr, multi) {\n    if (multi === void 0) { multi = 4; }\n    var out = tile(arr, [1, multi]);\n    out = ndarray(out.data);\n    return out;\n}\nexport function makePair(arr, multi) {\n    if (multi === void 0) { multi = 2; }\n    if (arr.size <= 1)\n        return [];\n    var offset = Math.floor(multi / 2);\n    var out = arr;\n    out = tile(out, [1, multi]);\n    out = out.transpose(1, 0);\n    var tmpOut = unpack(out);\n    for (var i = 0; i < offset; i++) {\n        tmpOut[0].pop();\n        tmpOut[1].shift();\n    }\n    out = pack(tmpOut);\n    out = out.transpose(1, 0);\n    out = tile(out, [1, 1, 2]);\n    out = out.transpose(0, 2, 1);\n    out = unpack(out).reduce(function (p, v) { return __spread(p, v); }, []);\n    return out;\n}\n/**\n * Convert integer to float for shaders.\n */\nexport function float(i) {\n    if (i - Math.floor(i) > 0) {\n        return i;\n    }\n    return Math.floor(i) + \".0\";\n}\nexport function exportCanvas(canvas, upsideDown, opacityConfig) {\n    var exportCanvas = document.createElement(\"canvas\");\n    exportCanvas.width = 1000;\n    exportCanvas.height = 500;\n    var context = exportCanvas.getContext(\"2d\");\n    if (upsideDown) {\n        context.scale(1, -1);\n    }\n    console.log(opacityConfig);\n    for (var id in canvas) {\n        var cvs = canvas[id];\n        context.globalAlpha = opacityConfig ? opacityConfig[id] : 1;\n        context.drawImage(cvs, 0, upsideDown ? -cvs.height : 0);\n    }\n    var exportBtn = document.createElement(\"a\");\n    exportBtn.href = exportCanvas\n        .toDataURL()\n        .replace(/^data:image\\/[^;]*/, \"data:application/octet-stream\");\n    exportBtn.download = \"export.png\";\n    exportBtn.click();\n}\nexport function slope(array, min, max) {\n    return array.map(function (x) { return Math.max(min, Math.min(max, x)); });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"row\",\"align-items\":\"center\",\"margin\":\"15px 0 15px 20px\",\"position\":\"relative\"}},[_c('div',{staticStyle:{\"width\":\"1000px\",\"height\":\"500px\",\"opacity\":\"0\",\"pointer-events\":\"none\"},attrs:{\"id\":\"blank-div\"}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\"},attrs:{\"id\":\"canvas\",\"width\":_vm.option.width,\"height\":_vm.option.height},on:{\"mousedown\":_vm.canvasMousedown,\"mouseup\":_vm.canvasMouseup,\"mousemove\":_vm.canvasMousemove,\"wheel\":_vm.canvasWheel,\"contextmenu\":_vm.mouseContextmenu,\"mouseleave\":_vm.canvasMouseleave}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"pointer-events\":\"none\"},attrs:{\"id\":\"selectionCanvas\",\"width\":_vm.option.width,\"height\":_vm.option.height}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"pointer-events\":\"none\"},attrs:{\"id\":\"selectionLayer\",\"width\":\"1000\",\"height\":\"500\"}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"pointer-events\":\"none\"},attrs:{\"id\":\"rep_layer\",\"width\":\"1000\",\"height\":\"500\"}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"pointer-events\":\"none\"},attrs:{\"id\":\"raw_lines\",\"width\":\"1000\",\"height\":\"500\"}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"pointer-events\":\"none\",\"z-index\":\"999\"},attrs:{\"id\":\"mouseLayer\",\"width\":\"1000\",\"height\":\"500\"}}),_c('canvas',{staticStyle:{\"transform\":\"scaleY(1)\",\"position\":\"absolute\",\"left\":\"0\",\"top\":\"0\",\"pointer-events\":\"none\",\"z-index\":\"999\"},attrs:{\"id\":\"hoverLayer\",\"width\":\"1000\",\"height\":\"500\"}}),_c('svg',{staticStyle:{\"position\":\"absolute\",\"left\":\"-50px\",\"top\":\"-20px\",\"pointer-events\":\"none\",\"color\":\"black\",\"z-index\":\"999\",\"overflow\":\"visible\"},attrs:{\"id\":\"axisHelper\",\"width\":1050,\"height\":550}},[_c('g',{attrs:{\"id\":\"cursorHelper\",\"transform\":\"translate(50,20)\"}},[_c('line',{attrs:{\"stroke\":\"black\",\"stroke-dasharray\":\"10 5\"}}),_c('line',{attrs:{\"stroke\":\"black\",\"stroke-dasharray\":\"10 5\"}}),_c('text',{attrs:{\"font-size\":\"12px\"}}),_c('text',{attrs:{\"font-size\":\"12px\"}})])]),_c('div',{ref:\"axisTop\",staticStyle:{\"width\":\"1000px\",\"height\":\"30px\",\"position\":\"absolute\",\"top\":\"-30px\",\"left\":\"0\"}}),_c('div',{ref:\"axisBottom\",staticStyle:{\"width\":\"1000px\",\"height\":\"30px\",\"position\":\"absolute\",\"bottom\":\"-30px\",\"left\":\"0\"}}),_c('div',{ref:\"axisLeft\",staticStyle:{\"width\":\"30px\",\"height\":\"500px\",\"position\":\"absolute\",\"top\":\"0px\",\"left\":\"-30px\"}}),_c('div',{staticClass:\"control-panel\"},[_c('div',[_c('span',[_vm._v(\"Filter line by: \")]),_c('RadioGroup',{attrs:{\"type\":\"button\"},model:{value:(_vm.filterMode),callback:function ($$v) {_vm.filterMode=$$v},expression:\"filterMode\"}},[_c('Radio',{attrs:{\"label\":\"rnn\"}},[_vm._v(\"RNL\")]),_c('Radio',{attrs:{\"label\":\"brush\"}},[_vm._v(\"Brush\")]),_c('Radio',{attrs:{\"label\":\"ang\"}},[_vm._v(\"Angle\")]),_c('Radio',{attrs:{\"label\":\"attr\"}},[_vm._v(\"Attr\")]),_c('Radio',{attrs:{\"label\":\"hover\"}},[_vm._v(\"Hover\")])],1)],1),(_vm.filterMode === 'attr')?_c('div',{staticStyle:{\"margin-left\":\"2em\"}},[_c('Form',[_c('FormItem',{attrs:{\"label\":\"Attribute Column\"}},[_c('Select',{attrs:{\"placeholder\":\"Choose a column for attribute filtering\"},model:{value:(_vm.attributeColumn),callback:function ($$v) {_vm.attributeColumn=$$v},expression:\"attributeColumn\"}},_vm._l((_vm.headers),function(header){return _c('Option',{key:header.title,attrs:{\"value\":header.key}},[_vm._v(_vm._s(header.title)+\" \")])}),1)],1),_c('FormItem',{attrs:{\"label\":\"Value\"}},[_c('AutoComplete',{attrs:{\"data\":_vm.attributeData},on:{\"on-search\":_vm.handleSearch},model:{value:(_vm.attributeValue),callback:function ($$v) {_vm.attributeValue=$$v},expression:\"attributeValue\"}})],1),_c('Button',{staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"info\"},on:{\"click\":_vm.addAttrQuery}},[_vm._v(\"add attribute query \")])],1)],1):_vm._e(),_vm._m(0),(_vm.rawMode == 'rep')?_c('div',{staticStyle:{\"margin-left\":\"2em\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}},[_c('span',{staticStyle:{\"margin-right\":\"8px\"}},[_vm._v(\"Line count\")]),_c('Slider',{staticStyle:{\"flex-grow\":\"1\"},attrs:{\"min\":1,\"max\":20,\"step\":1,\"show-tip\":\"never\"},model:{value:(_vm.repCount),callback:function ($$v) {_vm.repCount=$$v},expression:\"repCount\"}}),_c('span',{staticStyle:{\"margin-left\":\"8px\"}},[_vm._v(_vm._s(_vm.repCount))]),_c('span',{staticStyle:{\"margin-right\":\"8px\",\"margin-left\":\"12px\"}},[_vm._v(\"Diverse\")]),_c('Slider',{staticStyle:{\"flex-grow\":\"1\"},attrs:{\"min\":0,\"max\":_vm.maxDiverse,\"step\":_vm.maxDiverse / 20,\"show-tip\":\"never\"},on:{\"on-change\":function($event){_vm.cnt++}},model:{value:(_vm.diverse),callback:function ($$v) {_vm.diverse=$$v},expression:\"diverse\"}})],1),_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}})]):_vm._e(),_c('div',{staticStyle:{\"position\":\"relative\"}},[_c('div',{staticClass:\"select-colormap\"},[_c('span',{staticStyle:{\"margin\":\"0\"}},[_vm._v(\"Colormap:\")]),_c('Select',{attrs:{\"id\":\"colormap\",\"placeholder\":\"Choose colormap\"},model:{value:(_vm.colormapIndexCache),callback:function ($$v) {_vm.colormapIndexCache=$$v},expression:\"colormapIndexCache\"}},[_c('Option',{attrs:{\"value\":\"0\"}},[_vm._v(\"viridis\")]),_c('Option',{attrs:{\"value\":\"1\",\"selected\":\"\"}},[_vm._v(\"magma\")]),_c('Option',{attrs:{\"value\":\"2\"}},[_vm._v(\"inferno\")]),_c('Option',{attrs:{\"value\":\"3\"}},[_vm._v(\"plasma\")]),_c('Option',{attrs:{\"value\":\"4\"}},[_vm._v(\"cividis\")]),_c('Option',{attrs:{\"value\":\"5\"}},[_vm._v(\"turbo\")]),_c('Option',{attrs:{\"value\":\"6\"}},[_vm._v(\"bluegreen\")]),_c('Option',{attrs:{\"value\":\"7\"}},[_vm._v(\"bluepurple\")]),_c('Option',{attrs:{\"value\":\"8\"}},[_vm._v(\"goldgreen\")]),_c('Option',{attrs:{\"value\":\"9\"}},[_vm._v(\"goldorange\")]),_c('Option',{attrs:{\"value\":\"10\"}},[_vm._v(\"goldred\")]),_c('Option',{attrs:{\"value\":\"11\"}},[_vm._v(\"greenblue\")]),_c('Option',{attrs:{\"value\":\"12\"}},[_vm._v(\"orangered\")]),_c('Option',{attrs:{\"value\":\"13\"}},[_vm._v(\"purplebluegreen\")]),_c('Option',{attrs:{\"value\":\"14\"}},[_vm._v(\"purpleblue\")]),_c('Option',{attrs:{\"value\":\"15\"}},[_vm._v(\"purplered\")]),_c('Option',{attrs:{\"value\":\"16\"}},[_vm._v(\"redpurple\")]),_c('Option',{attrs:{\"value\":\"17\"}},[_vm._v(\"yellowgreenblue\")]),_c('Option',{attrs:{\"value\":\"18\"}},[_vm._v(\"yellowgreen\")]),_c('Option',{attrs:{\"value\":\"19\"}},[_vm._v(\"yelloworangebrown\")]),_c('Option',{attrs:{\"value\":\"20\"}},[_vm._v(\"yelloworangered\")])],1)],1),_c('span',[_vm._v(\"1\")]),_c('span',{staticClass:\"color-map\",attrs:{\"id\":\"color-map\"}}),_c('InputNumber',{staticStyle:{\"width\":\"50px\"},attrs:{\"min\":1,\"active-change\":false},model:{value:(_vm.maxDensity),callback:function ($$v) {_vm.maxDensity=$$v},expression:\"maxDensity\"}})],1),_vm._m(1),_c('div',{staticStyle:{\"margin-left\":\"2em\"}},[_c('draggable',{model:{value:(_vm.layers),callback:function ($$v) {_vm.layers=$$v},expression:\"layers\"}},_vm._l((_vm.layers),function(layer){return _c('div',{key:layer.id,staticStyle:{\"display\":\"flex\",\"align-items\":\"center\",\"border\":\"1px solid #dcdee2\",\"margin-top\":\"4px\",\"background\":\"white\",\"cursor\":\"pointer\",\"border-radius\":\"4px\",\"padding\":\"0 8px\"}},[_c('Icon',{staticStyle:{\"cursor\":\"move\"},attrs:{\"type\":\"md-menu\"}}),_c('div',{staticStyle:{\"flex-grow\":\"1\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"}},[_c('p',{staticStyle:{\"width\":\"170px\",\"padding-left\":\"12px\"}},[_vm._v(\" \"+_vm._s(layer.name)+\" \")]),_c('Icon',{style:({ opacity: layer.opacity * 0.7 + 0.3 }),attrs:{\"type\":layer.opacity === 0 ? 'md-eye-off' : 'md-eye'},on:{\"click\":function($event){layer.opacity = layer.opacity === 0 ? 1 : 0}}}),_c('Slider',{staticStyle:{\"flex-grow\":\"1\",\"margin-left\":\"12px\",\"margin-right\":\"8px\"},attrs:{\"min\":0,\"max\":1,\"step\":0.01,\"show-tip\":\"never\"},model:{value:(layer.opacity),callback:function ($$v) {_vm.$set(layer, \"opacity\", $$v)},expression:\"layer.opacity\"}})],1),(layer.id == 'selectionCanvas')?_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"center\",\"margin\":\"0 12px 8px\",\"position\":\"relative\"}},[_c('div',{staticClass:\"select-colormap\"},[_c('span',{staticStyle:{\"margin\":\"0\"}},[_vm._v(\"Colormap:\")]),_c('Select',{attrs:{\"id\":\"colormapOverlay\",\"placeholder\":\"Choose colormap\"},model:{value:(_vm.colormapOverlayIndexCache),callback:function ($$v) {_vm.colormapOverlayIndexCache=$$v},expression:\"colormapOverlayIndexCache\"}},[_c('Option',{attrs:{\"value\":\"0\"}},[_vm._v(\"viridis\")]),_c('Option',{attrs:{\"value\":\"1\",\"selected\":\"\"}},[_vm._v(\"magma\")]),_c('Option',{attrs:{\"value\":\"2\"}},[_vm._v(\"inferno\")]),_c('Option',{attrs:{\"value\":\"3\"}},[_vm._v(\"plasma\")]),_c('Option',{attrs:{\"value\":\"4\"}},[_vm._v(\"cividis\")]),_c('Option',{attrs:{\"value\":\"5\"}},[_vm._v(\"turbo\")]),_c('Option',{attrs:{\"value\":\"6\"}},[_vm._v(\"bluegreen\")]),_c('Option',{attrs:{\"value\":\"7\"}},[_vm._v(\"bluepurple\")]),_c('Option',{attrs:{\"value\":\"8\"}},[_vm._v(\"goldgreen\")]),_c('Option',{attrs:{\"value\":\"9\"}},[_vm._v(\"goldorange\")]),_c('Option',{attrs:{\"value\":\"10\"}},[_vm._v(\"goldred\")]),_c('Option',{attrs:{\"value\":\"11\"}},[_vm._v(\"greenblue\")]),_c('Option',{attrs:{\"value\":\"12\"}},[_vm._v(\"orangered\")]),_c('Option',{attrs:{\"value\":\"13\"}},[_vm._v(\"purplebluegreen\")]),_c('Option',{attrs:{\"value\":\"14\"}},[_vm._v(\"purpleblue\")]),_c('Option',{attrs:{\"value\":\"15\"}},[_vm._v(\"purplered\")]),_c('Option',{attrs:{\"value\":\"16\"}},[_vm._v(\"redpurple\")]),_c('Option',{attrs:{\"value\":\"17\"}},[_vm._v(\"yellowgreenblue\")]),_c('Option',{attrs:{\"value\":\"18\"}},[_vm._v(\"yellowgreen\")]),_c('Option',{attrs:{\"value\":\"19\"}},[_vm._v(\"yelloworangebrown\")]),_c('Option',{attrs:{\"value\":\"20\"}},[_vm._v(\"yelloworangered\")])],1)],1),_c('span',[_vm._v(\"1\")]),_c('span',{staticClass:\"color-map\",attrs:{\"id\":\"color-map-overlay\"}}),_c('InputNumber',{staticStyle:{\"width\":\"50px\"},attrs:{\"min\":1,\"active-change\":false},model:{value:(_vm.maxOverlayDensity),callback:function ($$v) {_vm.maxOverlayDensity=$$v},expression:\"maxOverlayDensity\"}})],1):_vm._e()])],1)}),0)],1),_c('div',[_c('span',[_vm._v(\"Show value of cursor:\")]),_c('iSwitch',{staticStyle:{\"margin-left\":\"12px\"},model:{value:(_vm.showCursorValue),callback:function ($$v) {_vm.showCursorValue=$$v},expression:\"showCursorValue\"}})],1),_c('div',[_c('span',[_vm._v(\"Reverse y-axis:\")]),_c('iSwitch',{staticStyle:{\"margin-left\":\"12px\"},model:{value:(_vm.upsideDown),callback:function ($$v) {_vm.upsideDown=$$v},expression:\"upsideDown\"}})],1),_c('div',[_c('span',[_vm._v(\"Normalize density:\")]),_c('iSwitch',{staticStyle:{\"margin-left\":\"12px\"},model:{value:(_vm.normalizeDensity),callback:function ($$v) {_vm.normalizeDensity=$$v},expression:\"normalizeDensity\"}})],1),_c('div',[_c('span',[_vm._v(\"Enlarge Axis Font Size:\")]),_c('iSwitch',{staticStyle:{\"margin-left\":\"12px\"},model:{value:(_vm.enlargeFont),callback:function ($$v) {_vm.enlargeFont=$$v},expression:\"enlargeFont\"}})],1)])]),_c('Table',{staticStyle:{\"margin-top\":\"30px\"},attrs:{\"row-class-name\":_vm.calClassName,\"border\":\"\",\"columns\":_vm.tableColumns,\"data\":_vm.cnt + 1 && _vm.tableData,\"on-current-change\":_vm.hoveringQuery,\"id\":\"informationTable\"},scopedSlots:_vm._u([{key:\"name\",fn:function(ref){\nvar row = ref.row;\nvar index = ref.index;\nreturn [(index >= _vm.tableData.length - 2)?_c('p',{staticStyle:{\"font-style\":\"italic\",\"font-weight\":\"700\"}},[_vm._v(\" \"+_vm._s(row.name)+\" \")]):_c('div',[_vm._v(_vm._s(row.name))])]}},{key:\"op\",fn:function(ref){\nvar row = ref.row;\nvar index = ref.index;\nreturn [_c('Button',{staticStyle:{\"margin-right\":\"5px\"},attrs:{\"ghost\":\"\",\"type\":row.query === _vm.selectedQuery ? 'primary' : 'default',\"size\":\"small\"},on:{\"click\":function($event){_vm.selectedQuery = row.query}}},[_vm._v(\"Explore \")]),(index < _vm.tableData.length - 2)?_c('Button',{attrs:{\"type\":\"error\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteQuery(index)}}},[_vm._v(\"Delete \")]):_vm._e()]}}])}),_c('Button',{staticStyle:{\"float\":\"right\",\"margin\":\"20px\"},attrs:{\"type\":\"error\",\"size\":\"small\"},on:{\"click\":_vm.deleteAllQuery}},[_vm._v(\" Delete all Querys \")]),_c('Modal',{attrs:{\"width\":\"1000\",\"closable\":false},model:{value:(_vm.repModal),callback:function ($$v) {_vm.repModal=$$v},expression:\"repModal\"}},[_c('p',{staticStyle:{\"color\":\"dodgerblue\",\"text-align\":\"center\"},attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('Icon',{attrs:{\"type\":\"ios-information-circle\"}}),_c('span',[_vm._v(\"Representative Line Information\")])],1),_c('Table',{attrs:{\"border\":\"\",\"columns\":_vm.repColumns,\"data\":_vm.repStaticInformation}}),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"long\":\"\"},on:{\"click\":function($event){_vm.repModal = false}}},[_vm._v(\"Confirm \")])],1)],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('span',[_vm._v(\"Representative line parameters: \")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('span',[_vm._v(\"Layers:\")])])}]\n\nexport { render, staticRenderFns }","export default {\n  data: [],\n  aggregatedData: [],\n  headers: [],\n  interResult: [],\n  unionResult: [],\n  querys: [],\n  repIds: [],\n  weightCache: {},\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Table',{attrs:{\"columns\":_vm.repColumns,\"data\":_vm.row},scopedSlots:_vm._u([{key:\"name\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"row\",\"justify-content\":\"center\",\"align-items\":\"center\"}},[_c('div',{staticClass:\"small-point\",style:({ background: row.color })}),_c('p',[_vm._v(_vm._s(row.name))])])]}},{key:\"op\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('Button',{attrs:{\"ghost\":\"\",\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.showData(row)}}},[_vm._v(\"Detail \")])]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <Table :columns=\"repColumns\" :data=\"row\">\r\n    <template slot-scope=\"{ row }\" slot=\"name\">\r\n      <div\r\n        style=\"display: flex; flex-direction: row; justify-content: center; align-items: center;\"\r\n      >\r\n        <div class=\"small-point\" v-bind:style=\"{ background: row.color }\"></div>\r\n        <p>{{ row.name }}</p>\r\n      </div>\r\n    </template>\r\n    <template slot=\"op\" slot-scope=\"{ row }\">\r\n      <Button ghost type=\"primary\" size=\"small\" @click=\"showData(row)\"\r\n        >Detail\r\n      </Button>\r\n    </template>\r\n  </Table>\r\n</template>\r\n\r\n<script>\r\nimport unobserve from '../store';\r\nimport * as d3 from 'd3';\r\n\r\nexport default {\r\n  name: 'expandRow',\r\n  props: {\r\n    row: Array,\r\n  },\r\n  data() {\r\n    return {\r\n      repColumns: [\r\n        {\r\n          title: `Line \"${unobserve.aggregateName}\"`,\r\n          align: 'center',\r\n          slot: 'name',\r\n        },\r\n        // { title: 'Min start time', align: 'center', key: 'minT' },\r\n        // { title: 'Max start time', align: 'center', key: 'maxT' },\r\n        { title: 'Min value', align: 'center', key: 'minV' },\r\n        { title: 'Max value', align: 'center', key: 'maxV' },\r\n        { title: 'Mean value', align: 'center', key: 'mean' },\r\n        { title: 'Variance', align: 'center', key: 'var' },\r\n        { title: 'Operation', align: 'center', slot: 'op' },\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    showData(row) {\r\n      const aggIndex = unobserve.headers.indexOf(unobserve.aggregateName);\r\n      this.$Modal.info({\r\n        width: 1000,\r\n        closable: true,\r\n        render: (h) =>\r\n          h('div', [\r\n            h('svg', {\r\n              attrs: {\r\n                id: 'rep-line-svg',\r\n                viewBox: '0 0 1050 550',\r\n              },\r\n              style: {\r\n                height: '550px',\r\n                width: '950px',\r\n              },\r\n            }),\r\n            h('Table', {\r\n              props: {\r\n                columns: unobserve.headers.map((title, key) => ({\r\n                  title,\r\n                  align: 'center',\r\n                  key,\r\n                })),\r\n                data: unobserve.data\r\n                  .filter((x) => x[aggIndex] == row.name)\r\n                  .map((x) => x.reduce((p, v, i) => ({ ...p, [i]: v }), {})),\r\n                stripe: true,\r\n              },\r\n            }),\r\n          ]),\r\n      });\r\n      this.$nextTick().then(() => {\r\n        console.log('svgsvg');\r\n        const svg = d3.select('#rep-line-svg');\r\n        console.log(svg);\r\n        svg\r\n          .append('g')\r\n          .attr('id', 'yaxis')\r\n          .attr('transform', 'translate(50,20)')\r\n          .call(unobserve.yAxis);\r\n        svg\r\n          .append('g')\r\n          .attr('id', 'xaxis')\r\n          .attr('transform', `translate(50,${unobserve.upsideDown ? 20 : 520})`)\r\n          .call(unobserve.upsideDown ? unobserve.xAxisR : unobserve.xAxis);\r\n        svg\r\n          .append('g')\r\n          .attr('transform', `translate(50,20)`)\r\n          .append('path')\r\n          .attr(\r\n            'd',\r\n            d3.line()(\r\n              unobserve.screenResult[row.id].map(({ x, y }) => [\r\n                x,\r\n                unobserve.upsideDown ? 500 - y : y,\r\n              ])\r\n            )\r\n          )\r\n          .attr('stroke', row.color)\r\n          .attr('fill', 'none');\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.small-point {\r\n  height: 12px;\r\n  width: 12px;\r\n  border-radius: 50%;\r\n  margin-right: 6px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./expandRow.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./expandRow.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./expandRow.vue?vue&type=template&id=5bdf98db&\"\nimport script from \"./expandRow.vue?vue&type=script&lang=js&\"\nexport * from \"./expandRow.vue?vue&type=script&lang=js&\"\nimport style0 from \"./expandRow.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// import Heap from \"heap\";\nimport Queue from 'tinyqueue';\nimport { RBush3D } from 'rbush-3d';\nconst Heap = require('heap');\nconst kmeans = require('ml-kmeans').default;\n// const kmeans = require('ml-kmeans');\n\nexport class VolKDTree {\n  //#region props init\n  /**\n   * @type {[number,number,number,number,number,number][]}\n   */\n  #data = null;\n  /**\n   * @type {null | 'x' | 'yMin' | 'yMax' | 'slope'}\n   */\n  #dividedBy = null;\n  /**\n   * @type {number} actually is superficie\n   */\n  #volume = 0;\n  /**\n   * @type {[number,number,number,number]} [xMin, xMax, yMin, yMax]\n   */\n  #boundingBox = [0, 0, 0, 0];\n  /**\n   * @type {VolKDTree[]}\n   */\n  #children = [];\n\n  get dividedBy() {\n    return this.#dividedBy;\n  }\n\n  get volume() {\n    return this.#volume;\n  }\n\n  get children() {\n    return this.#children.slice();\n  }\n\n  get lineCount() {\n    return this.#data.length;\n  }\n\n  get boundingBox() {\n    return this.#boundingBox.slice();\n  }\n\n  toString() {\n    return `VolKDTree (${this.#boundingBox.join(', ')}) ${\n      this.#children.length\n        ? `${this.dividedBy} {\n  ${this.#children[0].toString()}\n  ${this.#children[1].toString()}\n}`\n        : ''\n    }`;\n  }\n  //#endregion\n\n  /**\n   *\n   * @param {[number,number,number,number,number,number][]} data [xMin, xMax, yMin, yMax, slope, i][]\n   */\n  constructor(data, avoidRecursive) {\n    this.#data = data;\n    this.#boundingBox = data.reduce(\n      (p, v) => [\n        Math.min(p[0], v[0], v[1]),\n        Math.max(p[1], v[0], v[1]),\n        Math.min(p[2], v[2], v[3]),\n        Math.max(p[3], v[2], v[3]),\n      ],\n      [Infinity, -Infinity, Infinity, -Infinity]\n    );\n    this.#volume = Math.abs(\n      (this.#boundingBox[1] - this.#boundingBox[0]) *\n        (this.#boundingBox[3] - this.#boundingBox[2])\n    );\n    if (!avoidRecursive) {\n      this.#tryDivide();\n    }\n  }\n\n  #tryDivide() {\n    if (this.#data.length <= 1) return;\n    const xDivide = (this.#boundingBox[0] + this.#boundingBox[1]) / 2; // Assume time are equally distributed in space\n    const yMinDivide = selectK(\n      this.#data.map((x) => x[2]),\n      Math.floor(this.#data.length / 2)\n    );\n    const yMaxDivide = selectK(\n      this.#data.map((x) => x[3]),\n      Math.floor(this.#data.length / 2)\n    );\n    const slopeDivide = selectK(\n      this.#data.map((x) => x[4]),\n      Math.floor(this.#data.length / 2)\n    );\n    // console.log(xDivide, yMinDivide, yMaxDivide, slopeDivide);\n    const xChildren = [\n      splitLines(this.#data, this.#boundingBox[0], xDivide, 0),\n      splitLines(this.#data, xDivide, this.#boundingBox[1], 0),\n    ];\n    const yMinChildren = [\n      splitLines(this.#data, this.#boundingBox[2], yMinDivide, 1),\n      splitLines(this.#data, yMinDivide, this.#boundingBox[3], 1),\n    ];\n    const yMaxChildren = [\n      splitLines(this.#data, this.#boundingBox[2], yMaxDivide, 1),\n      splitLines(this.#data, yMaxDivide, this.#boundingBox[3], 1),\n    ];\n    const slopeChildren = [\n      splitLines(this.#data, -Infinity, slopeDivide, 2),\n      splitLines(this.#data, slopeDivide, Infinity, 2),\n    ];\n    // console.log(xChildren, yMinChildren, yMaxChildren, slopeChildren);\n    const xCost = calculateCost(xChildren, this);\n    const yMinCost = calculateCost(yMinChildren, this);\n    const yMaxCost = calculateCost(yMaxChildren, this);\n    const slopeCost = calculateCost(slopeChildren, this);\n    const minCost = Math.min(xCost[2], yMinCost[2], yMaxCost[2], slopeCost[2]);\n    // console.log(minCost, this.lineCount);\n    if (minCost >= this.lineCount) {\n      return;\n    }\n    switch (minCost) {\n      case xCost[2]:\n        this.#dividedBy = 'x';\n        this.#children = xCost.slice(0, 2);\n        break;\n      case yMinCost[2]:\n        this.#dividedBy = 'yMin';\n        this.#children = yMinCost.slice(0, 2);\n        break;\n      case yMaxCost[2]:\n        this.#dividedBy = 'yMax';\n        this.#children = yMaxCost.slice(0, 2);\n        break;\n      case slopeCost[2]:\n        this.#dividedBy = 'slope';\n        this.#children = slopeCost.slice(0, 2);\n        break;\n    }\n    this.#children.forEach((child) => {\n      child.#tryDivide();\n    });\n  }\n\n  knn(point, k) {\n    const heap = new Heap((a, b) => b.v - a.v);\n    this.findKNN(point, k, heap);\n    // console.log(heap.size());\n    return heap;\n  }\n\n  rnn(point, r, visit) {\n    let ret = [];\n    this.findRNN(point, r, ret, visit);\n  }\n\n  range(lo, hi, visit) {\n    let ret = [];\n    this.findRange(lo, hi, ret, visit);\n  }\n\n  findKNN(point, k, heap) {\n    if (this.#children.length) {\n      let order = [...this.#children];\n      if (inBox(this.#children[1].#boundingBox, point)) {\n        swap(order[0], order[1]);\n      }\n      for (let i = 0; i < 2 && heap.size() < k; i++) {\n        if (\n          heap.size() < k ||\n          closestDist(order[i].#boundingBox, point) < heap.top()\n        )\n          order[i].findKNN(point, k, heap);\n      }\n    } else {\n      // if it's a leaf node\n      // console.log('im leaf node')\n      // console.log(`data length ${this.#data.length}`)\n      for (let i = 0; i < this.#data.length; i++) {\n        const dist = dist2Seg(this.#data[i], point);\n        if (heap.size() < k || heap.top() > dist) {\n          if (heap.size() === k) heap.pop();\n          heap.push({ v: dist, d: this.#data[i] });\n          // console.log(this.#data[i])\n        }\n      }\n    }\n  }\n\n  findRNN(point, r, ret, visit) {\n    if (largestDist(this.#boundingBox, point) <= r) {\n      concat(ret, this.#data, visit);\n      return;\n    }\n    if (closestDist(this.#boundingBox, point) > r) {\n      return;\n    }\n    if (this.#children.length) {\n      this.#children[0].findRNN(point, r, ret, visit);\n      this.#children[1].findRNN(point, r, ret, visit);\n    } else {\n      this.#data.forEach((d) => {\n        if (dist2Seg(d, point) <= r) {\n          ret.push(d);\n          visit(d);\n        }\n      });\n    }\n  }\n\n  findRange(lo, hi, ret, visit) {\n    const box = this.#boundingBox;\n    if (lo[0] < box[0] && lo[1] < box[2] && hi[0] > box[1] && hi[1] > box[3]) {\n      concat(ret, this.#data, visit);\n      return;\n    }\n    if (this.#children.length) {\n      this.#children[0].findRange(lo, hi, ret, visit);\n      this.#children[1].findRange(lo, hi, ret, visit);\n    } else {\n      this.#data.forEach((d) => {\n        const box = [lo[0], hi[0], lo[1], hi[1]];\n        if (inBox(box, [d[0], d[2]]) || inBox(box, [d[1], d[3]])) {\n          ret.push(d);\n          visit(d);\n        }\n      });\n    }\n  }\n}\n\nfunction inBox(box, point) {\n  return (\n    point[0] >= box[0] &&\n    point[0] <= box[1] &&\n    point[1] >= box[2] &&\n    point[1] <= box[3]\n  );\n}\n\nfunction sqDist(ax, ay, bx, by) {\n  const dx = ax - bx;\n  const dy = ay - by;\n  return dx * dx + dy * dy;\n}\n\nfunction dist2Seg(seg, point) {\n  const cross =\n    (point[0] - seg[0]) * (seg[1] - seg[0]) +\n    (point[1] - seg[2]) * (seg[3] - seg[2]);\n  if (cross <= 0) return sqDist(...point, seg[0], seg[2]);\n\n  const d2 =\n    (seg[1] - seg[0]) * (seg[1] - seg[0]) +\n    (seg[3] - seg[2]) * (seg[3] - seg[2]);\n  if (cross >= d2) return sqDist(...point, seg[1], seg[3]);\n\n  const r = cross / d2,\n    px = seg[0] + (seg[1] - seg[0]) * r,\n    py = seg[2] + (seg[3] - seg[2]) * r;\n  return sqDist(...point, px, py);\n}\n\nfunction swap(arr, i, j) {\n  const tmp = arr[i];\n  arr[j] = arr[i];\n  arr[i] = tmp;\n}\n\nfunction closestDist(box, point) {\n  const c1 = point[0] >= box[0] && point[0] <= box[1],\n    c2 = point[1] >= box[2] && point[1] <= box[3];\n  if (c1 && c2) return 0;\n  let ret = [\n    sqDist(...point, box[0], box[2]),\n    sqDist(...point, box[0], box[3]),\n    sqDist(...point, box[1], box[2]),\n    ...point,\n    box[1],\n    box[3],\n  ];\n  if (c1) {\n    ret.push(\n      Math.min(Math.abs(box[2] - point[1]), Math.abs(box[3] - point[1]))\n    );\n  }\n  if (c2) {\n    ret.push(\n      Math.min(Math.abs(box[0] - point[0]), Math.abs(box[1] - point[0]))\n    );\n  }\n  return Math.min(...ret);\n}\n\nfunction largestDist(box, point) {\n  let ret = [\n    sqDist(...point, box[0], box[2]),\n    sqDist(...point, box[0], box[3]),\n    sqDist(...point, box[1], box[2]),\n    ...point,\n    box[1],\n    box[3],\n  ];\n  ret.push(Math.max(Math.abs(box[2] - point[1]), Math.abs(box[3] - point[1])));\n  ret.push(Math.max(Math.abs(box[0] - point[0]), Math.abs(box[1] - point[0])));\n  return Math.max(...ret);\n}\n\nfunction concat(arr, tmp_arr, visit) {\n  tmp_arr.forEach((d) => {\n    visit(d);\n    arr.push(d);\n  });\n}\n\n//#region MOM algorithm to find median\n\nfunction partition(arr, left, right, pivot) {\n  var temp = arr[pivot];\n  arr[pivot] = arr[right];\n  arr[right] = temp;\n  var track = left;\n  for (var i = left; i < right; i++) {\n    if (arr[i] < arr[right]) {\n      var t = arr[i];\n      arr[i] = arr[track];\n      arr[track] = t;\n      track++;\n    }\n  }\n  temp = arr[track];\n  arr[track] = arr[right];\n  arr[right] = temp;\n  return track;\n}\n\nfunction selectIdx(arr, left, right, k) {\n  if (left == right) {\n    return left;\n  }\n  var dest = left + k;\n  while (true) {\n    var pivotIndex =\n      right - left + 1 <= 5\n        ? Math.floor(Math.random() * (right - left + 1)) + left\n        : medianOfMedians(arr, left, right);\n    pivotIndex = partition(arr, left, right, pivotIndex);\n    if (pivotIndex == dest) return pivotIndex;\n    else if (pivotIndex < dest) {\n      left = pivotIndex + 1;\n    } else {\n      right = pivotIndex - 1;\n    }\n  }\n}\n\nfunction medianOfMedians(arr, left, right) {\n  var numMedians = Math.ceil((right - left) / 5);\n  for (var i = 0; i < numMedians; i++) {\n    var subLeft = left + i * 5;\n    var subRight = subLeft + 4;\n    if (subRight > right) {\n      subRight = right;\n    }\n    var medianIdx = selectIdx(\n      arr,\n      subLeft,\n      subRight,\n      Math.floor((subRight - subLeft) / 2)\n    );\n    var temp = arr[medianIdx];\n    arr[medianIdx] = arr[left + i];\n    arr[left + i] = temp;\n  }\n  return selectIdx(\n    arr,\n    left,\n    left + numMedians - 1,\n    Math.floor(numMedians / 2)\n  );\n}\n\nfunction selectK(arr, k) {\n  if (!Array.isArray(arr) || arr.length == 0 || arr.length - 1 < k || k < 0) {\n    return;\n  }\n  var idx = selectIdx(arr, 0, arr.length - 1, k);\n  return arr[idx];\n}\n\n//#endregion\n\n/**\n *\n * @param {[number,number,number,number,number,number][]} arr\n * @param {number} lo\n * @param {number} hi\n * @param {0|1|2} axis enum: x=0, y=1, slope=2\n * @return {[number,number,number,number,number,number][]}\n */\nfunction splitLines(arr, lo, hi, axis) {\n  const result = [];\n  if (lo === undefined || hi === undefined) {\n    return result;\n  }\n  arr.forEach((data) => {\n    if (axis === 0) {\n      if (lo >= data[1] || hi <= data[0]) {\n        return;\n      }\n      if (lo <= data[0] && hi >= data[1]) {\n        return result.push(data);\n      }\n      const x1 = data[0];\n      const x2 = data[1];\n      const y1 = data[2];\n      const y2 = data[3];\n      if (hi < x2) {\n        return result.push([\n          x1,\n          hi,\n          y1,\n          ((y2 - y1) / (x2 - x1)) * (hi - x1) + y1,\n          data[4],\n          data[5],\n        ]);\n      }\n      if (lo > x1) {\n        return result.push([\n          lo,\n          x2,\n          y2 - ((y2 - y1) / (x2 - x1)) * (x2 - lo),\n          y2,\n          data[4],\n          data[5],\n        ]);\n      }\n    } else if (axis === 1) {\n      const yLow = Math.min(data[2], data[3]);\n      const yHigh = Math.max(data[2], data[3]);\n      if (lo >= yHigh || hi <= yLow) {\n        return;\n      }\n      if (lo <= yLow && hi >= yHigh) {\n        return result.push(data);\n      }\n      const x1 = data[0];\n      const x2 = data[1];\n      const y1 = data[2];\n      const y2 = data[3];\n      if (hi < yHigh) {\n        if (y1 > y2) {\n          return result.push([\n            x2 - ((x2 - x1) / (y2 - y1)) * (y2 - hi),\n            x2,\n            hi,\n            y2,\n            data[4],\n            data[5],\n          ]);\n        } else {\n          return result.push([\n            x1,\n            ((x2 - x1) / (y2 - y1)) * (hi - y1) + x1,\n            y1,\n            hi,\n            data[4],\n            data[5],\n          ]);\n        }\n      }\n      if (lo > yLow) {\n        if (y1 < y2) {\n          return result.push([\n            x2 - ((x2 - x1) / (y2 - y1)) * (y2 - lo),\n            x2,\n            lo,\n            y2,\n            data[4],\n            data[5],\n          ]);\n        } else {\n          return result.push([\n            x1,\n            ((x2 - x1) / (y2 - y1)) * (lo - y1) + x1,\n            y1,\n            lo,\n            data[4],\n            data[5],\n          ]);\n        }\n      }\n    } else if (axis === 2) {\n      if (lo > data[4] || hi <= data[4]) {\n        return;\n      }\n      return result.push(data);\n    }\n  });\n  return result;\n}\n\n/**\n * @param {[number,number,number,number,number,number][][]} param0\n * @param {VolKDTree} parent\n */\nfunction calculateCost([leftData, rightData], parent) {\n  const treeLeft = new VolKDTree(leftData, true);\n  const treeRight = new VolKDTree(rightData, true);\n  const PTl = treeLeft.volume / parent.volume;\n  const PTr = treeRight.volume / parent.volume;\n  const costTraversal = 0.3 + (PTl * leftData.length + PTr * rightData.length);\n  const costBacktracking =\n    ((PTl * Math.log(parent.lineCount)) /\n      Math.log(parent.lineCount / leftData.length) +\n      (PTr * Math.log(parent.lineCount)) /\n        Math.log(parent.lineCount / rightData.length)) *\n    3;\n  return [treeLeft, treeRight, costTraversal + costBacktracking];\n}\n\nexport class VolRTree {\n  #data = null;\n  #treeRef = null;\n  #repTree = null;\n\n  constructor(data) {\n    this.#data = data.map((raw) => ({\n      minX: raw[0],\n      maxX: raw[1],\n      minY: Math.min(raw[2], raw[3]),\n      maxY: Math.max(raw[2], raw[3]),\n      minZ: raw[4],\n      maxZ: raw[4],\n      raw,\n    }));\n    this.#treeRef = new RBush3D(16);\n    this.#treeRef.load(this.#data);\n  }\n\n  rnn(x, y, r) {\n    return this.#treeRef\n      .search({\n        minX: x - r,\n        minY: y - r,\n        maxX: x + r,\n        maxY: y + r,\n        minZ: -Infinity,\n        maxZ: Infinity,\n      })\n      .filter(\n        ({ raw }) =>\n          distToSegment([x, y], [raw[0], raw[2]], [raw[1], raw[3]]) <= r\n      );\n  }\n\n  brush(minX, minY, maxX, maxY) {\n    return this.#treeRef.search({\n      minX,\n      minY,\n      maxX,\n      maxY,\n      minZ: -Infinity,\n      maxZ: Infinity,\n    });\n  }\n\n  angular(minX, minSlope, maxX, maxSlope) {\n    return this.#treeRef.search({\n      minX,\n      minY: -Infinity,\n      maxX,\n      maxY: Infinity,\n      minZ: minSlope,\n      maxZ: maxSlope,\n    });\n  }\n\n  knn(x, y, k) {\n    /*\n    let l = 0, r = 10000, ret, times = 40;\n    while(times--) {\n      let mid = (l + r) * 0.5;\n      ret = this.rnn(x, y, mid);\n      console.log(times,l, mid,ret.length, k, ret.length < k);\n      if (ret.length === k)\n        return ret;\n      if (ret.length < k)\n        l = mid;\n      else\n        r = mid;\n    }\n    return ret.slice(0, k);\n\n     */\n\n    // /*\n    var node = this.#treeRef.data,\n      result = [],\n      i,\n      child,\n      dist,\n      candidate;\n\n    const heap = new Heap((a, b) => b.v - a.v);\n\n    var queue = new Queue(undefined, this.#compareDist);\n\n    while (node) {\n      for (i = 0; i < node.children.length; i++) {\n        child = node.children[i];\n        dist = this.#boxDist(x, y, child);\n        // dist = closestDist([child.minX, child.minY, child.maxX, child.maxY], [x, y]);\n        if (heap.size() < k || heap.top().v > dist) {\n          queue.push({\n            node: child,\n            isItem: node.leaf,\n            dist: dist,\n          });\n        }\n      }\n\n      while (queue.length && queue.peek().isItem) {\n        candidate = queue.pop();\n        // dist = dist2Seg([candidate.node.minX, candidate.node.minY, candidate.node.maxX, candidate.node.maxY], [x, y]);\n        dist = dist2Seg(candidate.node.raw, [x, y]);\n        // result.push(candidate);\n        // console.log(heap.top());\n        // if (heap.size() > 1)\n        //   return heap.top();\n        if (heap.size() < k || heap.top().v > dist) {\n          // console.log(dist, candidate.node.raw, dist2Seg(candidate.node.raw, [x, y]));\n          // console.log(candidate);\n          if (heap.size() === k) {\n            heap.pop();\n          }\n          heap.push({\n            // v: candidate.dist,\n            node: candidate.node,\n            v: dist,\n          });\n        }\n        // if (k && result.length === k) return result;\n      }\n\n      node = queue.pop();\n      if (node) node = node.node;\n    }\n\n    while (heap.size()) {\n      // console.log(heap.top().v, heap.top().node, dist2Seg(heap.top().node.raw, [x,y]));\n      result.push(heap.top().node);\n      heap.pop();\n    }\n    // console.log(result);\n    return result;\n\n    // */\n  }\n\n  rep(lines, repNumber = 3) {\n    this.#repTree = { children: [] };\n    let stack = [[this.#treeRef.data, this.#repTree, 0]];\n\n    const mp = new Map();\n    new Array(lines.length).fill(undefined).forEach((_, i) => mp.set(i, i));\n\n    for (let i = 0; i < lines.length; i++)\n      for (let j = i + 1; j < lines.length; j++) {\n        const length = Math.min(lines[i].length, lines[j].length);\n        const subArr = lines[i]\n          .slice(lines[i].length - length)\n          .map((v, cnt) => v.y - lines[j][lines[j].length - length + cnt].y);\n        const derivation = standardDeviation(subArr);\n        mp.set(i, mp.get(i) + derivation);\n        mp.set(j, mp.get(j) + derivation);\n      }\n\n    return Array.from(mp)\n      .sort((a, b) => a[1] - b[1])\n      .map((d) => d[0])\n      .slice(0, 10);\n\n    while (stack.length > 0) {\n      const [treeNode, repNode, cnt] = stack.pop();\n      // console.log(treeNode);\n      if (cnt === treeNode.children.length || treeNode.leaf) {\n        let indexes;\n\n        if (cnt === treeNode.children.length) {\n          indexes = [];\n          // console.log(indexes);\n          // console.log(repNode.children);\n          repNode.children.forEach(\n            (child) => (indexes = [...indexes, ...child.indexes])\n          );\n          // indexes = repNode.children.indexes.slice();\n        } else {\n          indexes = treeNode.children.map(({ raw }) => raw[5]);\n        }\n\n        indexes = Array.from(new Set(indexes));\n\n        const points = this.#generatePoints(\n          indexes,\n          lines,\n          treeNode,\n          Math.sqrt(treeNode.height) * 5\n        );\n\n        // console.log(points, indexes.map(x => lines[x]), treeNode);\n        const result = kmeans(points, repNumber, {\n          initialization: 'mostDistant',\n        });\n        // repNode.indexes = result.map(x => indexes[x]);\n\n        const maxClusterMap = new Map();\n        result.clusters.forEach((c, i) => {\n          if (\n            !maxClusterMap.has(c) ||\n            mp.get(maxClusterMap.get(c)) > mp.get(indexes[i])\n          ) {\n            maxClusterMap.set(c, indexes[i]);\n          }\n        });\n\n        // console.log(maxClusterMap, Array.from(maxClusterMap), result, points);\n        repNode.indexes = Array.from(maxClusterMap).map((d) => d[1]);\n      } else {\n        const newNode = { children: [] };\n        repNode.children.push(newNode);\n        stack.push([treeNode, repNode, cnt + 1]);\n        stack.push([treeNode.children[cnt], newNode, 0]);\n      }\n    }\n\n    return this.#repTree.indexes;\n  }\n  #generatePoints(indexes, lines, box, sampleNumber) {\n    // Generate sample x coordinates\n    const startX = box.minX,\n      endX = box.maxX,\n      xStride = (endX - startX) / sampleNumber,\n      xCoordinates = [];\n    for (let i = 0; i < sampleNumber + 1; i++) {\n      xCoordinates.push(i * xStride + startX);\n    }\n\n    const res = indexes.map((ind) => {\n      const line = lines[ind];\n      let pos1 = -1,\n        pos2 = -1,\n        xPos = 1;\n      const angle = [];\n      while (xPos <= sampleNumber) {\n        while (\n          pos1 + 1 < line.length &&\n          xCoordinates[xPos - 1] > line[pos1 + 1].x\n        ) {\n          pos1++;\n        }\n        while (\n          pos2 + 1 < line.length &&\n          xCoordinates[xPos] > line[pos2 + 1].x\n        ) {\n          pos2++;\n        }\n\n        try {\n          if (pos2 === -1 || pos1 === line.length - 1) angle.push(0);\n          else if (pos1 === -1 && pos2 === line.length - 1)\n            angle.push(getAngle(line[0], line[line.length - 1]));\n          else if (pos1 === -1)\n            angle.push(\n              getAngle(\n                line[0],\n                mix(line[pos2], line[pos2 + 1], xCoordinates[xPos])\n              )\n            );\n          else if (pos2 === line.length - 1)\n            angle.push(\n              getAngle(\n                mix(line[pos1], line[pos1 + 1], xCoordinates[xPos - 1] - 1e-5),\n                line[line.length - 1]\n              )\n            );\n          else\n            angle.push(\n              getAngle(\n                mix(line[pos1], line[pos1 + 1], xCoordinates[xPos - 1]),\n                mix(line[pos2], line[pos2 + 1], xCoordinates[xPos])\n              )\n            );\n        } catch (e) {\n          console.log(\n            pos1,\n            pos2,\n            line,\n            xCoordinates,\n            xCoordinates[xPos - 1],\n            mix(line[pos1], line[pos1 + 1], xCoordinates[xPos - 1])\n          );\n          throw Error();\n        }\n        xPos++;\n      }\n      // console.log(angle, xPos, sampleNumber);\n      // console.log(`This is pos1 ${pos1}, pos2: ${pos2}, line length: ${line.length}`);\n      // console.log(`Line information`, line);\n      // console.log(xCoordinates);\n      return angle;\n    });\n    return res;\n  }\n\n  #compareDist(a, b) {\n    return a.dist - b.dist;\n  }\n\n  #boxDist(x, y, box) {\n    var dx = this.#axisDist(x, box.minX, box.maxX),\n      dy = this.#axisDist(y, box.minY, box.maxY);\n    return dx * dx + dy * dy;\n  }\n\n  #axisDist(k, min, max) {\n    return k < min ? min - k : k <= max ? 0 : k - max;\n  }\n}\n\nexport function mix(point1, point2, x) {\n  const r = Math.max(\n      Math.min((x - point1.x) / (point2.x - point1.x), 1.0),\n      0.0\n    ),\n    l = 1 - r;\n  return { x: point1.x * l + point2.x * r, y: point1.y * l + point2.y * r };\n}\n\nfunction getAngle(point1, point2) {\n  if (point1.x === point2.x) {\n    console.log(point1, point2);\n    throw Error('Same x coordinate');\n  }\n  return Math.atan((point2.y - point1.y) / (point2.x - point1.x));\n}\nexport function getAngle2(point1, point2) {\n  if (point1[0] === point2[0]) {\n    console.log(point1, point2);\n    throw Error('Same x coordinate');\n  }\n  return Math.atan((point2[1] - point1[1]) / (point2[0] - point1[0]));\n}\n\nexport function sqr(x) {\n  return x * x;\n}\n\nexport function dist2(v, w) {\n  return sqr(v[0] - w[0]) + sqr(v[1] - w[1]);\n}\n\nexport function eq(x, y) {\n  return Math.abs(x - y) <= 1;\n}\nexport const updatePoint = (oldPoint, testPoint, newPoint) => {\n  if (eq(oldPoint[0], testPoint[0])) oldPoint[0] = newPoint[0];\n  if (eq(oldPoint[1], testPoint[1])) oldPoint[1] = newPoint[1];\n};\n\nexport const movePoint = (point, offsetX, offsetY) => {\n  point[0] += offsetX;\n  point[1] += offsetY;\n};\n\n// p - point\n// v - start point of segment\n// w - end point of segment\nexport function distToSegmentSquared(p, v, w) {\n  var l2 = dist2(v, w);\n  if (l2 === 0) return dist2(p, v);\n  var t = ((p[0] - v[0]) * (w[0] - v[0]) + (p[1] - v[1]) * (w[1] - v[1])) / l2;\n  t = Math.max(0, Math.min(1, t));\n  return dist2(p, [v[0] + t * (w[0] - v[0]), v[1] + t * (w[1] - v[1])]);\n}\n\n// p - point\n// v - start point of segment\n// w - end point of segment\nexport function distToSegment(p, v, w) {\n  return Math.sqrt(distToSegmentSquared(p, v, w));\n}\n\nexport function lineRectCollide(line, rect) {\n  // p=line startpoint, p2=line endpoint\n  var p = { x: line.x1, y: line.y1 };\n  var p2 = { x: line.x2, y: line.y2 };\n\n  // top rect line\n  var q = { x: rect.x, y: rect.y };\n  var q2 = { x: rect.x + rect.width, y: rect.y };\n  if (lineSegmentsCollide(p, p2, q, q2)) {\n    return true;\n  }\n  // right rect line\n  var q = q2;\n  var q2 = { x: rect.x + rect.width, y: rect.y + rect.height };\n  if (lineSegmentsCollide(p, p2, q, q2)) {\n    return true;\n  }\n  // bottom rect line\n  var q = q2;\n  var q2 = { x: rect.x, y: rect.y + rect.height };\n  if (lineSegmentsCollide(p, p2, q, q2)) {\n    return true;\n  }\n  // left rect line\n  var q = q2;\n  var q2 = { x: rect.x, y: rect.y };\n  if (lineSegmentsCollide(p, p2, q, q2)) {\n    return true;\n  }\n\n  // not intersecting with any of the 4 rect sides\n  return false;\n}\n\n// point object: {x:, y:}\n// p0 & p1 form one segment, p2 & p3 form the second segment\n// Get interseting point of 2 line segments (if any)\n// Attribution: http://paulbourke.net/geometry/pointlineplane/\nexport function lineSegmentsCollide(p0, p1, p2, p3) {\n  var unknownA = (p3.x - p2.x) * (p0.y - p2.y) - (p3.y - p2.y) * (p0.x - p2.x);\n  var unknownB = (p1.x - p0.x) * (p0.y - p2.y) - (p1.y - p0.y) * (p0.x - p2.x);\n  var denominator =\n    (p3.y - p2.y) * (p1.x - p0.x) - (p3.x - p2.x) * (p1.y - p0.y);\n\n  // Test if Coincident\n  // If the denominator and numerator for the ua and ub are 0\n  //    then the two lines are coincident.\n  if (unknownA == 0 && unknownB == 0 && denominator == 0) {\n    return null;\n  }\n\n  // Test if Parallel\n  // If the denominator for the equations for ua and ub is 0\n  //     then the two lines are parallel.\n  if (denominator == 0) return null;\n\n  // test if line segments are colliding\n  unknownA /= denominator;\n  unknownB /= denominator;\n  var isIntersecting =\n    unknownA >= 0 && unknownA <= 1 && unknownB >= 0 && unknownB <= 1;\n\n  return isIntersecting;\n}\n\nfunction standardDeviation(values) {\n  var avg = average(values);\n\n  var squareDiffs = values.map(function(value) {\n    var diff = value - avg;\n    var sqrDiff = diff * diff;\n    return sqrDiff;\n  });\n\n  var avgSquareDiff = average(squareDiffs);\n\n  var stdDev = Math.sqrt(avgSquareDiff);\n  return stdDev;\n}\n\nfunction average(data) {\n  var sum = data.reduce(function(sum, value) {\n    return sum + value;\n  }, 0);\n\n  var avg = sum / data.length;\n  return avg;\n}\n\nexport function calculateCurvature(points) {\n  if (points.length < 3) return [];\n  // return 0;\n\n  // let cnt = 0, curSum = 0, bendingEnergy = 0;\n  let result = [];\n  for (let i = 1; i < points.length - 1; i++) {\n    const step1 = points[i].x - points[i - 1].x + 0.001,\n      step2 = points[i + 1].x - points[i].x + 0.001,\n      step = Math.min(step1, step2);\n\n    let lstPoint = points[i - 1],\n      nxtPoint = points[i + 1];\n    if (step1 < step2) {\n      nxtPoint = mix(points[i], nxtPoint, points[i].x + step1);\n    } else {\n      lstPoint = mix(points[i - 1], points[i], points[i].x - step2);\n    }\n    const f1 = (nxtPoint.y - lstPoint.y) / step;\n    const f2 = (lstPoint.y - 2 * points[i].y + nxtPoint.y) / (step * step);\n    if (isNaN(f2)) {\n      console.log(step1, step2, points[i-1], points[i], points[i + 1])\n    }\n    result.push({\n      x: points[i].x,\n      y: Math.abs(f2) / Math.pow(1 + f1 * f1, 1.5),\n    });\n    // const c = Math.abs(f2) / Math.pow(1 + f1 * f1, 1.5);\n    // curSum += c* Math.sign(slopeR - slopeL);\n    // bendingEnergy += c * c;\n    // cnt ++;\n  }\n  // return curSum / cnt;\n  return result;\n  // return [curSum, bendingEnergy / cnt];\n}\n\nexport function calculateDifference(line1, line2, diverse) {\n  // return Math.abs(line1[0] - line2[0]) < diverse ||  Math.abs(line1[1] - line2[1]) < diverse;\n  // if (!line1.length || !line2.length)\n  //   return 0;\n  let cnt = 0,\n    sum = 0,\n    pos1 = 0,\n    pos2 = 0;\n  while (pos1 < line1.length && pos2 < line2.length) {\n    if (line1[pos1].x < line2[pos2].x) {\n      if (pos2 !== 0) {\n        const p2 = mix(line2[pos2 - 1], line2[pos2], line1[pos1].x);\n        sum += Math.abs(p2.y - line1[pos1].y);\n        cnt++;\n      }\n      pos1++;\n    } else if (line2[pos2].x < line1[pos1].x) {\n      if (pos1 !== 0) {\n        const p1 = mix(line1[pos1 - 1], line1[pos1], line2[pos2].x);\n        sum += Math.abs(p1.y - line2[pos2].y);\n        cnt++;\n      }\n      pos2++;\n    } else {\n      sum += Math.abs(line1[pos1].y - line2[pos2].y);\n      cnt++;\n      pos1++;\n      pos2++;\n    }\n    if (isNaN(sum)) {\n      // console.log(line1[pos1], line2[pos2]);\n      return 0.001;\n    }\n  }\n\n  return cnt === 0 ? 0.0001 : sum / cnt;\n  // return sum / cnt;\n}\n\nexport function brensenham(ls, hashmap, slope) {\n  let xx = Math.floor(ls[1].x);\n  let yy = Math.floor(ls[1].y);\n  let x = Math.floor(ls[0].x);\n  let y = Math.floor(ls[0].y);\n  if (xx == x) return;\n  if (Math.abs(yy - y) > Math.abs(xx - x)) {\n    if (yy < y) return brensenhamHigh(xx, yy, x, y, hashmap, slope);\n    return brensenhamHigh(x, y, xx, yy, hashmap, slope);\n  } else {\n    if (xx < x) return brensenhamLow(xx, yy, x, y, hashmap, slope);\n    return brensenhamLow(x, y, xx, yy, hashmap, slope);\n  }\n}\n\nfunction brensenhamLow(x0, y0, x1, y1, hashmap, slope) {\n  let delta = Math.min(1, Math.abs(1 / slope));\n  if (!isFinite(delta) || isNaN(delta)) delta = 1;\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let yi = dy < 0 ? ((dy = -dy), -1) : 1;\n  let D = 2 * dy - dx;\n  let first = true;\n  for (let x = x0, y = y0; x <= x1; ++x, D += 2 * dy) {\n    if (x >= 0 && x < 1000 && y >= 0 && y < 500) {\n      if (first) first = false;\n      else hashmap[x * 500 + y] += delta;\n    }\n    if (D > 0) (y += yi), (D -= 2 * dx);\n  }\n}\n\nfunction brensenhamHigh(x0, y0, x1, y1, hashmap, slope) {\n  let delta = Math.min(1, Math.abs(1 / slope));\n  if (!isFinite(delta) || isNaN(delta)) delta = 1;\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let xi = dx < 0 ? ((dx = -dx), -1) : 1;\n  let D = 2 * dx - dy;\n  let first = true;\n  for (let x = x0, y = y0; y <= y1; ++y, D += 2 * dx) {\n    if (x >= 0 && x < 1000 && y >= 0 && y < 500) {\n      if (first) first = false;\n      else hashmap[x * 500 + y] += delta;\n    }\n    if (D > 0) (x += xi), (D -= 2 * dy);\n  }\n}\n\nexport function brensenhamArr(ls, hashmap, lineId, slope) {\n  let xx = Math.floor(ls[1].x);\n  let yy = Math.floor(ls[1].y);\n  let x = Math.floor(ls[0].x);\n  let y = Math.floor(ls[0].y);\n  if (xx == x) return;\n  if (Math.abs(yy - y) > Math.abs(xx - x)) {\n    if (yy < y) return brensenhamArrHigh(xx, yy, x, y, hashmap, lineId, slope);\n    return brensenhamArrHigh(x, y, xx, yy, hashmap, lineId, slope);\n  } else {\n    if (xx < x) return brensenhamArrLow(xx, yy, x, y, hashmap, lineId, slope);\n    return brensenhamArrLow(x, y, xx, yy, hashmap, lineId, slope);\n  }\n}\n\nfunction brensenhamArrLow(x0, y0, x1, y1, hashmap, lineId, slope) {\n  let delta = Math.min(1, Math.abs(1 / slope));\n  if (!isFinite(delta) || isNaN(delta)) delta = 1;\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let yi = dy < 0 ? ((dy = -dy), -1) : 1;\n  let D = 2 * dy - dx;\n  let first = true;\n  for (let x = x0, y = y0; x <= x1; ++x, D += 2 * dy) {\n    if (x >= 0 && x < hashmap.length && y >= 0 && y < hashmap[0].length) {\n      if (first) first = false;\n      else hashmap[x][y][lineId] = (hashmap[x][y][lineId] ?? 0) + delta;\n    }\n    if (D > 0) (y += yi), (D -= 2 * dx);\n  }\n}\n\nfunction brensenhamArrHigh(x0, y0, x1, y1, hashmap, lineId, slope) {\n  let delta = Math.min(1, Math.abs(1 / slope));\n  if (!isFinite(delta) || isNaN(delta)) delta = 1;\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let xi = dx < 0 ? ((dx = -dx), -1) : 1;\n  let D = 2 * dx - dy;\n  let first = true;\n  for (let x = x0, y = y0; y <= y1; ++y, D += 2 * dx) {\n    if (x >= 0 && x < hashmap.length && y >= 0 && y < hashmap[0].length) {\n      if (first) first = false;\n      else hashmap[x][y][lineId] = (hashmap[x][y][lineId] ?? 0) + delta;\n    }\n    if (D > 0) (x += xi), (D -= 2 * dy);\n  }\n}\n","/**\n * @typedef {{x:number, y: number, z?: number}} Point\n * @typedef {{\n *  pos: Point[],\n *  cuv: Float32Array,\n *  fastID: Uint16Array | Uint32Array,\n *  offsets: Uint16Array | Uint32Array,\n *  sizes: Uint8Array | Uint16Array | Uint32Array,\n *  lineID: number[],\n *  segIndex: [number, number][],\n * }} TSRD segIndex: [segStart id, segEnd id, slope][]\n * @typedef {{segs: [Point, Point, number, number]}} CCHLeafNode\n * @typedef {{left: CCHInternalode|CCHLeafNode, right: CCHInternalode|CCHLeafNode}} CCHInternalode\n */\nimport { lineRectCollide } from \"./util\";\nimport Heap from \"heap\";\n\nconst kdparam = {\n  deg: 3,\n  b: 1.128,\n  k: 5,\n  r: 0.05,\n  cuveq: 0.06,\n};\n\n/**\n * @type {{\n *  id: number,\n *  value: number,\n *  point: Point\n * }}\n */\nlet globalHashCache = {};\n\nexport default class CCHTree {\n  /**\n   * @type {CCHInternalode}\n   */\n  root = null;\n  // prebuiltPixel = null;\n  segs = [];\n\n  /**\n   *\n   * @param {Point[][]} lines\n   * @param {number} precision\n   */\n  constructor(lines, precision = 1000) {\n    //#region init tsrd\n    //console.time('init tsrd');\n    //#region generate tsrd\n    //console.time('gen tsrd');\n    /**\n     * @type {TSRD}\n     */\n    const tsrd = {\n      pos: undefined,\n      cuv: undefined,\n      offsets: undefined,\n      sizes: undefined,\n      fastID: undefined,\n      lineID: [],\n      segIndex: [],\n    };\n\n    const totalPoints = lines.reduce((p, v) => p + v.length, 0);\n    const maxPoints = lines.reduce((p, v) => Math.max(p, v.length), 0);\n    const lineIndexType = lines.length > 65535 ? Uint32Array : Uint16Array;\n    const pointIndexType = totalPoints > 65535 ? Uint32Array : Uint16Array;\n    const sizeType =\n      maxPoints > 65535\n        ? Uint32Array\n        : maxPoints > 127\n        ? Uint16Array\n        : Uint8Array;\n    tsrd.pos = new Array(totalPoints);\n    tsrd.cuv = new Float32Array(totalPoints);\n    tsrd.fastID = new lineIndexType(totalPoints);\n    tsrd.offsets = new pointIndexType(lines.length);\n    tsrd.sizes = new sizeType(lines.length);\n\n    let pointer = 0;\n    lines.forEach((line, i) => {\n      tsrd.offsets[i] = pointer;\n      tsrd.sizes[i] = line.length;\n      line.forEach((point, j) => {\n        tsrd.pos[pointer] = point;\n        tsrd.fastID[pointer] = i;\n        if (j <= 0 || j >= line.length - 1) {\n          tsrd.cuv[pointer] = 0;\n        } else {\n          tsrd.cuv[pointer] = computeCurvature(line[j - 1], point, line[j + 1]);\n        }\n        pointer++;\n      });\n    });\n    // this.prebuiltPixel = new Map();\n    // for (let i = 0; i < 1000; i++) {\n    //   for (let j = 0; j < 500; j++) {\n    //     this.prebuiltPixel.set(`${i}-${j}`, []);\n    //   }\n    // }\n    //console.timeEnd('gen tsrd');\n    // console.log(tsrd);\n    //#endregion\n    //#region resample data\n    //console.time('resample data');\n    tsrd.sizes.forEach((size, i) => {\n      const beginIndex = tsrd.offsets[i];\n      const endIndex = size + beginIndex - 1;\n      splitIntoSegmentsByMaximumDistance(\n        beginIndex,\n        endIndex,\n        precision,\n        i,\n        tsrd\n      );\n    });\n    //console.timeEnd('resample data');\n    //#endregion\n    //console.timeEnd('init tsrd');\n    //#endregion\n    //#region prepare data\n    //console.time('prepare data');\n    // const weights = new Float64Array(tsrd.pos.length);\n    const length = new Float32Array(tsrd.pos.length);\n    let totalLen = 0;\n    let totalCount = 0;\n    tsrd.sizes.forEach((size, i) => {\n      const beginIndex = tsrd.offsets[i];\n      const endIndex = size + beginIndex - 1;\n      for (let j = beginIndex; j < endIndex; j++) {\n        const distance = pointDist(tsrd.pos[j], tsrd.pos[j + 1]);\n        length[j] = distance;\n        totalLen += distance;\n        ++totalCount;\n      }\n      length[endIndex] = 0;\n    });\n    // const averageLen = totalLen / totalCount;\n    // const expectCurvature = precision / averageLen;\n    // const defaultWeight = precision * averageLen;\n\n    tsrd.sizes.forEach((size, i) => {\n      const beginIndex = tsrd.offsets[i];\n      const endIndex = size + beginIndex - 1;\n      for (let j = beginIndex + 1; j < endIndex; j++) {\n        // const avgLength = (length[j] + length[j - 1]) / 2;\n        // weights[j] = tsrd.cuv[j] * avgLength;\n        const right = pointSub(tsrd.pos[j + 1], tsrd.pos[j]);\n        const left = pointSub(tsrd.pos[j], tsrd.pos[j - 1]);\n        tsrd.pos[j].z =\n          (length[j] * (right.y / right.x) +\n            length[j - 1] * (left.y / left.x)) /\n          (length[j] + length[j - 1]);\n        if (j === beginIndex + 1) {\n          tsrd.pos[beginIndex].z = left.y / left.x;\n        }\n        if (j === endIndex - 1) {\n          tsrd.pos[endIndex].z = right.y / right.x;\n        }\n      }\n      // weights[beginIndex] = defaultWeight;\n      // weights[endIndex] = defaultWeight;\n    });\n\n    const allci = [];\n    let curSegIndex = 0;\n\n    tsrd.sizes.forEach((size, i) => {\n      const beginIndex = tsrd.offsets[i];\n      const endIndex = size + beginIndex;\n      const ci = {\n        aabb: undefined,\n        from: beginIndex,\n        to: endIndex - 1,\n        sp: [],\n      };\n      allci.push(ci);\n      updateAABB(ci, tsrd.pos);\n      let lastIndex = -1;\n      while (curSegIndex < tsrd.segIndex.length) {\n        const cs = tsrd.segIndex[curSegIndex];\n        if (tsrd.fastID[cs[0]] < i) {\n          ++curSegIndex;\n          continue;\n        } else if (tsrd.fastID[cs[0]] > i) {\n          --curSegIndex;\n          break;\n        }\n        if (lastIndex !== cs[0]) {\n          ci.sp.push(cs[0]);\n        }\n        ci.sp.push(cs[1]);\n        lastIndex = cs[1];\n        ++curSegIndex;\n      }\n    });\n    //console.timeEnd('prepare data');\n    //#endregion\n    //#region split\n    //console.time('split');\n    const stacks = [];\n    const segMapping = new Map();\n    // let segcount = 0;\n    // let totalTry = 0;\n    // let futileTry = 0;\n    stacks.push(allci, false, null, 0);\n    while (stacks.length) {\n      //console.time('single stack');\n      const si = stacks.slice(stacks.length - 4, stacks.length);\n      //console.time('compute variance & dim');\n      // let average = { x: 0, y: 0 };\n      // let variance = { x: 0, y: 0 };\n      let minv = tsrd.pos[si[0][0].from];\n      let maxv = minv;\n      // let pointCount = 0;\n      for (let ci of si[0]) {\n        // pointCount += ci.to - ci.from + 1;\n        // for (let i = ci.from; i <= ci.to; i++) {\n        //   average = pointAdd(average, tsrd.pos[i]);\n        // }\n        minv = pointMin(ci.aabb.a, minv);\n        maxv = pointMax(ci.aabb.b, maxv);\n      }\n      const delta = pointSub(maxv, minv);\n      // average = pointDiv(average, pointCount);\n      // for (let ci of si[0]) {\n      //   for (let i = ci.from; i <= ci.to; i++) {\n      //     const delta0 = pointSub(average, tsrd.pos[i]);\n      //     variance = pointAdd(variance, pointMultiply(delta0, delta0));\n      //   }\n      // }\n      //console.timeEnd('compute variance & dim');\n\n      // //console.time('extract variance for each dim');\n      // let vars = [];\n      // vars.push([variance.x, 0], [variance.y, 1], [variance.z, 2]);\n      // vars.sort((a, b) => a[0] - b[0]);\n      // //console.timeEnd('extract variance for each dim');\n\n      //console.time('try each dim');\n      let leftResult = [],\n        rightResult = [];\n      const allc2 = countSegs(si[0]);\n      // const allc = countWeight(si[0], weights, defaultWeight);\n      let pass = false;\n      let dim = 0;\n      let expectPos = 0;\n\n      // Accelerate first 3 level\n      const level = si[3];\n      const startDim = level > 2 ? 0 : level;\n      const endDim = level > 2 ? 2 : level;\n      // const startDim = 0;\n      // const endDim = 2;\n\n      if(level < 10){\n        for (let dimIndex = startDim; dimIndex <= endDim; dimIndex++) {\n          if (delta[dim2xyz(dim)] < kdparam.r * 2) {\n            continue;\n          }\n          dim = dimIndex;\n\n          let candidates = [];\n          // let totalWeight = 0;\n          for (let ci of si[0]) {\n            for (let i = ci.from + 1; i < ci.to; i++) {\n              const candidatePos = tsrd.pos[i][dim2xyz(dim)] ?? 0;\n              // candidates.push([candidatePos, weights[i]]);\n              candidates.push([candidatePos]);\n              // totalWeight += weights[i];\n            }\n            let cpos1 = tsrd.pos[ci.from][dim2xyz(dim)] ?? 0;\n            let cpos2 = tsrd.pos[ci.to][dim2xyz(dim)] ?? 0;\n            // candidates.push([cpos1, defaultWeight + weights[ci.from]]);\n            // candidates.push([cpos2, defaultWeight + weights[ci.to]]);\n            candidates.push([cpos1]);\n            candidates.push([cpos2]);\n            // totalWeight += defaultWeight * 2;\n          }\n\n          expectPos = getMidWeightedVal(candidates, 0.5);\n\n          leftResult = [];\n          rightResult = [];\n          splitCurves(dim, expectPos, si[0], leftResult, rightResult, tsrd);\n          const leftC2 = countSegs(leftResult);\n          const rightC2 = countSegs(rightResult);\n          const leftCurveCount = leftResult.length;\n          const rightCurveCount = rightResult.length;\n          const p = (expectPos - minv[dim2xyz(dim)]) / delta[dim2xyz(dim)];\n          const cost = computeCost(leftC2, rightC2, allc2, p, 0, 0);\n\n          if (\n            cost < allc2 &&\n            leftCurveCount >= kdparam.k &&\n            rightCurveCount >= kdparam.k &&\n            delta[dim2xyz(dim)] * p > kdparam.r &&\n            delta[dim2xyz(dim)] * (1 - p) > kdparam.r\n          ) {\n            pass = true;\n            break;\n          }\n        }\n      }\n\n      //console.timeEnd('try each dim');\n\n      //console.time('LR split');\n      if (pass) {\n        const ns = {\n          dim,\n          pos: expectPos,\n        };\n        if (si[2] === null) {\n          this.root = ns;\n        } else {\n          connectNode(si[2], ns, si[1]);\n        }\n        stacks.pop();\n        stacks.pop();\n        stacks.pop();\n        stacks.pop();\n        stacks.push(\n          leftResult,\n          true,\n          ns,\n          si[3] + 1,\n          rightResult,\n          false,\n          ns,\n          si[3] + 1\n        );\n      } else {\n        const startIndex = this.segs.length;\n        const nl = { segs: [] };\n        for (let ci of si[0]) {\n          let lastIndex = ci.from;\n          for (let currIndex of ci.sp) {\n            if (lastIndex == currIndex) continue;\n            const key = `${tsrd.pos[lastIndex].x}-${tsrd.pos[currIndex].x}-${tsrd.fastID[currIndex]}`;\n            const mapKey = segMapping.get(key);\n            if (mapKey !== undefined) {\n              nl.segs.push(mapKey);\n            } else {\n              const diff = pointSub(tsrd.pos[currIndex], tsrd.pos[lastIndex]);\n              const ls = [\n                tsrd.pos[lastIndex],\n                tsrd.pos[currIndex],\n                diff.y / diff.x,\n                tsrd.fastID[currIndex],\n              ];\n              const lid = this.segs.length;\n              this.segs.push(ls);\n              nl.segs.push(lid);\n              segMapping.set(key, lid);\n              // brensenham(ls, lid, this.prebuiltPixel);\n            }\n            lastIndex = currIndex;\n          }\n          if (lastIndex == ci.to) continue;\n          const key = `${tsrd.pos[lastIndex].x}-${tsrd.pos[ci.to].x}-${\n            tsrd.fastID[ci.to]\n          }`;\n          const mapKey = segMapping.get(key);\n          if (mapKey !== undefined) {\n            nl.segs.push(mapKey);\n          } else {\n            const diff = pointSub(tsrd.pos[lastIndex], tsrd.pos[ci.to]);\n            const ls = [\n              tsrd.pos[lastIndex],\n              tsrd.pos[ci.to],\n              diff.y / diff.x,\n              tsrd.fastID[ci.to],\n            ];\n            const lid = this.segs.length;\n            this.segs.push(ls);\n            nl.segs.push(lid);\n            segMapping.set(key, lid);\n            // brensenham(ls, lid, this.prebuiltPixel);\n          }\n        }\n        const endIndex = this.segs.length - 1;\n\n        // segcount += nl.segs.length;\n        if (si[2] === null) {\n          this.root = nl;\n        } else {\n          connectNode(si[2], nl, si[1]);\n        }\n        stacks.pop();\n        stacks.pop();\n        stacks.pop();\n        stacks.pop();\n      }\n      //console.timeEnd('LR split');\n      //console.timeEnd('single stack');\n    }\n\n    //console.timeEnd('split');\n    //#endregion\n  }\n\n  /**\n   *\n   * @param {[number, number]} point\n   * @param {number} k\n   * @returns {number[]}\n   */\n  knn(point, k) {\n    globalHashCache = {};\n    const result = new Heap((a, b) => b.value - a.value);\n    this.#search(result, { x: point[0], y: point[1] }, k, this.root);\n    // console.log(result.toArray());\n    return result.toArray();\n  }\n\n  rnn(point, r) {\n    // if (r <= 1 && r > 0) {\n    //   const search = { x: point[0], y: point[1] };\n    //   return this.ghost(point)\n    //     .map((segId) => {\n    //       const seg = this.segs[segId];\n    //       const ap = pointSub(search, seg[0]);\n    //       let dir = pointSub(seg[1], seg[0]);\n    //       ap.z = 0;\n    //       dir.z = 0;\n    //       const len = Math.sqrt(pointDot(dir, dir));\n    //       dir = pointDiv(dir, len);\n    //       const dv = pointDot(ap, dir);\n    //       const lineId = seg[3];\n    //       let dis, point;\n    //       if (dv <= 0) {\n    //         dis = pointDist2D(seg[0], search);\n    //         point = seg[0];\n    //       } else if (dv >= len) {\n    //         dis = pointDist2D(seg[1], search);\n    //         point = seg[1];\n    //       } else {\n    //         dis = Math.sqrt(pointDot(ap, ap) - dv * dv);\n    //         point = pointAdd(seg[0], pointMul(dir, dv));\n    //       }\n    //       return {\n    //         id: lineId,\n    //         value: dis,\n    //         point,\n    //       };\n    //     })\n    //     .filter((seg) => seg.value <= r);\n    // }\n    const result = {};\n    this.#searchRNN(result, { x: point[0], y: point[1] }, r, this.root);\n    // console.log(Object.values(result));\n    return Object.values(result);\n  }\n\n  brush(lo, hi) {\n    const result = new Set();\n    this.#range(\n      result,\n      { x: lo[0], y: lo[1], z: -Infinity },\n      { x: hi[0], y: hi[1], z: Infinity },\n      {\n        a: { x: -Infinity, y: -Infinity, z: -Infinity },\n        b: { x: Infinity, y: Infinity, z: Infinity },\n      },\n      this.root\n    );\n    const removal = new Set();\n    this.#range(\n      removal,\n      { x: lo[0], y: lo[1] - 1, z: -Infinity },\n      { x: hi[0], y: lo[1], z: Infinity },\n      {\n        a: { x: -Infinity, y: -Infinity, z: -Infinity },\n        b: { x: Infinity, y: Infinity, z: Infinity },\n      },\n      this.root\n    );\n    this.#range(\n      removal,\n      { x: lo[0], y: hi[1], z: -Infinity },\n      { x: hi[0], y: hi[1] + 1, z: Infinity },\n      {\n        a: { x: -Infinity, y: -Infinity, z: -Infinity },\n        b: { x: Infinity, y: Infinity, z: Infinity },\n      },\n      this.root\n    );\n    return [...result].filter((x) => !removal.has(x));\n  }\n\n  angular(lo, hi) {\n    const result = new Set();\n    this.#range(\n      result,\n      { x: lo[0], z: lo[1], y: -Infinity },\n      { x: hi[0], z: hi[1], y: Infinity },\n      {\n        a: { x: -Infinity, y: -Infinity, z: -Infinity },\n        b: { x: Infinity, y: Infinity, z: Infinity },\n      },\n      this.root\n    );\n\n    const removal = new Set();\n    this.#range(\n      removal,\n      { x: lo[0], z: hi[1], y: -Infinity },\n      { x: hi[0], z: Infinity, y: Infinity },\n      {\n        a: { x: -Infinity, y: -Infinity, z: -Infinity },\n        b: { x: Infinity, y: Infinity, z: Infinity },\n      },\n      this.root\n    );\n\n    this.#range(\n      removal,\n      { x: lo[0], z: -Infinity, y: -Infinity },\n      { x: hi[0], z: lo[1], y: Infinity },\n      {\n        a: { x: -Infinity, y: -Infinity, z: -Infinity },\n        b: { x: Infinity, y: Infinity, z: Infinity },\n      },\n      this.root\n    );\n    return [...result].filter((x) => !removal.has(x));\n  }\n\n  // ghost(point) {\n  //   return this.prebuiltPixel.get(`${point[0]}-${point[1]}`);\n  // }\n\n  #search(result, point, k, node) {\n    if (!node || k <= 0) return;\n    if (node.segs) {\n      // Leaf node\n      return this.#searchLeaf(result, point, k, node);\n    }\n    const s = point[dim2xyz(node.dim)];\n    if (s < node.pos) {\n      this.#search(result, point, k, node.left);\n      if (result.top().value > node.pos - s || result.size() < k) {\n        this.#search(result, point, k, node.right);\n      }\n    } else {\n      this.#search(result, point, k, node.right);\n      if (result.top().value > s - node.pos || result.size() < k) {\n        this.#search(result, point, k, node.left);\n      }\n    }\n  }\n\n  #searchLeaf(result, search, k, node) {\n    for (let i of node.segs) {\n      const seg = this.segs[i];\n      const ap = pointSub(search, seg[0]);\n      let dir = pointSub(seg[1], seg[0]);\n      ap.z = 0;\n      dir.z = 0;\n      const len = Math.sqrt(pointDot(dir, dir));\n      dir = pointDiv(dir, len);\n      const dv = pointDot(ap, dir);\n      const lineId = seg[3];\n      let dis, point;\n      if (dv <= 0) {\n        dis = pointDist2D(seg[0], search);\n        point = seg[0];\n      } else if (dv >= len) {\n        dis = pointDist2D(seg[1], search);\n        point = seg[1];\n      } else {\n        dis = Math.sqrt(pointDot(ap, ap) - dv * dv);\n        point = pointAdd(seg[0], pointMul(dir, dv));\n      }\n      const obj = {\n        id: lineId,\n        value: dis,\n        point,\n      };\n      this.#insertHeapLimit(result, k, obj);\n    }\n  }\n\n  #insertHeapLimit(heap, k, obj) {\n    if (globalHashCache[obj.id] === undefined) {\n      if (heap.size() < k) {\n        heap.push(obj);\n      } else {\n        heap.pushpop(obj);\n      }\n      globalHashCache[obj.id] = obj;\n    } else if (obj.value < globalHashCache[obj.id].value) {\n      globalHashCache[obj.id].value = obj.value;\n      globalHashCache[obj.id].point = obj.point;\n      heap.updateItem(obj);\n    }\n  }\n\n  #searchRNN(result, point, r, node) {\n    if (!node || r <= 0) return;\n    if (node.segs) {\n      // Leaf node\n      return this.#searchLeafRNN(result, point, r, node);\n    }\n    const s = point[dim2xyz(node.dim)];\n    if (s < node.pos) {\n      this.#searchRNN(result, point, r, node.left);\n      if (r > node.pos - s) {\n        this.#searchRNN(result, point, r, node.right);\n      }\n    } else {\n      this.#searchRNN(result, point, r, node.right);\n      if (r > s - node.pos) {\n        this.#searchRNN(result, point, r, node.left);\n      }\n    }\n  }\n\n  #searchLeafRNN(result, search, r, node) {\n    for (let i of node.segs) {\n      const seg = this.segs[i];\n      const ap = pointSub(search, seg[0]);\n      let dir = pointSub(seg[1], seg[0]);\n      ap.z = 0;\n      dir.z = 0;\n      const len = Math.sqrt(pointDot(dir, dir));\n      dir = pointDiv(dir, len);\n      const dv = pointDot(ap, dir);\n      const lineId = seg[3];\n      let dis, point;\n      if (dv <= 0) {\n        dis = pointDist2D(seg[0], search);\n        point = seg[0];\n      } else if (dv >= len) {\n        dis = pointDist2D(seg[1], search);\n        point = seg[1];\n      } else {\n        dis = Math.sqrt(pointDot(ap, ap) - dv * dv);\n        point = pointAdd(seg[0], pointMul(dir, dv));\n      }\n      if (dis < r) {\n        if (result[lineId] === undefined) {\n          result[lineId] = {\n            id: lineId,\n            value: dis,\n            point,\n          };\n        } else if (result[lineId].value > dis) {\n          result[lineId].value = dis;\n          result[lineId].point = point;\n        }\n      }\n    }\n  }\n\n  #range(result, p1, p2, aabb, node) {\n    if (p1.x >= p2.x || p1.y >= p2.y || p1.z >= p2.z || !node) return;\n    if (node.segs) {\n      return this.#rangeLeaf(result, p1, p2, node);\n    }\n    if (\n      aabb.a.x >= p1.x &&\n      aabb.a.y >= p1.y &&\n      aabb.a.z >= p1.z &&\n      aabb.b.x <= p2.x &&\n      aabb.b.y <= p2.y &&\n      aabb.b.z <= p2.z\n    ) {\n      return this.#iterRange(result, p1, p2, node);\n    }\n    const s1 = p1[dim2xyz(node.dim)];\n    const s2 = p2[dim2xyz(node.dim)];\n    let skipLeft = false,\n      skipRight = false;\n    if (s1 >= node.pos) {\n      skipLeft = true;\n    }\n    if (s2 <= node.pos) {\n      skipRight = true;\n    }\n    skipLeft ||\n      this.#range(\n        result,\n        p1,\n        p2,\n        {\n          a: aabb.a,\n          b: { ...aabb.b, [dim2xyz(node.dim)]: node.pos },\n        },\n        node.left\n      );\n    skipRight ||\n      this.#range(\n        result,\n        p1,\n        p2,\n        {\n          a: { ...aabb.a, [dim2xyz(node.dim)]: node.pos },\n          b: aabb.b,\n        },\n        node.right\n      );\n  }\n\n  #iterRange(result, p1, p2, node) {\n    if (!node) return;\n    if (node.segs) {\n      return this.#rangeLeaf(result, p1, p2, node);\n    }\n    this.#iterRange(result, p1, p2, node.left);\n    this.#iterRange(result, p1, p2, node.right);\n  }\n\n  #rangeLeaf(result, p1, p2, node) {\n    for (let i of node.segs) {\n      const seg = this.segs[i];\n      const lineId = seg[3];\n      if (!result.has(lineId)) {\n        if (isFinite(p1.z) || isFinite(p2.z)) {\n          if (\n            seg[2] >= p1.z &&\n            seg[2] <= p2.z &&\n            seg[0].x < p2.x &&\n            seg[1].x > p1.x\n          ) {\n            result.add(lineId);\n          }\n        } else {\n          if (\n            (seg[0].x >= p1.x &&\n              seg[0].y >= p1.y &&\n              seg[0].x <= p2.x &&\n              seg[0].y <= p2.y) ||\n            (seg[1].x >= p1.x &&\n              seg[1].y >= p1.y &&\n              seg[1].x <= p2.x &&\n              seg[1].y <= p2.y) ||\n            lineRectCollide(\n              { x1: seg[0].x, y1: seg[0].y, x2: seg[1].x, y2: seg[1].y },\n              { x: p1.x, y: p1.y, width: p2.x - p1.x, height: p2.y - p1.y }\n            )\n          )\n            result.add(lineId);\n        }\n      }\n    }\n  }\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @param {Point} p3\n * @return {number}\n */\nfunction computeCurvature(p1, p2, p3) {\n  const a = pointDist(p1, p2);\n  const b = pointDist(p3, p2);\n  const c = pointDist(p1, p3);\n\n  const cosC = (a * a + b * b - c * c) / 2 / a / b;\n  const sinC = Math.sqrt(1 - sqr(cosC));\n  const curvature = (2 * sinC) / c;\n  return curvature;\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {number}\n */\nfunction pointDist(p1, p2) {\n  return Math.sqrt(\n    sqr(p1.x - p2.x) + sqr(p1.y - p2.y) + sqr((p1.z ?? 0) - (p2.z ?? 0))\n  );\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {number}\n */\nfunction pointDist2D(p1, p2) {\n  return Math.sqrt(sqr(p1.x - p2.x) + sqr(p1.y - p2.y));\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {Point}\n */\nfunction pointAdd(p1, p2) {\n  return { x: p1.x + p2.x, y: p1.y + p2.y, z: (p1.z ?? 0) + (p2.z ?? 0) };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {Point}\n */\nfunction pointSub(p1, p2) {\n  return { x: p1.x - p2.x, y: p1.y - p2.y, z: (p1.z ?? 0) - (p2.z ?? 0) };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {Point}\n */\nfunction pointMultiply(p1, p2) {\n  return {\n    x: p1.x * p2.x,\n    y: p1.y * p2.y,\n    z: (p1.z ?? 0) * (p2.z ?? 0),\n  };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {number} scalar\n * @return {Point}\n */\nfunction pointMul(p1, scalar) {\n  return { x: p1.x * scalar, y: p1.y * scalar, z: (p1.z ?? 0) * scalar };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {number} scalar\n * @return {Point}\n */\nfunction pointDiv(p1, scalar) {\n  return { x: p1.x / scalar, y: p1.y / scalar, z: (p1.z ?? 0) / scalar };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {Point}\n */\nfunction pointMin(p1, p2) {\n  return {\n    x: Math.min(p1.x, p2.x),\n    y: Math.min(p1.y, p2.y),\n    z: Math.min(p1.z ?? 0, p2.z ?? 0),\n  };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {Point}\n */\nfunction pointMax(p1, p2) {\n  return {\n    x: Math.max(p1.x, p2.x),\n    y: Math.max(p1.y, p2.y),\n    z: Math.max(p1.z ?? 0, p2.z ?? 0),\n  };\n}\n\n/**\n *\n * @param {Point} p1\n * @param {Point} p2\n * @return {number}\n */\nfunction pointDot(p1, p2) {\n  return p1.x * p2.x + p1.y * p2.y + (p1.z ?? 0) * (p2.z ?? 0);\n}\n\n/**\n *\n * @param {Point} p\n * @return {Point}\n */\nfunction pointNormalize(p) {\n  const l = Math.sqrt(sqr(p.x) + sqr(p.y) + sqr(p.z ?? 0));\n  return { x: p.x / l, y: p.y / l, z: (p.z ?? 0) / l };\n}\n\n/**\n *\n * @param {number} n\n * @return {number}\n */\nfunction sqr(n) {\n  return n * n;\n}\n\n/**\n *\n * @param {number} from\n * @param {number} to\n * @param {number} threshold\n * @param {TSRD} tsrd\n */\nfunction splitIntoSegmentsByMaximumDistance(from, to, threshold, line, tsrd) {\n  if (to < from) return;\n  if (to - from <= 1) {\n    applySegment(from, to, line, tsrd);\n    return;\n  }\n  const beginPos = tsrd.pos[from];\n  const endPos = tsrd.pos[to];\n  const dir = pointNormalize(pointSub(endPos, beginPos));\n  let maximumDis = 0;\n  let bestIndex = from;\n  for (let i = from; i <= to; i++) {\n    const curPos = tsrd.pos[i];\n    const ap = pointSub(curPos, beginPos);\n    const abLen = pointDot(ap, dir);\n    const curDis = pointDot(ap, ap) - abLen * abLen;\n    if (curDis > maximumDis) {\n      bestIndex = i;\n      maximumDis = curDis;\n    }\n  }\n  if (maximumDis < threshold || bestIndex === from || bestIndex === to) {\n    applySegment(from, to, line, tsrd);\n  } else {\n    splitIntoSegmentsByMaximumDistance(from, bestIndex, threshold, line, tsrd);\n    splitIntoSegmentsByMaximumDistance(bestIndex, to, threshold, line, tsrd);\n  }\n}\n\n/**\n *\n * @param {number} from\n * @param {number} to\n * @param {TSRD} tsrd\n */\nfunction applySegment(from, to, line, tsrd) {\n  // const start = tsrd.pos[from];\n  // const end = tsrd.pos[to];\n  tsrd.lineID.push(line);\n  // tsrd.segIndex.push([from, to, (end.y - start.y) / (end.x - start.x)]);\n  tsrd.segIndex.push([from, to]);\n}\n\n/**\n *\n * @param {*} org\n * @returns {number}\n */\nfunction countSegs(org) {\n  let count = 0;\n  for (let ci of org) {\n    count += ci.sp.length + 1;\n  }\n  return count;\n}\n\n/**\n *\n * @param {*} org\n * @param {Float32Array} w\n * @param {number} defaultv\n * @returns {number}\n */\n// function countWeight(org, w, defaultv) {\n//   let count = 0;\n//   for (let ci of org) {\n//     for (let i = ci.from + 1; i < ci.to; i++) {\n//       count += w[i];\n//     }\n//     count += defaultv;\n//   }\n//   return count / defaultv;\n// }\n\nfunction getMidWeightedVal(data, weight) {\n  data.sort((a, b) => a[0] < b[0]);\n  return data[Math.floor(data.length / 2)][0];\n  // return randomizedWeightedSelect(data, 0, data.length - 1, weight, 0, 0);\n}\n\n// function randomizedWeightedSelect(a, p, r, w, wlsum, wrsum) {\n//   const q = randomizedPartition(a, p, r);\n//   let wl = wlsum,\n//     wr = wrsum;\n//   for (let i = p; i < q; i++) wl += a[i][1];\n//   for (let i = q + 1; i <= r; i++) wr += a[i][1];\n//   const curw = a[q][1];\n//   const allw = wl + wr + curw;\n//   const expectW = allw * w;\n//   if ((wl <= expectW && wr <= expectW) || p >= r) return a[q][0];\n//   if (wl > expectW && p != q)\n//     return randomizedWeightedSelect(a, p, q - 1, w, wlsum, wr + curw);\n//   if (r != q) return randomizedWeightedSelect(a, q + 1, r, w, wl + curw, wrsum);\n//   return a[q][0];\n// }\n\n// function randomizedPartition(a, p, r) {\n//   const i = p + Math.round(Math.random() * (r - p));\n//   swap(a, i, r);\n//   return partition(a, p, r);\n// }\n\n// function partition(a, p, r) {\n//   const x = a[r];\n//   let i = p - 1,\n//     j;\n//   for (j = p; j < r; j++) {\n//     if (a[j][0] < x[0]) {\n//       i++;\n//       swap(a, i, j);\n//     }\n//   }\n//   swap(a, j, i + 1);\n//   return i + 1;\n// }\n\n// function swap(a, i, j) {\n//   const temp = a[i];\n//   a[i] = a[j];\n//   a[j] = temp;\n// }\n\nfunction dim2xyz(dim) {\n  return dim == 0 ? \"x\" : dim == 1 ? \"y\" : \"z\";\n}\n\nfunction updateAABB(ci, pos) {\n  const beginIndex = ci.from;\n  const endIndex = ci.to;\n  ci.aabb = {\n    a: {\n      x: pos[beginIndex].x,\n      y: pos[beginIndex].y,\n      z: pos[beginIndex].z ?? 0,\n    },\n    b: {\n      x: pos[beginIndex].x,\n      y: pos[beginIndex].y,\n      z: pos[beginIndex].z ?? 0,\n    },\n  };\n  for (let j = beginIndex + 1; j <= endIndex; j++) {\n    ci.aabb = {\n      a: {\n        x: Math.min(ci.aabb.a.x, pos[j].x),\n        y: Math.min(ci.aabb.a.y, pos[j].y),\n        z: Math.min(ci.aabb.a.z, pos[j].z ?? 0),\n      },\n      b: {\n        x: Math.max(ci.aabb.b.x, pos[j].x),\n        y: Math.max(ci.aabb.b.y, pos[j].y),\n        z: Math.max(ci.aabb.b.z, pos[j].z ?? 0),\n      },\n    };\n  }\n}\n\nfunction splitCurves(dim, pos, org, resultLeft, resultRight, tsrd) {\n  for (let ci of org) {\n    let a = ci.aabb.a[dim2xyz(dim)];\n    let b = ci.aabb.b[dim2xyz(dim)];\n    if (a > b) {\n      const temp = a;\n      a = b;\n      b = temp;\n    }\n    if (pos <= a) {\n      resultRight.push(ci);\n    } else if (pos >= b) {\n      resultLeft.push(ci);\n    } else {\n      let candidateIndex = 0;\n      let newci = { sp: [] };\n      let lastNewci = newci;\n      let curIsLeft = tsrd.pos[ci.from][dim2xyz(dim)] < pos;\n      newci.from = ci.from;\n      for (let index = ci.from + 1; index <= ci.to; index++) {\n        const p = tsrd.pos[index][dim2xyz(dim)];\n        let changed = false;\n        if (p < pos) {\n          if (!curIsLeft) {\n            newci.to = index;\n            resultRight.push(newci);\n            lastNewci = newci;\n            checkSpUnion(lastNewci, tsrd);\n            updateAABB(lastNewci, tsrd.pos);\n            newci = { sp: [] };\n            newci.from = index - 1;\n            curIsLeft = true;\n            changed = true;\n          }\n        } else {\n          if (curIsLeft) {\n            newci.to = index;\n            resultLeft.push(newci);\n            lastNewci = newci;\n            checkSpUnion(lastNewci, tsrd);\n            updateAABB(lastNewci, tsrd.pos);\n            newci = { sp: [] };\n            newci.from = index - 1;\n            curIsLeft = false;\n            changed = true;\n          }\n        }\n\n        if (ci.sp.length > candidateIndex) {\n          if (ci.sp[candidateIndex] < index) ++candidateIndex;\n          if (ci.sp[candidateIndex] == index) {\n            if (!changed) {\n              let lc = newci.sp;\n              newci.sp.push(index);\n            } else {\n              let lc = lastNewci.sp;\n              lc.push(index);\n            }\n          }\n        }\n      }\n      newci.to = ci.to;\n      if (curIsLeft) {\n        resultLeft.push(newci);\n        updateAABB(newci, tsrd.pos);\n      } else {\n        resultRight.push(newci);\n        updateAABB(newci, tsrd.pos);\n      }\n    }\n  }\n}\n\nfunction checkSpUnion(result, tsrd) {\n  if (!result.sp || result.sp.length == 0) return;\n  if (result.sp.length == 1) {\n    if (canUnion(result.from, result.sp[0], result.to, tsrd)) {\n      result.sp = [];\n    }\n  } else if (result.sp.length > 1) {\n    let shiftFlag = false,\n      popFlag = false;\n    if (canUnion(result.from, result.sp[0], result.sp[1], tsrd)) {\n      shiftFlag = true;\n    }\n    if (\n      canUnion(\n        result.sp[result.sp.length - 2],\n        result.sp[result.sp.length - 1],\n        result.to,\n        tsrd\n      )\n    ) {\n      popFlag = true;\n    }\n    if (shiftFlag) {\n      result.sp.shift();\n    }\n    if (popFlag) {\n      result.sp.pop();\n    }\n  }\n}\n\nfunction canUnion(ai, bi, ci, tsrd) {\n  const cosLimit = Math.cos((kdparam.deg / 180) * Math.PI);\n  const a = tsrd.pos[ai];\n  const b = tsrd.pos[bi];\n  const c = tsrd.pos[ci];\n  const dirAB = pointNormalize(pointSub(b, a));\n  const dirBC = pointNormalize(pointSub(c, b));\n  const cosValue = pointDot(dirAB, dirBC);\n  return isNaN(cosValue) || cosValue >= cosLimit;\n}\n\nfunction computeCost(l, r, n, p, x, y, factor) {\n  const leftRatio = n / (l + 1e-10);\n  let leftV;\n  if (leftRatio <= 1) {\n    return Infinity;\n  }\n  leftV = Math.log(n) / Math.log(leftRatio);\n\n  const rightRatio = n / (r + 1e-10);\n  let rightV;\n  if (rightRatio <= 1) {\n    return Infinity;\n  }\n\n  if (p == 0 || p == 1) {\n    return Infinity;\n  }\n  rightV = Math.log(n) / Math.log(rightRatio);\n\n  // const wL = computeW(n, x / p, y / p);\n  // const wR = computeW(n, x / (1 - p), y / (1 - p));\n  const cost1 = p * l + (1 - p) * r;\n  const cost2 = (leftV + rightV) * 0.5;\n  return cost1 + cost2 * kdparam.b;\n}\n\n// function computeW(n, x, y) {\n//   const a = 53.20996717; // 2.04518789f;\n//   const b = 55.29978444; // 2.73675685f;\n//   const c = 197.2404396; // 23.68092824f;\n//   const d = 1.06480181; // 7.8658251f;\n//   // const float e = 0.02091861f;\n//   const result = ((1 - a / (b + x)) * (1 - a / (b + y)) * c) / (n + d); // +e;\n//   return Math.min(1, result);\n// }\n\nfunction connectNode(father, node, isLeft) {\n  if (isLeft) {\n    father.left = node;\n  } else {\n    father.right = node;\n  }\n}\n\n// function generateSeg(from, to, tsrd) {\n//   let si;\n//   const segID = segs.length;\n// }\n\n/**\n *\n * @param {[Point, Point]} ls\n * @param {number} id\n * @param {Map<string, number[]>} hashmap\n */\nexport function brensenham(ls, id, hashmap) {\n  let xx = Math.floor(ls[1].x);\n  let yy = Math.floor(ls[1].y);\n  let x = Math.floor(ls[0].x);\n  let y = Math.floor(ls[0].y);\n  if (Math.abs(yy - y) > Math.abs(xx - x)) {\n    if (yy < y) return brensenhamHigh(xx, yy, x, y, id, hashmap);\n    return brensenhamHigh(x, y, xx, yy, id, hashmap);\n  } else {\n    if (xx < x) return brensenhamLow(xx, yy, x, y, id, hashmap);\n    return brensenhamLow(x, y, xx, yy, id, hashmap);\n  }\n}\n\nfunction brensenhamLow(x0, y0, x1, y1, id, hashmap) {\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let yi = dy < 0 ? ((dy = -dy), -1) : 1;\n  let D = 2 * dy - dx;\n  for (let x = x0, y = y0; x <= x1; ++x, D += 2 * dy) {\n    hashmap.get(`${x}-${y}`)?.push(id);\n    if (D > 0) (y += yi), (D -= 2 * dx);\n  }\n}\n\nfunction brensenhamHigh(x0, y0, x1, y1, id, hashmap) {\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let xi = dx < 0 ? ((dx = -dx), -1) : 1;\n  let D = 2 * dx - dy;\n  for (let x = x0, y = y0; y <= y1; ++y, D += 2 * dx) {\n    hashmap.get(`${x}-${y}`)?.push(id);\n    if (D > 0) (x += xi), (D -= 2 * dy);\n  }\n}\n","<template>\n  <div>\n    <div\n        style=\"display:flex;flex-direction:row;align-items:center;margin:15px 0 15px 20px;position:relative\"\n    >\n      <div\n          id=\"blank-div\"\n          style=\"width: 1000px; height: 500px; opacity: 0; pointer-events: none;\"\n      ></div>\n      <canvas\n          id=\"canvas\"\n          :width=\"option.width\"\n          :height=\"option.height\"\n          style=\"transform: scaleY(1); position: absolute; left: 0; top: 0;\"\n          @mousedown=\"canvasMousedown\"\n          @mouseup=\"canvasMouseup\"\n          @mousemove=\"canvasMousemove\"\n          @wheel=\"canvasWheel\"\n          @contextmenu=\"mouseContextmenu\"\n          @mouseleave=\"canvasMouseleave\"\n      ></canvas>\n      <canvas\n          id=\"selectionCanvas\"\n          :width=\"option.width\"\n          :height=\"option.height\"\n          style=\"transform: scaleY(1); position: absolute; left: 0; top: 0; pointer-events: none;\"\n      >\n      </canvas>\n      <canvas\n          id=\"selectionLayer\"\n          width=\"1000\"\n          height=\"500\"\n          style=\"\n          transform: scaleY(1);\n          position: absolute;\n          left: 0;\n          top: 0;\n          pointer-events: none;\n        \"\n      ></canvas>\n      <canvas\n          id=\"rep_layer\"\n          width=\"1000\"\n          height=\"500\"\n          style=\"transform: scaleY(1); position: absolute; left: 0; top: 0; pointer-events: none;\"\n      >\n      </canvas>\n      <canvas\n          id=\"raw_lines\"\n          width=\"1000\"\n          height=\"500\"\n          style=\"transform: scaleY(1); position: absolute; left: 0; top: 0; pointer-events: none;\"\n      >\n      </canvas>\n      <canvas\n          id=\"mouseLayer\"\n          width=\"1000\"\n          height=\"500\"\n          style=\"\n          transform: scaleY(1);\n          position: absolute;\n          left: 0;\n          top: 0;\n          pointer-events: none;\n          z-index: 999;\n        \"\n      ></canvas>\n      <canvas\n          id=\"hoverLayer\"\n          width=\"1000\"\n          height=\"500\"\n          style=\"\n          transform: scaleY(1);\n          position: absolute;\n          left: 0;\n          top: 0;\n          pointer-events: none;\n          z-index: 999;\n        \"\n      ></canvas>\n      <svg\n          id=\"axisHelper\"\n          :width=\"1050\"\n          :height=\"550\"\n          style=\"\n          position: absolute;\n          left: -50px;\n          top: -20px;\n          pointer-events: none;\n          color: black;\n          z-index: 999;\n          overflow: visible;\n        \"\n      >\n        <g id=\"cursorHelper\" transform=\"translate(50,20)\">\n          <line stroke=\"black\" stroke-dasharray=\"10 5\"></line>\n          <line stroke=\"black\" stroke-dasharray=\"10 5\"></line>\n          <text font-size=\"12px\"></text>\n          <text font-size=\"12px\"></text>\n        </g>\n      </svg>\n      <div\n          ref=\"axisTop\"\n          style=\"width:1000px;height:30px;position:absolute;top:-30px;left:0\"\n      ></div>\n      <div\n          ref=\"axisBottom\"\n          style=\"width:1000px;height:30px;position:absolute;bottom:-30px;left:0\"\n      ></div>\n      <div\n          ref=\"axisLeft\"\n          style=\"width:30px;height:500px;position:absolute;top:0px;left:-30px\"\n      ></div>\n      <div class=\"control-panel\">\n        <div>\n          <span>Filter line by: </span>\n          <RadioGroup v-model=\"filterMode\" type=\"button\">\n            <!-- <Radio label=\"knn\">KNN</Radio> -->\n            <Radio label=\"rnn\">RNL</Radio>\n            <Radio label=\"brush\">Brush</Radio>\n            <Radio label=\"ang\">Angle</Radio>\n            <Radio label=\"attr\">Attr</Radio>\n            <Radio label=\"hover\">Hover</Radio>\n          </RadioGroup>\n        </div>\n        <!-- <div>\n          <span>Switch brush query method: </span>\n          <RadioGroup v-model=\"brushMethod\" type=\"button\" size=\"small\">\n            <Radio label=\"tree\">KD Tree</Radio>\n            <Radio label=\"seq\">Seq</Radio>\n            <Radio label=\"new\">Inc</Radio>\n          </RadioGroup>\n        </div> -->\n        <div v-if=\"filterMode === 'attr'\" style=\"margin-left: 2em;\">\n          <Form>\n            <FormItem label=\"Attribute Column\">\n              <Select\n                  v-model=\"attributeColumn\"\n                  placeholder=\"Choose a column for attribute filtering\"\n              >\n                <Option\n                    v-for=\"header in headers\"\n                    :value=\"header.key\"\n                    :key=\"header.title\"\n                >{{ header.title }}\n                </Option\n                >\n              </Select>\n            </FormItem>\n            <FormItem label=\"Value\">\n              <AutoComplete\n                  v-model=\"attributeValue\"\n                  :data=\"attributeData\"\n                  @on-search=\"handleSearch\"\n              ></AutoComplete>\n            </FormItem>\n            <Button type=\"info\" style=\"float: right\" @click=\"addAttrQuery\"\n            >add attribute query\n            </Button\n            >\n          </Form>\n          <!--          <span>Column Name</span>-->\n          <!--          <span>Attribute Value</span>-->\n        </div>\n        <div>\n          <span>Representative line parameters: </span>\n          <!-- <RadioGroup v-model=\"rawMode\" type=\"button\">\n          <Radio label=\"null\">Null</Radio>\n          <Radio label=\"cur\">Hover</Radio>\n          <Radio label=\"out\">Min</Radio>\n          <Radio label=\"rep\">Max</Radio>\n        </RadioGroup> -->\n        </div>\n        <div v-if=\"rawMode == 'rep'\" style=\"margin-left:2em\">\n          <div style=\"display:flex;align-items:center\">\n            <span style=\"margin-right:8px\">Line count</span>\n            <Slider\n                v-model=\"repCount\"\n                :min=\"1\"\n                :max=\"20\"\n                :step=\"1\"\n                show-tip=\"never\"\n                style=\"flex-grow:1\"\n            />\n            <span style=\"margin-left:8px\">{{ repCount }}</span>\n\n            <span style=\"margin-right:8px; margin-left: 12px;\">Diverse</span>\n            <Slider\n                v-model=\"diverse\"\n                :min=\"0\"\n                :max=\"maxDiverse\"\n                :step=\"maxDiverse / 20\"\n                show-tip=\"never\"\n                style=\"flex-grow:1\"\n                @on-change=\"cnt++\"\n            />\n          </div>\n          <div style=\"display:flex;align-items:center\"></div>\n        </div>\n        <!--        <div v-if=\"rawMode != 'null'\">-->\n        <!--          <div v-for=\"i in [0, 1, 2]\" :key=\"i\">-->\n        <!--            <span-->\n        <!--            ><ColorPicker v-model=\"colorMap[i]\" recommend alpha></ColorPicker-->\n        <!--            ></span>-->\n        <!--            <Poptip-->\n        <!--                trigger=\"hover\"-->\n        <!--                placement=\"bottom-end\"-->\n        <!--                :width=\"800\"-->\n        <!--                title=\"Data preview\"-->\n        <!--                @on-popper-show=\"previewIndex = rawLines[i]\"-->\n        <!--            >-->\n        <!--              <span style=\"margin-left:12px\" v-if=\"i < rawLineNames.length\">{{-->\n        <!--                  rawLineNames[i]-->\n        <!--                }}</span>-->\n        <!--              <div slot=\"content\">-->\n        <!--                <Table :columns=\"headers\" :data=\"previewData\" />-->\n        <!--              </div>-->\n        <!--            </Poptip>-->\n        <!--          </div>-->\n        <!--        </div>-->\n        <div style=\"position:relative\">\n          <div class=\"select-colormap\">\n            <span style=\"margin:0\">Colormap:</span>\n            <Select\n                id=\"colormap\"\n                placeholder=\"Choose colormap\"\n                v-model=\"colormapIndexCache\"\n            >\n              <Option value=\"0\">viridis</Option>\n              <Option value=\"1\" selected>magma</Option>\n              <Option value=\"2\">inferno</Option>\n              <Option value=\"3\">plasma</Option>\n              <Option value=\"4\">cividis</Option>\n              <Option value=\"5\">turbo</Option>\n              <Option value=\"6\">bluegreen</Option>\n              <Option value=\"7\">bluepurple</Option>\n              <Option value=\"8\">goldgreen</Option>\n              <Option value=\"9\">goldorange</Option>\n              <Option value=\"10\">goldred</Option>\n              <Option value=\"11\">greenblue</Option>\n              <Option value=\"12\">orangered</Option>\n              <Option value=\"13\">purplebluegreen</Option>\n              <Option value=\"14\">purpleblue</Option>\n              <Option value=\"15\">purplered</Option>\n              <Option value=\"16\">redpurple</Option>\n              <Option value=\"17\">yellowgreenblue</Option>\n              <Option value=\"18\">yellowgreen</Option>\n              <Option value=\"19\">yelloworangebrown</Option>\n              <Option value=\"20\">yelloworangered</Option>\n            </Select>\n          </div>\n          <span>1</span>\n          <span class=\"color-map\" id=\"color-map\"></span>\n          <InputNumber\n              :min=\"1\"\n              v-model=\"maxDensity\"\n              :active-change=\"false\"\n              style=\"width: 50px\"\n          />\n        </div>\n\n        <!-- <Button icon=\"md-cloud-download\" type=\"primary\" @click=\"exportFig\"\n        >export figure\n        </Button\n        > -->\n        <div>\n          <span>Layers:</span>\n        </div>\n        <div style=\"margin-left:2em\">\n          <draggable v-model=\"layers\">\n            <div\n                v-for=\"layer in layers\"\n                :key=\"layer.id\"\n                style=\"display:flex;align-items:center;border:1px solid #dcdee2;margin-top:4px;background:white;cursor:pointer;border-radius:4px;padding:0 8px\"\n            >\n              <Icon type=\"md-menu\" style=\"cursor:move\"/>\n              <!-- <Poptip\n                v-if=\"layer.id == 'selectionCanvas'\"\n                :width=\"340\"\n                :offset=\"62\"\n                trigger=\"click\"\n              >\n                <p style=\"width:170px;padding-left: 12px\">\n                  {{ layer.name }}\n                </p>\n                <div slot=\"content\" style=\"display:flex;align-items:center\">\n                  <div class=\"select-colormap\">\n                    <span style=\"margin:0\">Colormap:</span>\n                    <Select\n                      id=\"colormap\"\n                      placeholder=\"Choose colormap\"\n                      v-model=\"colormapOverlayIndexCache\"\n                    >\n                      <Option value=\"0\">viridis</Option>\n                      <Option value=\"1\" selected>magma</Option>\n                      <Option value=\"2\">inferno</Option>\n                      <Option value=\"3\">plasma</Option>\n                      <Option value=\"4\">cividis</Option>\n                      <Option value=\"5\">turbo</Option>\n                      <Option value=\"6\">bluegreen</Option>\n                      <Option value=\"7\">bluepurple</Option>\n                      <Option value=\"8\">goldgreen</Option>\n                      <Option value=\"9\">goldorange</Option>\n                      <Option value=\"10\">goldred</Option>\n                      <Option value=\"11\">greenblue</Option>\n                      <Option value=\"12\">orangered</Option>\n                      <Option value=\"13\">purplebluegreen</Option>\n                      <Option value=\"14\">purpleblue</Option>\n                      <Option value=\"15\">purplered</Option>\n                      <Option value=\"16\">redpurple</Option>\n                      <Option value=\"17\">yellowgreenblue</Option>\n                      <Option value=\"18\">yellowgreen</Option>\n                      <Option value=\"19\">yelloworangebrown</Option>\n                      <Option value=\"20\">yelloworangered</Option>\n                    </Select>\n                  </div>\n                  <span>1</span>\n                  <span class=\"color-map\" id=\"color-map\"></span>\n                  <InputNumber\n                    :min=\"1\"\n                    v-model=\"maxOverlayDensity\"\n                    :active-change=\"false\"\n                    style=\"width: 50px\"\n                  />\n                </div>\n              </Poptip> -->\n              <div style=\"flex-grow:1\">\n                <div style=\"display:flex;align-items:center\">\n                  <p style=\"width:170px;padding-left: 12px\">\n                    {{ layer.name }}\n                  </p>\n                  <Icon\n                      :type=\"layer.opacity === 0 ? 'md-eye-off' : 'md-eye'\"\n                      :style=\"{ opacity: layer.opacity * 0.7 + 0.3 }\"\n                      @click=\"layer.opacity = layer.opacity === 0 ? 1 : 0\"\n                  />\n                  <Slider\n                      v-model=\"layer.opacity\"\n                      :min=\"0\"\n                      :max=\"1\"\n                      :step=\"0.01\"\n                      show-tip=\"never\"\n                      style=\"flex-grow:1; margin-left:12px;margin-right:8px\"\n                  />\n                </div>\n                <div\n                    v-if=\"layer.id == 'selectionCanvas'\"\n                    style=\"display:flex;align-items:center;margin:0 12px 8px;position:relative\"\n                >\n                  <div class=\"select-colormap\">\n                    <span style=\"margin:0\">Colormap:</span>\n                    <Select\n                        id=\"colormapOverlay\"\n                        placeholder=\"Choose colormap\"\n                        v-model=\"colormapOverlayIndexCache\"\n                    >\n                      <Option value=\"0\">viridis</Option>\n                      <Option value=\"1\" selected>magma</Option>\n                      <Option value=\"2\">inferno</Option>\n                      <Option value=\"3\">plasma</Option>\n                      <Option value=\"4\">cividis</Option>\n                      <Option value=\"5\">turbo</Option>\n                      <Option value=\"6\">bluegreen</Option>\n                      <Option value=\"7\">bluepurple</Option>\n                      <Option value=\"8\">goldgreen</Option>\n                      <Option value=\"9\">goldorange</Option>\n                      <Option value=\"10\">goldred</Option>\n                      <Option value=\"11\">greenblue</Option>\n                      <Option value=\"12\">orangered</Option>\n                      <Option value=\"13\">purplebluegreen</Option>\n                      <Option value=\"14\">purpleblue</Option>\n                      <Option value=\"15\">purplered</Option>\n                      <Option value=\"16\">redpurple</Option>\n                      <Option value=\"17\">yellowgreenblue</Option>\n                      <Option value=\"18\">yellowgreen</Option>\n                      <Option value=\"19\">yelloworangebrown</Option>\n                      <Option value=\"20\">yelloworangered</Option>\n                    </Select>\n                  </div>\n                  <span>1</span>\n                  <span class=\"color-map\" id=\"color-map-overlay\"></span>\n                  <InputNumber\n                      :min=\"1\"\n                      v-model=\"maxOverlayDensity\"\n                      :active-change=\"false\"\n                      style=\"width: 50px\"\n                  />\n                </div>\n              </div>\n            </div>\n          </draggable>\n        </div>\n\n        <!-- <Button icon=\"ios-apps\" type=\"primary\" @click=\"showRepData\"\n          >view selected data\n        </Button> -->\n\n        <div>\n          <span>Show value of cursor:</span>\n          <iSwitch style=\"margin-left:12px\" v-model=\"showCursorValue\"/>\n        </div>\n        <div>\n          <span>Reverse y-axis:</span>\n          <iSwitch style=\"margin-left:12px\" v-model=\"upsideDown\"/>\n        </div>\n        <div>\n          <span>Normalize density:</span>\n          <iSwitch style=\"margin-left:12px\" v-model=\"normalizeDensity\"/>\n        </div>\n        <div>\n          <span>Enlarge Axis Font Size:</span>\n          <iSwitch style=\"margin-left:12px\" v-model=\"enlargeFont\"/>\n        </div>\n      </div>\n    </div>\n    <Table\n        :row-class-name=\"calClassName\"\n        border\n        :columns=\"tableColumns\"\n        :data=\"cnt + 1 && tableData\"\n        :on-current-change=\"hoveringQuery\"\n        id=\"informationTable\"\n        style=\"margin-top: 30px\"\n    >\n      <template slot-scope=\"{ row, index }\" slot=\"name\">\n        <p\n            v-if=\"index >= tableData.length - 2\"\n            style=\"font-style:italic;font-weight:700\"\n        >\n          {{ row.name }}\n        </p>\n        <div v-else>{{ row.name }}</div>\n      </template>\n      <template slot-scope=\"{ row, index }\" slot=\"op\">\n        <Button\n            ghost\n            :type=\"row.query === selectedQuery ? 'primary' : 'default'\"\n            size=\"small\"\n            style=\"margin-right: 5px\"\n            @click=\"selectedQuery = row.query\"\n        >Explore\n        </Button>\n        <!-- <Button\n          type=\"warning\"\n          style=\"margin-right: 5px\"\n          size=\"small\"\n          v-if=\"index < tableData.length - 2\"\n          >Invisible\n        </Button> -->\n        <Button\n            type=\"error\"\n            size=\"small\"\n            v-if=\"index < tableData.length - 2\"\n            @click=\"deleteQuery(index)\"\n        >Delete\n        </Button>\n      </template>\n    </Table>\n    <Button\n        type=\"error\"\n        size=\"small\"\n        style=\"float: right; margin: 20px\"\n        @click=\"deleteAllQuery\"\n    >\n      Delete all Querys\n    </Button>\n    <Modal v-model=\"repModal\" width=\"1000\" :closable=\"false\">\n      <p slot=\"header\" style=\"color:dodgerblue;text-align:center\">\n        <Icon type=\"ios-information-circle\"></Icon>\n        <span>Representative Line Information</span>\n      </p>\n      <Table border :columns=\"repColumns\" :data=\"repStaticInformation\"></Table>\n      <div slot=\"footer\">\n        <Button type=\"primary\" size=\"large\" long @click=\"repModal = false\"\n        >Confirm\n        </Button\n        >\n      </div>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport draggable from \"vuedraggable\";\nimport {exportCanvas} from \"../core/utils\";\nimport unobserve from \"../store\";\nimport render from \"../core\";\nimport * as d3 from \"d3\";\nimport expandRow from \"@/components/expandRow\";\nimport {\n  calculateCurvature,\n  calculateDifference,\n  dist2, distToSegment, distToSegmentSquared,\n  eq,\n  getAngle2,\n  lineRectCollide,\n  lineSegmentsCollide,\n  mix,\n  movePoint,\n  sqr,\n  updatePoint,\n} from \"@/core/util\";\nimport KDTree from \"../core/kdtree\";\nimport seedrandom from \"seedrandom\";\nimport moment from \"moment\";\nimport {brensenham, brensenhamArr} from \"../core/util\";\n\nconst colorMapCache = {};\n\nexport default {\n  props: {\n    timeIndex: Number,\n    valueIndex: Number,\n    timeName: String,\n    valueName: String,\n    filter: Float32Array,\n    option: Object,\n    // layers: Array,\n    // headers: Array,\n  },\n  components: {\n    draggable,\n  },\n  data() {\n    return {\n      canvas: null,\n      contextHandler: null,\n      canvasContext: null,\n      rawLineContext: null,\n      filterMode: \"brush\",\n      brushMethod: \"tree\",\n      rawMode: \"rep\",\n      repCount: 3,\n      diverse: 0.1,\n      maxDiverse: 1.0,\n      calculatedMaxDiverse: false,\n      cursor: \"crosshair\",\n      mouseDown: false,\n      listener: null,\n      hoverListener: null,\n      hoveringInd: null,\n      coord: [0, 0, 0, 0, 0],\n      boxes: [],\n      maxDensity: null,\n      maxOverlayDensity: null,\n      rawLines: [],\n      colorMap: [\"aqua\", \"limegreen\", \"lightgreen\"],\n      upsideDown: false,\n      showCursorValue: true,\n      normalizeDensity: true,\n      enlargeFont: false,\n      headers: [],\n      previewIndex: -1,\n      selectedQuery: \"$int\",\n      tableColumns: [\n        {\n          type: \"expand\",\n          width: 50,\n          render: (h, params) =>\n              h(expandRow, {\n                props: {\n                  row: params.row.reps,\n                },\n              }),\n        },\n        {title: \"Query\", align: \"center\", slot: \"name\"},\n        // { title: 'Min start time', align: 'center', key: 'minT' },\n        // { title: 'Max start time', align: 'center', key: 'maxT' },\n        {title: \"Line series count\", align: \"center\", key: \"count\"},\n        {title: \"Time points count\", align: \"center\", key: \"points\"},\n        {title: \"Min value\", align: \"center\", key: \"minV\"},\n        {title: \"Max value\", align: \"center\", key: \"maxV\"},\n        {title: \"Mean value\", align: \"center\", key: \"mean\"},\n        {title: \"Variance\", align: \"center\", key: \"var\"},\n        {title: \"Operations\", align: \"center\", slot: \"op\", width: 250},\n      ],\n      repColumns: [\n        {title: \"Index num.\", align: \"center\", key: \"name\"},\n        {title: \"Min start time\", align: \"center\", key: \"minT\"},\n        {title: \"Max start time\", align: \"center\", key: \"maxT\"},\n        {title: \"Min value\", align: \"center\", key: \"minV\"},\n        {title: \"Max value\", align: \"center\", key: \"maxV\"},\n        {title: \"Mean value\", align: \"center\", key: \"mean\"},\n      ],\n      layers: [\n        {\n          id: \"rep_layer\",\n          name: \"representative line\",\n          opacity: 1,\n        },\n        {\n          id: \"selectionCanvas\",\n          name: \"selected density\",\n          opacity: 0,\n        },\n        {\n          id: \"selectionLayer\",\n          name: \"selected line\",\n          opacity: 0.4,\n        },\n        {\n          id: \"canvas\",\n          name: \"density\",\n          opacity: 1,\n        },\n        {\n          id: \"raw_lines\",\n          name: \"raw line\",\n          opacity: 0,\n        },\n      ],\n      colormapIndexCache: 17,\n      colormapOverlayIndexCache: 20,\n      initDensityCache: null,\n      initDensityBufferCache: null,\n      initDensityMaxCache: 0,\n      currentDensityMax: 0,\n      currentDensity: null,\n      distanceCache: {},\n      colorCache: {},\n      querys: [],\n      preview: null,\n      modify: null,\n      mark: false,\n      selectionLayerContext: null,\n      repLayerContext: null,\n      rawLinesLayerContext: null,\n      mouseLayerContext: null,\n      queryResult: [],\n      xScale: null,\n      yScaleC: null,\n      yScale: null,\n      cursorHelper: null,\n      svg: null,\n\n      tr: null,\n      cnt: 0,\n      renderSelectedDensity: 0,\n\n      // representative line presentation\n      repModal: false,\n      repStaticInformation: [],\n\n      attributeColumn: null,\n      attributeValue: null,\n      attributeData: [],\n    };\n  },\n  computed: {\n    rawLineNames() {\n      return [...this.rawLines].map((i) => unobserve.aggregatedData[i].key);\n    },\n    upsideDownFactor() {\n      return this.upsideDown ? -1 : 1;\n    },\n    previewData() {\n      if (this.previewIndex < 0) return [];\n      return [...unobserve.aggregatedData[this.previewIndex].ref]\n          .slice(0, 6)\n          .map((i, ii) =>\n              ii == 5 ? this.headers.map((_) => \"...\") : unobserve.data[i]\n          );\n    },\n    tableData() {\n      if (!this.cnt) {\n        return [];\n      }\n      let res = [];\n      let mp = {\n        brush: \"Brush\",\n        ang: \"Angle\",\n        knn: \"KNN\",\n        rnn: \"Radius\",\n        attr: \"Attribute\",\n        hover: 'Hover',\n      };\n      for (let i = 0; i < unobserve.querys.length; i++) {\n        if (!unobserve.querys[i].reps)\n          unobserve.querys[i].reps = this.calcRepLines([\n            ...unobserve.querys[i].cache,\n          ]);\n        res.push({\n          _expanded: i == this.selectedQuery,\n          query: i,\n          name: mp[unobserve.querys[i].type],\n          ...this.getStaticInformation([...unobserve.querys[i].cache]),\n          reps: unobserve.querys[i].reps.map((id) => {\n            return {\n              id,\n              name: unobserve.aggregatedData[id].key,\n              color: `rgb(${this.getColor(id).join(\",\")})`,\n              ...this.getStaticInformation([id]),\n            };\n          }),\n        });\n      }\n\n      // console.log(\"this is unoberserve interResult\");\n      // console.log(unobserve.interResult);\n      unobserve.interReps = this.calcRepLines(unobserve.interResult);\n      res.push({\n        _expanded: \"$int\" == this.selectedQuery,\n        query: \"$int\",\n        name: unobserve.querys.length ? \"intersection\" : \"global\",\n        ...this.getStaticInformation(\n            unobserve.querys.length\n                ? unobserve.interResult\n                : new Array(unobserve.aggregatedData.length).fill().map((_, i) => i)\n        ),\n        reps: (unobserve.querys.length\n                ? unobserve.interReps\n                : unobserve.globalRep\n        ).map((id) => {\n          return {\n            id,\n            name: unobserve.aggregatedData[id].key,\n            color: `rgb(${this.getColor(id).join(\",\")})`,\n            ...this.getStaticInformation([id]),\n          };\n        }),\n      });\n\n      if (unobserve.querys.length) {\n        unobserve.unionReps = this.calcRepLines(unobserve.unionResult);\n        res.push({\n          _expanded: \"$uni\" == this.selectedQuery,\n          query: \"$uni\",\n          name: \"union\",\n          ...this.getStaticInformation(unobserve.unionResult),\n          reps: unobserve.unionReps.map((id) => {\n            return {\n              id,\n              name: unobserve.aggregatedData[id].key,\n              color: `rgb(${this.getColor(id).join(\",\")})`,\n              ...this.getStaticInformation([id]),\n            };\n          }),\n        });\n      }\n      return res;\n    },\n  },\n  watch: {\n    enlargeFont(newValue) {\n      if (newValue) {\n        this.svg.select('#xaxis').attr('font-size', '16px');\n        this.svg.select('#yaxis').attr('font-size', '16px');\n        this.svg.select('#xaxis').attr('stroke-width', '2px');\n        this.svg.select('#yaxis').attr('stroke-width', '2px');\n      } else {\n        this.svg.select('#xaxis').attr('font-size', '12px');\n        this.svg.select('#yaxis').attr('font-size', '12px');\n        this.svg.select('#xaxis').attr('stroke-width', '1px');\n        this.svg.select('#yaxis').attr('stroke-width', '1px');\n      }\n    },\n    colormapIndexCache(value) {\n      console.log(value);\n      this.renderColorMap();\n      this.renderAllDensity();\n    },\n    colormapOverlayIndexCache() {\n      this.renderColorMapOverlay();\n      this.renderDensity();\n    },\n    repCount(value) {\n      this.renderBoxes();\n    },\n    layers: {\n      deep: true,\n      handler(value) {\n        unobserve.layers = value;\n        this.rearrangeLayer(value);\n        for (let i in value) {\n          const layer = value[i];\n          if (layer.id === \"selectionCanvas\") {\n            if (!this.renderSelectedDensity && layer.opacity > 0)\n              this.renderDensity();\n            this.renderSelectedDensity = layer.opacity > 0;\n          }\n        }\n      },\n    },\n    showCursorValue() {\n      this.svg\n          .select(\"#cursorHelper\")\n          .selectAll(\"line\")\n          .attr(\"x1\", 0)\n          .attr(\"y1\", 0)\n          .attr(\"x2\", 0)\n          .attr(\"y2\", 0);\n      this.svg\n          .select(\"#cursorHelper\")\n          .selectAll(\"text\")\n          .attr(\"x\", 0)\n          .attr(\"y\", 0)\n          .text(\"\");\n    },\n    upsideDown(value) {\n      unobserve.upsideDown = value;\n      this.svg\n          .select(\"#cursorHelper\")\n          .selectAll(\"line\")\n          .attr(\"x1\", 0)\n          .attr(\"y1\", 0)\n          .attr(\"x2\", 0)\n          .attr(\"y2\", 0);\n      this.svg\n          .select(\"#cursorHelper\")\n          .selectAll(\"text\")\n          .attr(\"x\", 0)\n          .attr(\"y\", 0)\n          .text(\"\");\n      this.setReverseY(value);\n    },\n    filter(value) {\n      this.contextHandler.rerender(value);\n      this.getTopK();\n    },\n    contextHandler() {\n      if (this.filter) {\n        this.contextHandler.rerender(this.filter);\n      }\n    },\n    filterMode(newV, oldV) {\n      if (oldV === 'hover') {\n        this.initCanvas(unobserve.hoverLayer);\n      }\n    },\n    rawMode() {\n      this.getTopK();\n    },\n    maxDensity() {\n      this.renderAllDensity();\n    },\n    maxOverlayDensity() {\n      this.renderDensity();\n    },\n    diverse() {\n      // this.getTopK();\n      clearTimeout(unobserve.diverseChange);\n      unobserve.diverseChange = setTimeout(() => {\n        this.renderBoxes();\n        this.cnt++;\n      }, 50);\n      // this.drawLine();\n    },\n    selectedQuery(newValue, oldValue) {\n      if (newValue === oldValue) return;\n      this.renderBoxes();\n      this.renderDensity();\n    },\n    colorMap() {\n      const kArray = this.rawLines;\n      this.rawLineContext.clearRect(0, 0, this.option.width, this.option.height);\n      const colorMap = this.colorMap;\n      for (let i = 0; i < kArray.length; i++) {\n        const data = unobserve.aggregatedData[kArray[i]];\n        this.rawLineContext.globalAlpha = 1;\n        this.rawLineContext.strokeStyle = colorMap[i % 3];\n        this.rawLineContext.lineWidth = 2;\n        this.rawLineContext.beginPath();\n        this.rawLineContext.moveTo(\n            (data[this.timeIndex][0] / this.contextHandler.maxX) * this.option.width,\n            this.option.height - (data[this.valueIndex][0] / this.contextHandler.maxY) * this.option.height\n        );\n        for (let j = 0; j < data[this.timeIndex].length; j++) {\n          this.rawLineContext.lineTo(\n              (data[this.timeIndex][j] / this.contextHandler.maxX) * this.option.width,\n              this.option.height - (data[this.valueIndex][j] / this.contextHandler.maxY) * this.option.height\n          );\n        }\n        this.rawLineContext.stroke();\n      }\n    },\n    normalizeDensity() {\n      this.renderAllDensity(true);\n      this.renderDensity();\n    },\n  },\n  methods: {\n    convertPoint(point) {\n      return [this.xScale(unobserve.axisXScle.invert(point[0])), this.yScale(unobserve.screenyScale.invert(point[1]))];\n    },\n    reconvertPoint(point) {\n      return [unobserve.axisXScle(this.xScale.invert(point[0])), unobserve.screenyScale(this.yScale.invert(point[1]))];\n    },\n    inRadius(ids, point,  radius, inCurrent = false) {\n      const r2 = radius * radius;\n      // const cache = new Set(this.getSelectedIds());\n      point = this.reconvertPoint(point);\n      console.log(unobserve.cache);\n      return ids\n          .filter(id => {\n            if (inCurrent && unobserve.cache && !unobserve.cache.has(id))\n              return false;\n            const line = unobserve.screenResult[id];\n            let mx = Infinity;\n            for (let i = 0; i < line.length - 1; i++) {\n              let dis = distToSegmentSquared(point, [line[i].x, line[i].y], [line[i+1].x, line[i+1].y]);\n              if (dis < mx)\n                mx = dis;\n            }\n            return mx <= r2;\n          })\n    },\n    leaveQuery(index) {\n      this.mark = false;\n      this.renderBoxes(\"mouseLayer\");\n    },\n    handleSearch(value) {\n      console.log(value);\n      if (this.attributeColumn === undefined || !value.length) {\n        this.attributeData = [];\n        return;\n      }\n      const name = unobserve.headers[this.attributeColumn];\n      const datas = unobserve.headerMap.get(name);\n      console.log(unobserve.headerMap);\n      console.log(name, datas, this.attributeValue);\n      this.attributeData = datas\n          .filter((str) => str.slice(0, value.length) === value)\n          .slice(0, 10);\n    },\n    hoveringQuery(index) {\n      console.log(index);\n      if (index >= unobserve.querys.length) return;\n      this.hovering(index);\n    },\n\n    addAttrQuery() {\n      unobserve.querys.push({\n        type: \"attr\",\n        info: {\n          ind: this.attributeColumn,\n          val: this.attributeValue,\n        },\n      });\n      // console.log(unobserve.querys);\n      this.renderBoxes();\n      this.cnt++;\n    },\n\n    deleteAllQuery() {\n      unobserve.querys = [];\n      this.renderBoxes();\n      this.cnt++;\n    },\n    deleteQuery(query) {\n      let flag = false;\n      if (this.selectedQuery === query) {\n        flag = true;\n      }\n      unobserve.querys.splice(query, 1);\n      if (flag) this.selectedQuery = \"$int\";\n      this.renderBoxes();\n      this.cnt++;\n      this.renderDensity();\n    },\n\n    canvasMouseleave(e) {\n      if (this.filterMode === 'hover') {\n        setTimeout(() => {\n          clearTimeout(unobserve.hoverEvent);\n          this.initCanvas(unobserve.hoverLayer);\n        }, 100);\n      }\n    },\n\n    // event handler part\n    canvasMousedown(e) {\n      // if the wheel is clicked, ignore this event\n      if (e.button === 2) return;\n\n      // the point represent current position\n      // convertion for convenient query\n      let startPoint = this.convertPoint([e.offsetX, e.offsetY]);\n      let screenPoint = [e.offsetX, e.offsetY];\n\n      // the query is added when in query mode\n      if (this.filterMode === 'hover') {\n        console.log(unobserve.querys);\n        unobserve.querys.push({\n          type: 'hover',\n          cache: unobserve.hoverCache,\n        });\n        this.renderBoxes();\n        this.cnt++;\n        console.log(unobserve.querys);\n        return;\n      }\n\n      let box = this.findBox(startPoint);\n      if (box) {\n        this.modify = box;\n        this.preview = this.modify.instance;\n\n        this.modify.lastPos = startPoint;\n        if (this.modify.onBorder) {\n          this.modify.type = \"resize\";\n        } else {\n          this.modify.type = \"drag\";\n        }\n        return;\n      }\n      if (this.filterMode === \"attr\") return;\n      this.preview = {\n        // type: document.getElementById(\"mode\").value,\n        type: this.filterMode,\n        start: startPoint,\n      };\n      unobserve.preview = this.preview;\n      if (this.preview.type === \"knn\") {\n        this.preview.n = 5;\n      } else if (this.preview.type === \"rnn\") {\n        this.preview.n = 10;\n      } else if (this.preview.type === \"ang\") {\n        this.preview.n = 5;\n      }\n    },\n\n    canvasMouseup(e) {\n      if (e.button === 2 || !this.preview) return;\n      if (this.modify) {\n        unobserve.querys[this.modify.i] = this.preview;\n        this.modify = this.preview = null;\n      } else if (this.filterMode === \"attr\") {\n        return;\n      } else {\n        const point = this.convertPoint([e.offsetX, e.offsetY]);\n        if (this.preview.type === \"knn\" || this.preview.type === \"rnn\") {\n          this.preview.start = point;\n        } else if (\n            this.preview.type === \"brush\" ||\n            this.preview.type === \"ang\"\n        ) {\n          this.preview.end = point;\n        }\n        this.preview.cache = null;\n        this.preview.reps = null;\n        unobserve.querys.push(this.preview);\n        this.preview = null;\n      }\n      unobserve.preview = this.preview;\n      // renderQuerys();\n\n      console.time(\"renderBoxes in mouseup\");\n      this.renderBoxes();\n      console.timeEnd(\"renderBoxes in mouseup\");\n\n      console.time(\"render Density in mouseup\");\n      this.renderDensity();\n      console.timeEnd(\"render Density in mouseup\");\n      this.cnt++;\n    },\n\n    canvasWheel(e) {\n      const pointer = this.convertPoint([e.offsetX, e.offsetY]);\n      const res = this.findBox(pointer);\n      if (res) {\n        e.preventDefault();\n        const query = res.instance;\n        const sign = Math.sign(e.deltaY);\n        if (\n            query.type === \"knn\" ||\n            query.type === \"rnn\" ||\n            query.type === \"ang\"\n        ) {\n          if (query.type === \"ang\")\n            query.n = Math.min(Math.max(1, query.n - sign), 180);\n          else query.n = Math.max(query.n - Math.sign(e.deltaY), 0);\n          query.cache = null;\n          query.reps = null;\n          console.log(query.n);\n        }\n        // renderQuerys();\n        clearTimeout(unobserve.async);\n        unobserve.async = setTimeout(() => {\n          this.renderBoxes();\n          this.cnt++;\n        }, 10);\n      }\n    },\n\n    canvasMousemove(e) {\n      const point = this.convertPoint([e.offsetX, e.offsetY]);\n      this.renderAxisHelper(e);\n      if (this.filterMode === 'hover') {\n        unobserve.hoverEvent = setTimeout(() => {\n          let radius = 5;\n          let res = [];\n          while (res.length === 0 && radius < 100) {\n            res = this.inRadius(this.tr.ee.brush([point[0] - radius, point[1] - radius], [point[0] + radius, point[1] + radius]), point, 3, true);\n            radius *= 2;\n          }\n          this.initCanvas(unobserve.hoverLayer);\n          if(unobserve.hoverEvent)\n            this.drawLineWithLayer(res, unobserve.hoverLayer);\n          unobserve.hoverCache = new Set(res);\n        }, 10)\n        return;\n      }\n      if (!this.preview) {\n        this.findBox(point);\n        return;\n      }\n      if (this.modify) {\n        if (this.modify.type === \"resize\") {\n          if (this.preview.type === \"brush\") {\n            updatePoint(this.preview.end, this.modify.lastPos, point);\n            updatePoint(this.preview.start, this.modify.lastPos, point);\n          } else if (this.preview.type === \"ang\") {\n            this.preview.end[0] = point[0];\n            this.preview.end[1] += point[1] - this.modify.lastPos[1];\n          }\n        } else {\n          const offsetX = point[0] - this.modify.lastPos[0],\n              offsetY = point[1] - this.modify.lastPos[1];\n\n          if (this.preview.type === \"brush\" || this.preview.type === \"ang\") {\n            movePoint(this.preview.end, offsetX, offsetY);\n          }\n          movePoint(this.preview.start, offsetX, offsetY);\n        }\n\n        this.modify.lastPos = point;\n      } else {\n        if (this.preview.type === \"knn\" || this.preview.type === \"rnn\") {\n          this.preview.start = point;\n        } else if (\n            this.preview.type === \"brush\" ||\n            this.preview.type === \"ang\"\n        ) {\n          this.preview.end = point;\n        }\n      }\n      this.preview.cache = null;\n      console.time(\"renderBoxes\");\n      clearTimeout(unobserve.async);\n      unobserve.async = setTimeout(() => {\n        this.renderBoxes();\n      }, 10);\n      this.renderBoxes();\n      console.timeEnd(\"renderBoxes\");\n    },\n\n    mouseContextmenu(e) {\n      e.preventDefault();\n    },\n\n    hoverLines(e) {\n      const x = e.offsetX;\n      const y = e.offsetY;\n      const kArray = this.contextHandler\n          .filterRange(\n              (x - 5) / this.option.width,\n              (x + 5) / this.option.width,\n              1 - (y + 5) / this.option.height,\n              1 - (y - 5) / this.option.height\n          )\n          .filter((x) => !this.filter || this.filter.includes(x))\n          .slice(0, 3);\n      this.rawLineContext.clearRect(0, 0, this.option.width, this.option.height);\n      const colorMap = this.colorMap;\n      for (let i = kArray.length - 1; i >= 0; i--) {\n        const data = unobserve.aggregatedData[kArray[i]];\n        this.rawLineContext.globalAlpha = 1;\n        this.rawLineContext.strokeStyle = colorMap[i % 3];\n        this.rawLineContext.lineWidth = 2;\n        this.rawLineContext.beginPath();\n        this.rawLineContext.moveTo(\n            (data[this.timeIndex][0] / this.contextHandler.maxX) * this.option.width,\n            this.option.height - (data[this.valueIndex][0] / this.contextHandler.maxY) * this.option.height\n        );\n        for (let j = 0; j < data[this.timeIndex].length; j++) {\n          this.rawLineContext.lineTo(\n              (data[this.timeIndex][j] / this.contextHandler.maxX) * this.option.width,\n              this.option.height - (data[this.valueIndex][j] / this.contextHandler.maxY) * this.option.height\n          );\n        }\n        this.rawLineContext.stroke();\n      }\n      this.rawLines = kArray;\n    },\n    getTopK() {\n      let kArray = [];\n      if (this.hoverListener) {\n        this.$refs.canvas.removeEventListener(\"mousemove\", this.hoverListener);\n      }\n      switch (this.rawMode) {\n        case \"cur\":\n          this.hoverListener = this.hoverLines.bind(this);\n          this.$refs.canvas.addEventListener(\"mousemove\", this.hoverListener);\n          break;\n        case \"out\":\n          kArray = this.contextHandler.findKTop(false);\n          break;\n        case \"rep\":\n          kArray = this.contextHandler.findKTop(true, this.diverse);\n          break;\n      }\n      this.rawLineContext.clearRect(0, 0, this.option.width, this.option.height);\n      const colorMap = this.colorMap;\n      for (let i = kArray.length - 1; i >= 0; i--) {\n        const data = unobserve.aggregatedData[kArray[i]];\n        this.rawLineContext.globalAlpha = 1;\n        this.rawLineContext.strokeStyle = colorMap[i % 3];\n        this.rawLineContext.lineWidth = 2;\n        this.rawLineContext.beginPath();\n        this.rawLineContext.moveTo(\n            (data[this.timeIndex][0] / this.contextHandler.maxX) * this.option.width,\n            this.option.height - (data[this.valueIndex][0] / this.contextHandler.maxY) * this.option.height\n        );\n        for (let j = 0; j < data[this.timeIndex].length; j++) {\n          this.rawLineContext.lineTo(\n              (data[this.timeIndex][j] / this.contextHandler.maxX) * this.option.width,\n              this.option.height - (data[this.valueIndex][j] / this.contextHandler.maxY) * this.option.height\n          );\n        }\n        this.rawLineContext.stroke();\n      }\n      this.rawLines = kArray;\n    },\n    resetFilter() {\n      this.$emit(\"filterChange\", undefined);\n      this.boxes = [];\n      this.mouseDown = false;\n      this.canvasContext.clearRect(0, 0, this.option.width, this.option.height);\n      this.coord = [0, 0, 0, 0, 0];\n    },\n    startMouse(e) {\n      if (this.mouseDown) return;\n      this.mouseDown = true;\n      let x = e.offsetX,\n          y = e.offsetY,\n          flag = false;\n      if (this.filterMode == \"rect\") {\n        x /= this.option.width;\n        y = 1 - y / this.option.height;\n        for (let box of this.boxes) {\n          if (\n              (Math.abs(x - box[0]) <= 0.002 || Math.abs(x - box[1]) <= 0.002) &&\n              y > box[2] &&\n              y < box[3]\n          ) {\n            if (Math.abs(x - box[0]) <= 0.002) {\n              this.mouseDown = \"left\";\n            } else {\n              this.mouseDown = \"right\";\n            }\n            flag = true;\n          } else if (\n              (Math.abs(y - box[2]) <= 0.004 || Math.abs(y - box[3]) <= 0.004) &&\n              x > box[0] &&\n              x < box[1]\n          ) {\n            if (Math.abs(y - box[2]) <= 0.004) {\n              this.mouseDown = \"bottom\";\n            } else {\n              this.mouseDown = \"top\";\n            }\n            flag = true;\n          } else if (x > box[0] && x < box[1] && y > box[2] && y < box[3]) {\n            this.mouseDown = \"move\";\n            flag = true;\n          }\n          if (flag) {\n            this.coord = [\n              box[0] * this.option.width,\n              this.option.height - box[3] * this.option.height,\n              box[1] * this.option.width,\n              this.option.height - box[2] * this.option.height,\n              0,\n            ];\n            this.boxes.splice(this.boxes.indexOf(box), 1);\n            let filterResult = undefined;\n            this.boxes.forEach((b) => {\n              let tmpResult = this.contextHandler.filterRange(...b);\n              if (!filterResult) {\n                filterResult = tmpResult;\n              } else {\n                filterResult = filterResult.filter((x) =>\n                    tmpResult.includes(x)\n                );\n              }\n            });\n            this.$emit(\"filterChange\", filterResult);\n            break;\n          }\n        }\n      } else {\n        if (\n            Math.abs(x - this.coord[0]) <= 2 &&\n            Math.abs(y - this.coord[1]) <= 2\n        ) {\n          this.mouseDown = \"move\";\n          flag = true;\n        } else if (\n            Math.abs(x - this.coord[2]) <= 2 &&\n            Math.abs(y - this.coord[3]) <= Math.abs(this.coord[4] - this.coord[3])\n        ) {\n          this.mouseDown = \"time\";\n          flag = true;\n        } else if (\n            x > this.coord[0] &&\n            x < this.coord[2] &&\n            y >\n            (this.coord[1] * (this.coord[2] - x)) /\n            (this.coord[2] - this.coord[0]) +\n            ((this.coord[3] - Math.abs(this.coord[4] - this.coord[3])) *\n                (x - this.coord[0])) /\n            (this.coord[2] - this.coord[0]) &&\n            y <\n            (this.coord[1] * (this.coord[2] - x)) /\n            (this.coord[2] - this.coord[0]) +\n            ((this.coord[3] + Math.abs(this.coord[4] - this.coord[3])) *\n                (x - this.coord[0])) /\n            (this.coord[2] - this.coord[0])\n        ) {\n          this.mouseDown = \"angular\";\n          flag = true;\n        }\n      }\n      if (!flag) {\n        this.coord = [0, 0, 0, 0, 0];\n        this.coord[0] = e.offsetX;\n        this.coord[1] = e.offsetY;\n      }\n      this.listener = this.startFilter.bind(this);\n      window.addEventListener(\"mouseup\", this.listener);\n    },\n    drawBoxes() {\n      for (let box of this.boxes) {\n        this.canvasContext.fillRect(\n            box[0] * this.option.width,\n            this.option.height - box[3] * this.option.height,\n            (box[1] - box[0]) * this.option.width,\n            (box[3] - box[2]) * this.option.height\n        );\n      }\n    },\n    cursorShape(e) {\n      let x = e.offsetX,\n          y = e.offsetY;\n      switch (this.mouseDown) {\n        case \"move\":\n          this.cursor = \"grabbing\";\n          return;\n        case \"left\":\n        case \"right\":\n        case \"time\":\n          this.cursor = \"ew-resize\";\n          return;\n        case \"top\":\n        case \"bottom\":\n        case \"angular\":\n        case \"range\":\n          this.cursor = \"ns-resize\";\n          return;\n        case \"magnet\":\n        case true:\n          this.cursor = \"crosshair\";\n          return;\n        default:\n          if (this.filterMode == \"rect\") {\n            x /= this.option.width;\n            y = 1 - y / this.option.height;\n            for (let box of this.boxes) {\n              if (\n                  (Math.abs(x - box[0]) <= 0.002 ||\n                      Math.abs(x - box[1]) <= 0.002) &&\n                  y > box[2] &&\n                  y < box[3]\n              ) {\n                this.cursor = \"ew-resize\";\n                return;\n              }\n              if (\n                  (Math.abs(y - box[2]) <= 0.004 ||\n                      Math.abs(y - box[3]) <= 0.004) &&\n                  x > box[0] &&\n                  x < box[1]\n              ) {\n                this.cursor = \"ns-resize\";\n                return;\n              }\n              if (x > box[0] && x < box[1] && y > box[2] && y < box[3]) {\n                this.cursor = \"move\";\n                return;\n              }\n            }\n          } else {\n            if (\n                Math.abs(x - this.coord[0]) <= 2 &&\n                Math.abs(y - this.coord[1]) <= 2\n            ) {\n              this.cursor = \"move\";\n              return;\n            }\n            if (\n                Math.abs(x - this.coord[2]) <= 2 &&\n                Math.abs(y - this.coord[3]) <=\n                Math.abs(this.coord[4] - this.coord[3])\n            ) {\n              this.cursor = \"ew-resize\";\n              return;\n            }\n            if (\n                x > this.coord[0] &&\n                x < this.coord[2] &&\n                y >\n                (this.coord[1] * (this.coord[2] - x)) /\n                (this.coord[2] - this.coord[0]) +\n                ((this.coord[3] - Math.abs(this.coord[4] - this.coord[3])) *\n                    (x - this.coord[0])) /\n                (this.coord[2] - this.coord[0]) &&\n                y <\n                (this.coord[1] * (this.coord[2] - x)) /\n                (this.coord[2] - this.coord[0]) +\n                ((this.coord[3] + Math.abs(this.coord[4] - this.coord[3])) *\n                    (x - this.coord[0])) /\n                (this.coord[2] - this.coord[0])\n            ) {\n              this.cursor = \"ns-resize\";\n              return;\n            }\n          }\n          this.cursor = \"crosshair\";\n      }\n    },\n    moveMouse(e) {\n      this.cursorShape(e);\n      if (!this.mouseDown) return;\n      if (this.mouseDown == \"magnet\") {\n        this.coord[4] = e.offsetY;\n      } else if (this.mouseDown == \"move\") {\n        this.coord[0] += e.movementX;\n        this.coord[2] += e.movementX;\n        this.coord[1] += e.movementY * this.upsideDownFactor;\n        this.coord[3] += e.movementY * this.upsideDownFactor;\n        this.coord[4] += e.movementY * this.upsideDownFactor;\n      } else if (this.mouseDown == \"left\") {\n        this.coord[0] = e.offsetX;\n      } else if (this.mouseDown == \"right\") {\n        this.coord[2] = e.offsetX;\n      } else if (this.mouseDown == \"bottom\") {\n        this.coord[3] = e.offsetY;\n      } else if (this.mouseDown == \"top\") {\n        this.coord[1] = e.offsetY;\n      } else if (this.mouseDown == \"time\") {\n        this.coord[2] = Math.max(this.coord[0] + 1, e.offsetX);\n      } else if (this.mouseDown == \"angular\") {\n        this.coord[3] += e.movementY * this.upsideDownFactor;\n        this.coord[4] += e.movementY * this.upsideDownFactor;\n      } else {\n        this.coord[2] = e.offsetX;\n        this.coord[3] = e.offsetY;\n      }\n      this.canvasContext.clearRect(0, 0, this.option.width, this.option.height);\n      if (this.filterMode == \"rect\") {\n        this.canvasContext.globalAlpha = 0.3;\n        this.canvasContext.fillStyle = \"black\";\n        this.drawBoxes();\n        this.canvasContext.fillRect(\n            Math.min(this.coord[0], this.coord[2]),\n            Math.min(this.coord[1], this.coord[3]),\n            Math.abs(this.coord[2] - this.coord[0]),\n            Math.abs(this.coord[3] - this.coord[1])\n        );\n      } else {\n        this.canvasContext.globalAlpha = 1;\n        this.canvasContext.strokeStyle = \"black\";\n        this.canvasContext.beginPath();\n        this.canvasContext.moveTo(this.coord[0], this.coord[1]);\n        this.canvasContext.lineTo(this.coord[2], this.coord[3]);\n        this.canvasContext.stroke();\n        if (this.mouseDown && this.mouseDown !== true) {\n          let offset = this.coord[4] - this.coord[3];\n          this.canvasContext.beginPath();\n          this.canvasContext.moveTo(this.coord[2], this.coord[3] - offset);\n          this.canvasContext.lineTo(this.coord[2], this.coord[3] + offset);\n          this.canvasContext.stroke();\n          this.canvasContext.globalAlpha = 0.3;\n          this.canvasContext.fillStyle = \"black\";\n          this.canvasContext.beginPath();\n          this.canvasContext.moveTo(this.coord[0], this.coord[1]);\n          this.canvasContext.lineTo(this.coord[2], this.coord[3] - offset);\n          this.canvasContext.lineTo(this.coord[2], this.coord[3] + offset);\n          this.canvasContext.fill();\n        }\n      }\n    },\n    startFilter() {\n      if (this.filterMode == \"rect\") {\n        this.mouseDown = false;\n        if (this.coord[2] != 0 || this.coord[3] != 0) {\n          let [left, right] = [this.coord[0], this.coord[2]]\n              .map((x) => x / this.option.width)\n              .sort();\n          let [bottom, top] = [this.coord[1], this.coord[3]]\n              .map((x) => 1 - x / this.option.height)\n              .sort();\n          this.boxes.push([left, right, bottom, top]);\n          let filterResult = this.contextHandler.filterRange(\n              left,\n              right,\n              bottom,\n              top\n          );\n          if (this.filter) {\n            this.$emit(\n                \"filterChange\",\n                this.filter.filter((x) => filterResult.includes(x))\n            );\n          } else {\n            this.$emit(\"filterChange\", filterResult);\n          }\n        }\n      }\n      window.removeEventListener(\"mouseup\", this.listener);\n      this.listener = null;\n    },\n    angleConfirm() {\n      if (\n          this.filterMode == \"ang\" &&\n          this.coord[2] &&\n          this.coord[3] &&\n          this.coord[0] != this.coord[2]\n      ) {\n        if (this.mouseDown === true) {\n          this.mouseDown = \"magnet\";\n          let start = [0, 0];\n          let end = [0, 0];\n          if (this.coord[0] < this.coord[2]) {\n            start = this.coord.slice(0, 2);\n            end = this.coord.slice(2, 4);\n          } else {\n            end = this.coord.slice(0, 2);\n            start = this.coord.slice(2, 4);\n          }\n          this.coord = [...start, ...end, 0];\n        } else if (this.mouseDown) {\n          this.mouseDown = false;\n          let offset = Math.abs(this.coord[4] - this.coord[3]);\n          let startAngle =\n              -(this.coord[3] + offset - this.coord[1]) /\n              (this.coord[2] - this.coord[0]);\n          let endAngle =\n              -(this.coord[3] - offset - this.coord[1]) /\n              (this.coord[2] - this.coord[0]);\n          this.$emit(\n              \"filterChange\",\n              this.contextHandler.filterAngle(\n                  this.coord[0] / this.option.width,\n                  this.coord[2] / this.option.width,\n                  startAngle,\n                  endAngle\n              )\n          );\n        }\n      }\n    },\n    exportFig() {\n      // exportCanvas(\n      //     [this.$refs.canvas, this.$refs.canvasOverlay, this.$refs.canvasRawLine],\n      //     this.upsideDown\n      // );\n      exportCanvas(\n          this.layers.map((layer) => document.getElementById(layer.id)).reverse(),\n          this.upsideDown,\n          this.layers.map((layer) => layer.opacity).reverse()\n      );\n    },\n    showRepData() {\n      this.repModal = true;\n      this.repStaticInformation = unobserve.repIds.map((id) => {\n        return {\n          name: id,\n          ...this.getStaticInformation([id]),\n        };\n      });\n    },\n    hightlightRow(row) {\n      return row.query === this.selectedQuery ? \"selected-table-row\" : \"\";\n    },\n    calClassName(row) {\n      let ret =\n          this.hightlightRow(row) +\n          \" \" +\n          (row.query === this.hoveringInd ? \"ivu-table-row-hover\" : \"\");\n      return ret;\n    },\n    calcLineDistance(aid, bid) {\n      if (aid == bid) return 0;\n      if (aid > bid) {\n        [aid, bid] = [bid, aid];\n      }\n      if (!this.distanceCache[aid]) {\n        this.distanceCache[aid] = {};\n      }\n      if (this.distanceCache[aid][bid] !== undefined)\n        return this.distanceCache[aid][bid];\n      let distance = 0;\n      let count = 0;\n      let aPointer = 0;\n      let bPointer = 0;\n      const aLine = unobserve.result[aid];\n      const bLine = unobserve.result[bid];\n      while (true) {\n        while (\n            aPointer < aLine.length &&\n            bPointer < bLine.length &&\n            aLine[aPointer].x < bLine[bPointer].x\n            ) {\n          aPointer++;\n        }\n        while (\n            aPointer < aLine.length &&\n            bPointer < bLine.length &&\n            aLine[aPointer].x > bLine[bPointer].x\n            ) {\n          bPointer++;\n        }\n        if (aPointer >= aLine.length || bPointer >= bLine.length) {\n          break;\n        }\n        if (aLine[aPointer].x == bLine[bPointer].x) {\n          count++;\n          distance += Math.abs(aLine[aPointer].y - bLine[bPointer].y);\n          aPointer++;\n          bPointer++;\n        }\n      }\n      distance /= count;\n      if (!count) {\n        distance = Infinity;\n      }\n      this.distanceCache[aid][bid] = distance;\n      return distance;\n    },\n    drawRawLines() {\n      const shuffle = unobserve.result\n          .slice()\n          .map((_, id) => id);\n\n      shuffle.sort(() => (Math.random() > 0.5 ? 1 : -1));\n\n      this.drawLineWithLayer(shuffle, unobserve.rawLinesLayerContext);\n    },\n\n    renderQuerys() {\n      const ctner = document.getElementById(\"query_ctner\");\n      ctner.innerHTML = \"\";\n      if (!unobserve.querys.length) {\n        ctner.innerHTML = \"(empty)\";\n      }\n      for (let i = 0; i < unobserve.querys.length; i++) {\n        const query = unobserve.querys[i];\n        const element = document.createElement(\"p\");\n\n        const icon = document.createElement(\"i\");\n        icon.style.display = \"inline-block\";\n        icon.style.background =\n            query.type === \"knn\"\n                ? \"deepskyblue\"\n                : query.type === \"ang\"\n                ? \"transparent\"\n                : \"gray\";\n        icon.style.borderRadius =\n            query.type === \"knn\" || query.type === \"rnn\" ? \"50%\" : \"0\";\n        icon.style.borderBottom = icon.style.borderRight =\n            query.type === \"ang\" ? \"6px solid gray\" : \"\";\n        icon.style.borderLeft = icon.style.borderTop =\n            query.type === \"ang\" ? \"6px solid transparent\" : \"\";\n        icon.style.height = icon.style.width =\n            query.type === \"ang\" ? \"0\" : \"12px\";\n\n        const desc = document.createElement(\"span\");\n        switch (query.type) {\n          case \"knn\":\n            desc.innerText = \"KNN\";\n            break;\n          case \"rnn\":\n            desc.innerText = \"RNN\";\n            break;\n          case \"brush\":\n            desc.innerText = \"Brush\";\n            break;\n          case \"ang\":\n            desc.innerText = \"Angular\";\n            break;\n        }\n\n        const conf = document.createElement(\"p\");\n        switch (query.type) {\n          case \"knn\":\n            conf.innerText = \"k=\";\n            break;\n          case \"rnn\":\n            conf.innerText = \"r=\";\n            break;\n          case \"brush\":\n            conf.innerHTML = `(${query.start\n                .map((x, i) =>\n                    i === 0\n                        ? unobserve.inferX == \"date\"\n                        ? moment(xScale.invert(x)).format(\"YYYY-M-D\")\n                        : xScale.invert(x).toFixed(0)\n                        : yScale.invert(this.option.height - x).toFixed(0)\n                )\n                .join(\", \")}) ~<br>(${query.end\n                .map((x, i) =>\n                    i === 0\n                        ? unobserve.inferX == \"date\"\n                        ? moment(xScale.invert(x)).format(\"YYYY-M-D\")\n                        : xScale.invert(x).toFixed(0)\n                        : yScale.invert(this.option.height - x).toFixed(0)\n                )\n                .join(\", \")})`;\n            break;\n          case \"ang\":\n            conf.innerText = \"degree\";\n            break;\n        }\n        const confInput = document.createElement(\"input\");\n        confInput.type = \"number\";\n        confInput.value = query.n;\n        confInput.addEventListener(\"change\", () => {\n          query.n = parseFloat(confInput.value);\n          query.cache = null;\n          query.reps = null;\n          setTimeout(renderBoxes, 0);\n        });\n        if (\n            query.type === \"knn\" ||\n            query.type === \"rnn\" ||\n            query.type === \"ang\"\n        ) {\n          conf.append(confInput);\n        }\n\n        const del = document.createElement(\"button\");\n        del.innerText = \"Delete this query\";\n        del.addEventListener(\"click\", () => {\n          querys.splice(i, 1);\n          // setTimeout(renderQuerys, 0);\n          setTimeout(renderBoxes, 0);\n          setTimeout(renderDensity, 0);\n        });\n\n        element.append(icon, desc, conf, del);\n        element.addEventListener(\"mouseenter\", () => {\n          element.style.border = \"1px solid red\";\n          hoverBox(query);\n        });\n\n        element.addEventListener(\"mouseleave\", () => {\n          element.style.border = \"1px solid transparent\";\n          renderBoxes();\n        });\n\n        ctner.appendChild(element);\n      }\n    },\n\n    colorSpan(ids) {\n      return ids.map((id) => {\n        return `<span style=\"color: rgb(${this.getColor(id).join(\n            \",\"\n        )})\">${id}</span>`;\n      });\n    },\n\n    renderResult(ids1, ids2) {\n      unobserve.interResult = ids1;\n      unobserve.unionResult = ids2;\n      // this.queryResult = ids;\n      // if (!ids.length) {\n      //   document.getElementById(\"result\").innerText = \"(empty)\";\n      // } else {\n      //   document.getElementById(\"result\").innerHTML = `${this.colorSpan(ids).join(\n      //       \", \"\n      //   )}`;\n      // }\n    },\n\n    hovering(index, onBorder) {\n      const query = unobserve.querys[index];\n      this.hoveringInd = index;\n      if (this.mark !== query) {\n        this.renderBoxes(\"mouseLayer\");\n      }\n      this.mark = query;\n      this.hoverBox(query);\n      if (onBorder) {\n        document.getElementById(\"canvas\").style.cursor = \"move\";\n      } else {\n        document.getElementById(\"canvas\").style.cursor = \"pointer\";\n      }\n    },\n\n    findBox(point) {\n      function hovering(index, onBorder) {\n        const query = unobserve.querys[index];\n        this.hoveringInd = index;\n        if (this.mark !== query) {\n          this.renderBoxes(\"mouseLayer\");\n        }\n        this.mark = query;\n        this.hoverBox(query);\n        if (onBorder) {\n          document.getElementById(\"canvas\").style.cursor = \"move\";\n        } else {\n          document.getElementById(\"canvas\").style.cursor = \"pointer\";\n        }\n      }\n\n      for (let i = unobserve.querys.length - 1; i >= 0; i--) {\n        const query = unobserve.querys[i];\n        // switch (query.type) {\n        // }\n        if (query.type === \"brush\") {\n          // update rect\n          let minX = Math.min(query.start[0], query.end[0]),\n              maxX = Math.max(query.start[0], query.end[0]),\n              minY = Math.min(query.start[1], query.end[1]),\n              maxY = Math.max(query.start[1], query.end[1]),\n              onBorder =\n                  eq(minX, point[0]) ||\n                  eq(maxX, point[0]) ||\n                  eq(minY, point[1]) ||\n                  eq(maxY, point[1]);\n          // onBorder = [\n          //   eq(minX, point[0]) ? -1 : eq(maxX, point[0]) ? 1 : 0,\n          //   eq(minY, point[1]) ? -1 : eq(maxY, point[1]) ? 1 : 0,\n          // ];\n          if (\n              minX <= point[0] &&\n              point[0] <= maxX &&\n              minY <= point[1] &&\n              point[1] <= maxY\n          ) {\n            hovering.call(this, i, onBorder);\n            return {instance: query, onBorder, i};\n          }\n        } else if (query.type === \"knn\" || query.type === \"rnn\") {\n          let dis = dist2(point, query.start);\n          if (sqr(query.n) > dis) {\n            hovering.call(this, i);\n            return {instance: query, i};\n          }\n        } else if (query.type === \"ang\") {\n          const endX = Math.max(query.start[0] + 1, query.end[0]);\n          const start = query.start,\n              end = [endX, query.end[1]],\n              onBorder = eq(endX, point[0]);\n          if (\n              start[0] <= point[0] &&\n              point[0] <= endX &&\n              ((start[0] === point[0] && start[1] === point[1]) ||\n                  (start[0] !== point[0] &&\n                      Math.abs(getAngle2(start, point) - getAngle2(start, end)) <=\n                      (query.n / 180) * Math.PI))\n          ) {\n            hovering.call(this, i, onBorder);\n            return {instance: query, i, onBorder};\n          }\n        }\n      }\n      if (this.mark) {\n        this.mark = false;\n        document.getElementById(\"canvas\").style.cursor = \"default\";\n        this.renderBoxes(\"mouseLayer\");\n        this.hoveringInd = null;\n      }\n    },\n\n    renderBox(query) {\n      const st = query.start && this.reconvertPoint(query.start);\n      const ed = query.end && this.reconvertPoint(query.end);\n\n      if (query.type === \"knn\") {\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.arc(...this.reconvertPoint(query.start), 6, 0, 2 * Math.PI);\n        unobserve.mouseLayerContext.fillStyle = \"deepskyblue\";\n        unobserve.mouseLayerContext.fill();\n        if (!query.cache) {\n          let result = new Set();\n          let base = 0;\n          while (result.size < query.n) {\n            base += query.n - result.size;\n            result = new Set(\n                this.tr.ee.knn(query.start, base).map(({id}) => id)\n            );\n          }\n          query.cache = result;\n        }\n      } else if (query.type === \"rnn\") {\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.arc(\n            ...st,\n            query.n,\n            0,\n            2 * Math.PI\n        );\n        unobserve.mouseLayerContext.fillStyle = \"rgba(0,0,0,0.3)\";\n        unobserve.mouseLayerContext.fill();\n        if (!query.cache) {\n          const result = new Set(\n              this.inRadius( this.tr.ee.rnn(query.start, query.n).map(({id}) => id), query.start, query.n)\n          );\n          query.cache = result;\n        }\n      } else if (query.type === \"brush\") {\n        // if (document.getElementById(\"line_mode\").value === \"all\") {\n        //   unobserve.mouseLayerContext.putImageData(\n        //       currentDensity,\n        //       0,\n        //       0,\n        //       ...query.start.map((v, i) => Math.min(v, query.end[i])),\n        //       ...query.end.map((v, i) => Math.abs(v - query.start[i]))\n        //   );\n        // } else {\n        const st = this.reconvertPoint(query.start);\n        const ed = this.reconvertPoint(query.end);\n        unobserve.mouseLayerContext.fillStyle = \"rgba(0,0,0,0.3)\";\n        unobserve.mouseLayerContext.fillRect(\n            ...st.map((v, i) => Math.min(v, ed[i])),\n            ...ed.map((v, i) => Math.abs(v - st[i]))\n        );\n        // }\n        if (!query.cache) {\n          const minX = Math.min(query.start[0], query.end[0]),\n              maxX = Math.max(query.start[0], query.end[0]),\n              minY = Math.min(query.start[1], query.end[1]),\n              maxY = Math.max(query.start[1], query.end[1]);\n\n          if (this.brushMethod === \"seq\") {\n            // console.log(query);\n            let result = [];\n            // let info = [];\n            for (let id in unobserve.result) {\n              const line = unobserve.result[id];\n\n              let st = 0,\n                  ed = line.length - 1,\n                  flag = true;\n              if (line[ed].x < minX || line[st].x > maxX) continue;\n              while (st < line.length - 1 && line[st].x < minX) st++;\n              while (ed > 0 && line[ed].x > maxX) ed--;\n\n              for (let i = st; flag && i <= ed; i++) {\n                if (line[i].y < minY || line[i].y > maxY) {\n                  flag = false;\n                  // info.push({ind: id, pos: i, ...line[i]});\n                }\n              }\n              if (st !== 0) {\n                let y = mix(line[st - 1], line[st], minX).y;\n                if (y < minY || y > maxY) {\n                  // info.push({ind:id, pos: 'left', calY: y, lp: line[st-1], rp: line[st]});\n                  flag = false;\n                }\n              }\n              if (ed !== line.length - 1) {\n                let y = mix(line[ed], line[ed + 1], maxX).y;\n                if (y < minY || y > maxY) {\n                  // info.push({ind:id, pos: 'right', calY: y, lp: line[ed], rp: line[ed+1]});\n                  flag = false;\n                }\n              }\n              if (flag) result.push(id);\n            }\n            // console.log('information');\n            // console.log(info);\n            // console.log('result', result);\n            result = new Set(result);\n            query.cache = result;\n          } else if (this.brushMethod === \"tree\") {\n            const result = new Set(\n                this.tr.ee\n                    .brush(\n                        [\n                          Math.min(query.start[0], query.end[0]),\n                          Math.min(query.start[1], query.end[1]),\n                        ],\n                        [\n                          Math.max(query.start[0], query.end[0]),\n                          Math.max(query.start[1], query.end[1]),\n                        ]\n                    )\n                    .filter((id) => {\n                      // return true;\n                      const line = unobserve.result[id];\n                      let l = 0,\n                          r = line.length - 1,\n                          lp = 0,\n                          rp = r,\n                          mid,\n                          tmpY;\n                      while (l <= r) {\n                        mid = (l + r) >> 1;\n                        if (line[mid].x >= minX) {\n                          lp = mid;\n                          r = mid - 1;\n                        } else l = mid + 1;\n                      }\n\n                      l = 0;\n                      r = line.length - 1;\n                      while (l <= r) {\n                        mid = (l + r) >> 1;\n                        if (line[mid].x <= maxX) {\n                          rp = mid;\n                          l = mid + 1;\n                        } else {\n                          r = mid - 1;\n                        }\n                      }\n                      // console.log(lp, rp);\n                      for (let i = lp; i <= rp; i++) {\n                        if (line[i].y < minY || line[i].y > maxY) {\n                          // console.log(line[i]);\n                          return false;\n                        }\n                      }\n                      if (lp) {\n                        tmpY = mix(line[lp - 1], line[lp], minX).y;\n                        if (tmpY < minY || tmpY > maxY) {\n                          // console.log(tmpY);\n                          return false;\n                        }\n                      }\n                      if (rp < line.length - 1) {\n                        tmpY = mix(line[rp], line[rp + 1], minX).y;\n                        if (tmpY < minY || tmpY > maxY) {\n                          // console.log(tmpY);\n                          return false;\n                        }\n                      }\n                      return true;\n                    })\n            );\n\n            query.cache = result;\n          } else {\n            const yyds = this.tr.ee.brush(\n                [\n                  Math.min(query.start[0], query.end[0]),\n                  Math.min(query.start[1], query.end[1]),\n                ],\n                [\n                  Math.max(query.start[0], query.end[0]),\n                  Math.max(query.start[1], query.end[1]),\n                ]\n            );\n\n            const result = new Set(\n                yyds\n                    .filter(({raw}) =>\n                        lineRectCollide(\n                            {\n                              x1: raw[0],\n                              x2: raw[1],\n                              y1: raw[2],\n                              y2: raw[3],\n                            },\n                            {\n                              x: Math.min(query.start[0], query.end[0]),\n                              y: Math.min(query.start[1], query.end[1]),\n                              width: Math.abs(query.start[0] - query.end[0]),\n                              height: Math.abs(query.start[1] - query.end[1]),\n                            }\n                        )\n                    )\n                    .map(({raw}) => raw[5])\n            );\n\n            yyds\n                .filter(\n                    ({raw}) =>\n                        lineSegmentsCollide(\n                            {x: raw[0], y: raw[2]},\n                            {x: raw[1], y: raw[3]},\n                            {\n                              x: Math.min(query.start[0], query.end[0]),\n                              y: Math.min(query.start[1], query.end[1]) - 1,\n                            },\n                            {\n                              x: Math.max(query.start[0], query.end[0]),\n                              y: Math.min(query.start[1], query.end[1]) - 1,\n                            }\n                        ) ||\n                        lineSegmentsCollide(\n                            {x: raw[0], y: raw[2]},\n                            {x: raw[1], y: raw[3]},\n                            {\n                              x: Math.min(query.start[0], query.end[0]),\n                              y: Math.max(query.start[1], query.end[1]) + 1,\n                            },\n                            {\n                              x: Math.max(query.start[0], query.end[0]),\n                              y: Math.max(query.start[1], query.end[1]) + 1,\n                            }\n                        )\n                )\n                .forEach(({raw}) => result.delete(raw[5]));\n\n            query.cache = result;\n          }\n        }\n      } else if (query.type === \"ang\") {\n        let endX = Math.max(st[0] + 1, ed[0]);\n        let minX = st[0],\n            maxX = endX;\n        let slopeBase =\n            (ed[1] - st[1]) / (endX - st[0]);\n        let angBase = Math.atan(slopeBase);\n        let angMax = Math.min(\n            (1 / 2) * Math.PI - 0.0001,\n            angBase + (query.n / 180) * Math.PI\n        );\n        let angMin = Math.max(\n            -(1 / 2) * Math.PI + 0.0001,\n            angBase - (query.n / 180) * Math.PI\n        );\n        let slopeMax = Math.tan(angMax);\n        let slopeMin = Math.tan(angMin);\n        let endYMax = st[1] + slopeMax * (endX - st[0]);\n        let endYMin = st[1] + slopeMin * (endX - st[0]);\n        unobserve.mouseLayerContext.fillStyle = \"rgba(0,0,0,0.3)\";\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.moveTo(st[0], st[1]);\n        unobserve.mouseLayerContext.lineTo(endX, endYMin);\n        unobserve.mouseLayerContext.lineTo(endX, endYMax);\n        unobserve.mouseLayerContext.closePath();\n        unobserve.mouseLayerContext.fill();\n        unobserve.mouseLayerContext.lineWidth = 1;\n        unobserve.mouseLayerContext.strokeStyle = \"black\";\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.moveTo(st[0], st[1]);\n        unobserve.mouseLayerContext.lineTo(endX, ed[1]);\n        unobserve.mouseLayerContext.stroke();\n\n        endX = Math.max(query.start[0] + 1, query.end[0]);\n        minX = query.start[0];\n        maxX = endX;\n        slopeBase =\n            (query.end[1] - query.start[1]) / (endX - query.start[0]);\n        angBase = Math.atan(slopeBase);\n        angMax = Math.min(\n            (1 / 2) * Math.PI - 0.0001,\n            angBase + (query.n / 180) * Math.PI\n        );\n        angMin = Math.max(\n            -(1 / 2) * Math.PI + 0.0001,\n            angBase - (query.n / 180) * Math.PI\n        );\n        slopeMax = Math.tan(angMax);\n        slopeMin = Math.tan(angMin);\n        endYMax = query.start[1] + slopeMax * (endX - query.start[0]);\n        endYMin = query.start[1] + slopeMin * (endX - query.start[0]);\n        if (!query.cache) {\n          const result = new Set(\n              this.tr.ee\n                  .angular([query.start[0], slopeMin], [endX, slopeMax])\n                  .filter((id) => {\n                    // return true;\n                    const line = unobserve.screenResult[id];\n                    let l = 0,\n                        r = line.length - 1,\n                        lp = 0,\n                        rp = r,\n                        mid,\n                        ang;\n                    if (line[l].x > maxX || line[r].x < minX) return false;\n                    while (l <= r) {\n                      mid = (l + r) >> 1;\n                      if (line[mid].x >= minX) {\n                        lp = mid;\n                        r = mid - 1;\n                      } else l = mid + 1;\n                    }\n                    l = 0;\n                    r = line.length - 1;\n                    while (l <= r) {\n                      mid = (l + r) >> 1;\n                      if (line[mid].x <= maxX) {\n                        rp = mid;\n                        l = mid + 1;\n                      } else {\n                        r = mid - 1;\n                      }\n                    }\n                    // console.log(lp, rp);\n                    for (let i = lp; i < rp; i++) {\n                      ang = Math.atan(\n                          (line[i + 1].y - line[i].y) / (line[i + 1].x - line[i].x)\n                      );\n                      if (ang < angMin || ang > angMax) {\n                        // console.log(line[i]);\n                        return false;\n                      }\n                    }\n                    if (lp) {\n                      ang = Math.atan(\n                          (line[lp - 1].y - line[lp].y) /\n                          (line[lp - 1].x - line[lp].x)\n                      );\n                      if (ang < angMin || ang > angMax) {\n                        // console.log(tmpY);\n                        return false;\n                      }\n                    }\n                    if (rp < line.length - 1) {\n                      ang = Math.atan(\n                          (line[rp + 1].y - line[rp].y) /\n                          (line[rp + 1].x - line[rp].x)\n                      );\n                      if (ang < angMin || ang > angMax) {\n                        // console.log(tmpY);\n                        return false;\n                      }\n                    }\n                    return true;\n                  })\n         );\n          query.cache = result;\n        }\n      } else if (query.type === \"attr\") {\n        if (!query.cache) {\n          const {ind, val} = query.info;\n          console.log(unobserve.aggregatedData, unobserve.data);\n          const result = new Array(unobserve.result.length)\n              .fill(0)\n              .map((_, i) => i)\n              .filter((i) => {\n                const exampleInd = unobserve.aggregatedData[i].ref[0];\n                const targetVal = unobserve.data[exampleInd][ind];\n                return targetVal === val;\n              });\n          query.cache = new Set(result);\n        }\n      }\n    },\n\n    hoverBox(query) {\n      unobserve.mouseLayerContext.lineWidth = 2;\n      const st = query.start && this.reconvertPoint(query.start);\n      const ed = query.end && this.reconvertPoint(query.end);\n      if (query.type === \"knn\") {\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.arc(...this.reconvertPoint(query.start), 6, 0, 2 * Math.PI);\n        unobserve.mouseLayerContext.strokeStyle = \"red\";\n        unobserve.mouseLayerContext.stroke();\n      } else if (query.type === \"rnn\") {\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.arc(\n            ...this.reconvertPoint(query.start),\n            query.n,\n            0,\n            2 * Math.PI\n        );\n        unobserve.mouseLayerContext.strokeStyle = \"red\";\n        unobserve.mouseLayerContext.stroke();\n      } else if (query.type === \"brush\") {\n        unobserve.mouseLayerContext.strokeStyle = \"red\";\n        unobserve.mouseLayerContext.strokeRect(\n            ...st.map((v, i) => Math.min(v, ed[i])),\n            ...ed.map((v, i) => Math.abs(v - st[i]))\n        );\n      } else if (query.type === \"ang\") {\n        const endX = Math.max(st[0] + 1, ed[0]);\n        const slopeBase =\n            (ed[1] - st[1]) / (endX - st[0]);\n        const angBase = Math.atan(slopeBase);\n        const angMax = Math.min(\n            (1 / 2) * Math.PI - 0.0001,\n            angBase + (query.n / 180) * Math.PI\n        );\n        const angMin = Math.max(\n            -(1 / 2) * Math.PI + 0.0001,\n            angBase - (query.n / 180) * Math.PI\n        );\n        const slopeMax = Math.tan(angMax);\n        const slopeMin = Math.tan(angMin);\n        const endYMax = st[1] + slopeMax * (endX - st[0]);\n        const endYMin = st[1] + slopeMin * (endX - st[0]);\n        unobserve.mouseLayerContext.strokeStyle = \"red\";\n        unobserve.mouseLayerContext.beginPath();\n        unobserve.mouseLayerContext.moveTo(st[0], st[1]);\n        unobserve.mouseLayerContext.lineTo(endX, endYMin);\n        unobserve.mouseLayerContext.lineTo(endX, endYMax);\n        unobserve.mouseLayerContext.closePath();\n        unobserve.mouseLayerContext.stroke();\n      }\n    },\n\n    initCanvas(context) {\n      if (typeof context === 'string')\n        context = document.getElementById(context)\n            .getContext(\"2d\");\n      if (!context)\n        return;\n      const width = Math.max(this.option.width, unobserve.screenWidth);\n      const height = Math.max(this.option.height, unobserve.screenHeight);\n      context.fillStyle = \"black\";\n      context.globalAlpha = 1;\n      context.fillRect(0, 0, width, height);\n      context.clearRect(0, 0, width, height);\n    },\n\n    renderBoxes(type = \"all\") {\n      this.initCanvas(unobserve.mouseLayerContext);\n\n      let tmpQueries = [...unobserve.querys];\n      if (this.preview && !this.modify) {\n        tmpQueries.push(this.preview);\n        // drawLine([...preview.cache]);\n      }\n      tmpQueries.forEach(this.renderBox);\n\n      if (type === \"mouseLayer\") return;\n\n      this.initCanvas(unobserve.selectionLayerContext);\n      this.initCanvas(unobserve.repLayerContext);\n\n      if (!this.preview) {\n        let result1 = [],\n            result2 = [];\n        result1 = tmpQueries.reduce(\n            (p, v) =>\n                v.hide ? p : new Set([...p].filter((x) => v.cache.has(x))),\n            (tmpQueries[0] || {cache: new Set()}).cache\n        );\n        result2 = tmpQueries.reduce(\n            (p, v) => (v.hide ? p : new Set([...p, ...v.cache])),\n            (tmpQueries[0] || {cache: new Set()}).cache\n        );\n        this.renderResult([...result1], [...result2]);\n      }\n      console.time(\"begin calculate rep line and draw line\");\n      const selectedIds = this.getSelectedIds();\n      unobserve.cache = unobserve.querys.length ? new Set(selectedIds) : null;\n      this.drawLine(selectedIds);\n      console.timeEnd(\"begin calculate rep line and draw line\");\n      // this.drawLine(typeof this.selectedQuery === 'number' ? unobserve.querys[this.selectedQuery] : this.selectedQuery === '$int' ? unobserve.interResult : unobserve.unionResult);\n\n      console.log(\"render boxes ended ==== \\n\\n\");\n    },\n\n    getSelectedIds(newValue) {\n      // v = newValue ? this.selectedQuery;\n      return typeof this.selectedQuery === \"number\"\n          ? [...unobserve.querys[this.selectedQuery].cache]\n          : this.selectedQuery === \"$int\"\n              ? unobserve.interResult\n              : unobserve.unionResult;\n    },\n\n    renderAxisHelper(e) {\n      const x = e.offsetX;\n      const y = !this.upsideDown ? unobserve.screenHeight - e.offsetY : e.offsetY;\n      const oriX = unobserve.axisXScle.invert(x);\n      const oriY = unobserve.screenyScale.invert(unobserve.screenHeight - y);\n\n      const date =\n          unobserve.inferX == \"date\"\n              ? moment(oriX).format(\"YYYY-MM-DD\")\n              : oriX.toFixed(2);\n\n      const upsideDown = this.upsideDown;\n      const enlargeFont = this.enlargeFont;\n      const fontWidth = enlargeFont ? 103 : 70;\n      const fontHeight = enlargeFont ? 22 : 20;\n      const heightInSvg = enlargeFont ? 18 : 12;\n      const option = {height: unobserve.screenHeight, width: unobserve.screenWidth};\n      if (this.showCursorValue) {\n        this.cursorHelper.selectAll(\"line\").each(function (_, i) {\n          d3.select(this)\n              .attr('x1', i === 0 ? 0 : x)\n              .attr('y1', i === 0 ? option.height - y : upsideDown ? 0 : option.height)\n              .attr('x2', x)\n              .attr('y2', option.height - y)\n              .attr('stroke-width', () => enlargeFont ? 2 : 1);\n        });\n\n        this.cursorHelper.selectAll(\"text\").each(function (_, i) {\n          d3.select(this)\n              .attr('x', i === 0 ? 0 : x - (x > option.width - fontWidth ? fontWidth : 0))\n              .attr(\n                  'y',\n                  i === 0 ? option.height - y + (y > option.height - fontHeight ? heightInSvg : 0) : upsideDown ? heightInSvg : option.height\n              )\n              .text(i === 0 ? oriY.toFixed(2) : date)\n              .attr('font-size', enlargeFont ? 20 : 14)\n        });\n      } else {\n        this.cursorHelper\n            .selectAll(\"line\")\n            .attr(\"x1\", 0)\n            .attr(\"x2\", 0)\n            .attr(\"y1\", 0)\n            .attr(\"y2\", 0);\n\n        this.cursorHelper.selectAll(\"text\").text(\"\");\n      }\n    },\n\n    getColorMap(overlay = false) {\n      const colormaps = [\n        [\n          [253, 231, 37],\n          [188, 223, 39],\n          [122, 209, 81],\n          [67, 191, 113],\n          [34, 168, 132],\n          [33, 145, 141],\n          [42, 120, 142],\n          [53, 96, 141],\n          [65, 68, 135],\n          [72, 37, 117],\n          [68, 1, 84],\n        ],\n        [\n          [252, 253, 191],\n          [254, 206, 145],\n          [254, 159, 109],\n          [247, 111, 92],\n          [222, 73, 104],\n          [182, 55, 122],\n          [140, 41, 129],\n          [101, 26, 128],\n          [59, 15, 112],\n          [21, 14, 55],\n          [0, 0, 4],\n        ],\n        [\n          [252, 255, 164],\n          [246, 214, 69],\n          [252, 165, 10],\n          [243, 119, 26],\n          [221, 81, 58],\n          [187, 55, 85],\n          [147, 38, 103],\n          [107, 23, 110],\n          [66, 10, 104],\n          [23, 12, 59],\n          [0, 0, 4],\n        ],\n        [\n          [240, 249, 33],\n          [252, 206, 37],\n          [252, 166, 54],\n          [242, 131, 76],\n          [225, 100, 98],\n          [203, 71, 121],\n          [177, 42, 144],\n          [144, 13, 164],\n          [106, 0, 168],\n          [66, 3, 157],\n          [13, 8, 135],\n        ],\n        [\n          [253, 234, 69],\n          [234, 209, 86],\n          [202, 186, 106],\n          [173, 164, 118],\n          [148, 143, 120],\n          [127, 124, 117],\n          [105, 105, 112],\n          [77, 86, 109],\n          [43, 68, 110],\n          [10, 50, 106],\n          [0, 32, 81],\n        ],\n        [\n          [144, 12, 0],\n          [186, 34, 8],\n          [246, 95, 24],\n          [255, 164, 35],\n          [222, 221, 50],\n          [149, 251, 81],\n          [77, 248, 132],\n          [39, 215, 196],\n          [47, 157, 245],\n          [74, 88, 221],\n          [35, 23, 27],\n        ],\n        [\n          [213, 239, 237],\n          [193, 232, 224],\n          [167, 221, 209],\n          [139, 210, 190],\n          [112, 198, 169],\n          [88, 186, 145],\n          [68, 173, 119],\n          [49, 156, 93],\n          [32, 137, 70],\n          [14, 119, 54],\n          [3, 100, 41],\n        ],\n        [\n          [204, 221, 236],\n          [186, 208, 228],\n          [168, 194, 221],\n          [154, 176, 212],\n          [145, 156, 201],\n          [141, 133, 190],\n          [139, 109, 178],\n          [138, 85, 166],\n          [135, 60, 153],\n          [130, 34, 135],\n          [115, 15, 113],\n        ],\n        [\n          [244, 209, 102],\n          [213, 202, 96],\n          [182, 195, 92],\n          [152, 187, 89],\n          [124, 178, 87],\n          [96, 166, 86],\n          [75, 156, 83],\n          [63, 143, 79],\n          [51, 131, 74],\n          [37, 119, 64],\n          [20, 108, 54],\n        ],\n        [\n          [244, 209, 102],\n          [248, 190, 92],\n          [248, 170, 76],\n          [245, 152, 59],\n          [243, 133, 42],\n          [239, 112, 27],\n          [226, 98, 31],\n          [214, 83, 34],\n          [197, 73, 35],\n          [177, 66, 35],\n          [158, 58, 38],\n        ],\n        [\n          [244, 209, 102],\n          [246, 190, 89],\n          [249, 170, 81],\n          [252, 150, 78],\n          [246, 131, 75],\n          [238, 115, 74],\n          [229, 98, 73],\n          [219, 82, 71],\n          [207, 66, 68],\n          [196, 49, 65],\n          [183, 29, 62],\n        ],\n        [\n          [211, 238, 206],\n          [197, 232, 195],\n          [177, 225, 187],\n          [155, 216, 187],\n          [130, 206, 194],\n          [105, 194, 202],\n          [81, 178, 205],\n          [60, 159, 199],\n          [40, 138, 189],\n          [22, 117, 177],\n          [11, 96, 161],\n        ],\n        [\n          [253, 220, 175],\n          [253, 207, 155],\n          [253, 193, 138],\n          [253, 173, 119],\n          [251, 149, 98],\n          [246, 125, 83],\n          [238, 101, 69],\n          [226, 73, 50],\n          [211, 45, 30],\n          [191, 19, 13],\n          [167, 4, 3],\n        ],\n        [\n          [219, 216, 234],\n          [200, 206, 228],\n          [176, 195, 222],\n          [147, 183, 216],\n          [114, 172, 209],\n          [84, 159, 200],\n          [56, 146, 187],\n          [28, 136, 163],\n          [9, 127, 135],\n          [2, 115, 107],\n          [1, 99, 83],\n        ],\n        [\n          [219, 218, 235],\n          [200, 206, 228],\n          [177, 195, 222],\n          [151, 183, 216],\n          [123, 172, 209],\n          [91, 159, 201],\n          [58, 144, 192],\n          [30, 127, 183],\n          [11, 112, 171],\n          [5, 97, 153],\n          [4, 82, 129],\n        ],\n        [\n          [220, 201, 226],\n          [211, 179, 215],\n          [206, 158, 204],\n          [209, 134, 192],\n          [218, 107, 178],\n          [225, 77, 160],\n          [226, 49, 137],\n          [217, 30, 111],\n          [198, 17, 89],\n          [171, 7, 73],\n          [143, 2, 58],\n        ],\n        [\n          [252, 207, 204],\n          [252, 190, 192],\n          [250, 169, 184],\n          [249, 143, 175],\n          [245, 113, 165],\n          [236, 83, 157],\n          [219, 54, 149],\n          [196, 27, 138],\n          [169, 8, 128],\n          [141, 1, 121],\n          [112, 1, 116],\n        ],\n        [\n          [239, 249, 189],\n          [219, 241, 180],\n          [189, 229, 181],\n          [148, 213, 185],\n          [105, 197, 190],\n          [69, 180, 194],\n          [44, 158, 192],\n          [33, 130, 184],\n          [33, 99, 170],\n          [35, 71, 156],\n          [28, 49, 133],\n        ],\n        [\n          [228, 244, 172],\n          [209, 236, 160],\n          [185, 226, 148],\n          [158, 214, 136],\n          [128, 201, 124],\n          [98, 187, 110],\n          [71, 170, 94],\n          [50, 151, 80],\n          [32, 131, 68],\n          [14, 114, 59],\n          [3, 96, 52],\n        ],\n        [\n          [254, 234, 161],\n          [254, 221, 132],\n          [254, 204, 99],\n          [254, 183, 70],\n          [252, 160, 49],\n          [246, 137, 33],\n          [235, 114, 21],\n          [219, 94, 11],\n          [197, 76, 5],\n          [171, 61, 3],\n          [143, 50, 4],\n        ],\n        [\n          [254, 224, 135],\n          [254, 209, 111],\n          [254, 189, 89],\n          [254, 168, 73],\n          [253, 144, 62],\n          [252, 115, 53],\n          [249, 82, 43],\n          [238, 52, 35],\n          [222, 27, 32],\n          [202, 11, 34],\n          [175, 2, 37],\n        ],\n      ];\n      return colormaps[\n          overlay ? this.colormapOverlayIndexCache : this.colormapIndexCache\n          ];\n    },\n\n    renderColorMap() {\n      // document.getElementById(\"colorMax\").innerText = currentDensityMax;\n      document.getElementById(\n          \"color-map\"\n      ).style.background = `linear-gradient(to right, ${this.getColorMap()\n          .map(\n              (color, i, arr) =>\n                  `rgb(${color.join(\", \")}) ${((i / (arr.length - 1)) * 100).toFixed(\n                      0\n                  )}%`\n          )\n          .join(\", \")})`;\n    },\n\n    renderColorMapOverlay() {\n      // document.getElementById(\"colorMax\").innerText = currentDensityMax;\n      document.getElementById(\n          \"color-map-overlay\"\n      ).style.background = `linear-gradient(to right, ${this.getColorMap(true)\n          .map(\n              (color, i, arr) =>\n                  `rgb(${color.join(\", \")}) ${((i / (arr.length - 1)) * 100).toFixed(\n                      0\n                  )}%`\n          )\n          .join(\", \")})`;\n    },\n\n    rgb(i, overlay = false) {\n      const ci = overlay\n          ? this.colormapOverlayIndexCache\n          : this.colormapIndexCache;\n      if (colorMapCache[ci]?.[Math.round(i * 10000)]) {\n        return colorMapCache[ci][Math.round(i * 10000)];\n      }\n      const colormap = this.getColorMap(overlay);\n      const base = Math.floor(i * 10);\n      if (i <= 0) return colormap[0];\n      if (i >= 1) return colormap[10];\n      if (colormap[base] === undefined) console.log(colormap, base, i);\n      const result = colormap[base].map(\n          (v, ci) => v + (colormap[base + 1][ci] - v) * (i * 10 - base)\n      );\n      if (!colorMapCache[ci]) {\n        colorMapCache[ci] = {};\n      }\n      colorMapCache[ci][Math.round(i * 10000)] = result;\n      return result;\n    },\n\n    //#region old render method\n    // renderAllDensity() {\n    //   let ids;\n    //   ids = new Array(unobserve.result.length).fill(0).map((_, i) => i);\n    //   let initFlag = true;\n    //   const bgContext = document.getElementById('canvas').getContext('2d');\n\n    //   console.time('temp canvas');\n    //   const tempCanvas = document.createElement('canvas');\n    //   tempCanvas.width = this.option.width;\n    //   tempCanvas.height = this.option.height;\n    //   const tempContext = tempCanvas.getContext('2d');\n    //   tempContext.globalCompositeOperation = 'lighter';\n    //   tempContext.strokeStyle = '#010101';\n    //   for (let id of ids) {\n    //     const line = unobserve.result[id];\n    //     tempContext.beginPath();\n    //     tempContext.moveTo(line[0].x, line[0].y);\n    //     for (let point of line) {\n    //       tempContext.lineTo(point.x, point.y);\n    //     }\n    //     tempContext.stroke();\n    //   }\n\n    //   const tempImageData = tempContext.getImageData(0, 0, this.option.width, this.option.height);\n    //   if (initFlag) {\n    //     this.initDensityBufferCache = tempContext.getImageData(0, 0, this.option.width, this.option.height);\n    //   }\n    //   console.timeEnd('temp canvas');\n    //   console.time('render');\n    //   bgContext.fillStyle = 'black';\n    //   bgContext.globalAlpha = 1;\n    //   bgContext.fillRect(0, 0, this.option.width, this.option.height);\n    //   bgContext.clearRect(0, 0, this.option.width, this.option.height);\n    //   const maxWeight =\n    //     this.maxDensity ||\n    //     tempImageData.data.reduce((p, v, i) =>\n    //       i % 4 === 3 ? p : Math.max(p, v)\n    //     );\n    //   this.maxDensity = maxWeight;\n    //   for (let i = 0; i < this.option.width; i++) {\n    //     for (let j = 0; j < this.option.height; j++) {\n    //       const ratio = tempImageData.data[(j * this.option.width + i) * 4] / maxWeight;\n    //       const color = this.rgb(ratio);\n    //       tempImageData.data.set(color, (j * this.option.width + i) * 4);\n    //       tempImageData.data[(j * this.option.width + i) * 4 + 3] = ratio <= 0 ? 0 : 255;\n    //     }\n    //   }\n    //   bgContext.putImageData(tempImageData, 0, 0);\n    //   console.timeEnd('render');\n    //   if (initFlag) {\n    //     this.initDensityMaxCache = maxWeight;\n    //     this.initDensityCache = bgContext.getImageData(0, 0, this.option.width, this.option.height);\n    //   }\n    //   this.currentDensityMax = maxWeight;\n    //   this.currentDensity = bgContext.getImageData(0, 0, this.option.width, this.option.height);\n    //   // renderColorMap();\n    // },\n    //#endregion\n\n    renderAllDensity(initFlag) {\n      const bgContext = document.getElementById(\"canvas\").getContext(\"2d\");\n      if (!unobserve.slopePixelCache) {\n        const cache = new Array(this.option.width)\n            .fill()\n            .map(() => new Array(this.option.height).fill().map(() => ({})));\n        for (let id in unobserve.result) {\n          const line = unobserve.result[id];\n          for (let i = 0; i < line.length - 1; i++) {\n            brensenhamArr(\n                [line[i], line[i + 1]],\n                cache,\n                id,\n                (line[i + 1].y - line[i].y) / (line[i + 1].x - line[i].x)\n            );\n          }\n        }\n        unobserve.slopePixelCache = cache;\n      }\n      console.time(\"temp canvas\");\n      const tempBuffer = new Float32Array(this.option.width * this.option.height).map((_, i) => {\n        const row = i % this.option.height;\n        const col = Math.floor(i / this.option.height);\n        const pixelCache = Object.values(unobserve.slopePixelCache[col][row]);\n        if (this.normalizeDensity) {\n          return pixelCache.reduce((p, v) => p + v, 0);\n        } else {\n          return pixelCache.length;\n        }\n      });\n      if (initFlag) {\n        this.initDensityBufferCache = tempBuffer;\n      }\n      console.timeEnd(\"temp canvas\");\n      console.time(\"render\");\n      bgContext.fillStyle = \"black\";\n      bgContext.globalAlpha = 1;\n      bgContext.fillRect(0, 0, this.option.width, this.option.height);\n      bgContext.clearRect(0, 0, this.option.width, this.option.height);\n      const tempImageBuffer = new Uint8ClampedArray(this.option.width * this.option.height * 4);\n      const tempImageData = new ImageData(tempImageBuffer, this.option.width, this.option.height);\n      const maxWeight = Math.ceil(\n          (!initFlag && this.maxDensity) ||\n          tempBuffer.reduce((p, v) => Math.max(p, v))\n      );\n      this.maxDensity = maxWeight;\n      if (initFlag) {\n        this.maxOverlayDensity = maxWeight;\n      }\n      const colorCache = {};\n      for (let i = 0; i < this.option.width; i++) {\n        for (let j = 0; j < this.option.height; j++) {\n          const ratio = Math.round((tempBuffer[i * this.option.height + j] / maxWeight) * 10000);\n          if (!colorCache[ratio]) {\n            colorCache[ratio] = this.rgb(ratio / 10000);\n          }\n          const color = colorCache[ratio];\n          tempImageBuffer.set(color, (j * this.option.width + i) * 4);\n          tempImageBuffer[(j * this.option.width + i) * 4 + 3] = ratio <= 0 ? 0 : 255;\n          // if (pixelCache.length > 0 && ratio <= 0) console.log(weight, ratio, maxWeight);\n        }\n      }\n      bgContext.putImageData(tempImageData, 0, 0);\n      console.timeEnd(\"render\");\n      if (initFlag) {\n        this.initDensityMaxCache = maxWeight;\n        this.initDensityCache = bgContext.getImageData(0, 0, this.option.width, this.option.height);\n      }\n      this.currentDensityMax = maxWeight;\n      this.currentDensity = bgContext.getImageData(0, 0, this.option.width, this.option.height);\n      // renderColorMap();\n    },\n\n    renderDensity() {\n      let ids = this.getSelectedIds();\n      const fastMapping = {};\n      ids.forEach((id) => (fastMapping[id] = 1));\n      let initFlag = false;\n      let renderFlag = false;\n      for (let i in this.layers) {\n        const layer = this.layers[i];\n        if (layer.name === \"selected density\" && layer.opacity > 0) {\n          renderFlag = true;\n        }\n      }\n      if (!renderFlag) return;\n      const bgContext = document\n          .getElementById(\"selectionCanvas\")\n          .getContext(\"2d\");\n\n      console.time(\"render\");\n      bgContext.fillStyle = \"black\";\n      bgContext.globalAlpha = 1;\n      bgContext.fillRect(0, 0, this.option.width, this.option.height);\n      bgContext.clearRect(0, 0, this.option.width, this.option.height);\n      const tempImageBuffer = new Uint8ClampedArray(this.option.width * this.option.height * 4);\n      const tempImageData = new ImageData(tempImageBuffer, this.option.width, this.option.height);\n      const maxWeight = this.maxOverlayDensity;\n      for (let i = 0; i < this.option.width; i++) {\n        for (let j = 0; j < this.option.height; j++) {\n          let weight = 0;\n          const pixelCache = Object.entries(unobserve.slopePixelCache[i][j]);\n          if (this.normalizeDensity) {\n            weight = pixelCache.reduce(\n                (p, v) => p + (fastMapping[v[0]] ? v[1] : 0),\n                0\n            );\n          } else {\n            weight = pixelCache.reduce(\n                (p, v) => p + (fastMapping[v[0]] ? 1 : 0),\n                0\n            );\n          }\n          const ratio = weight / maxWeight;\n          const color = this.rgb(ratio, true);\n          tempImageBuffer.set(color, (j * this.option.width + i) * 4);\n          tempImageBuffer[(j * this.option.width + i) * 4 + 3] = ratio <= 0 ? 0 : 255;\n        }\n      }\n      bgContext.putImageData(tempImageData, 0, 0);\n      console.timeEnd(\"render\");\n      this.currentDensityMax = maxWeight;\n      this.currentDensity = bgContext.getImageData(0, 0, this.option.width, this.option.height);\n    },\n\n    rearrangeLayer(\n        options = [\n          {\n            name: \"raw_lines\",\n            opacity: 0,\n            zIndex: 0,\n          },\n          {\n            name: \"canvas\",\n            opacity: 1,\n            zIndex: 1,\n          },\n          {\n            name: \"selectionCanvas\",\n            opacity: 0,\n            zIndex: 2,\n          },\n          {\n            name: \"selectionLayer\",\n            opacity: 0.4,\n            zIndex: 3,\n          },\n          {\n            name: \"rep_layer\",\n            opacity: 1,\n            zIndex: 4,\n          },\n        ]\n    ) {\n      for (let ind in options) {\n        const option = options[ind];\n        let ele = document.getElementById(option.id);\n        ele.style.opacity = option.opacity;\n        ele.style.zIndex = `${6 - ind}`;\n      }\n    },\n\n    setReverseY() {\n      console.log(\"before set\", this.yScale.range());\n      this.yScale.range(this.upsideDown ? [0, this.option.height] : [this.option.height, 0]);\n      unobserve.screenyScale.range(this.upsideDown ? [0, unobserve.screenHeight] : [unobserve.screenHeight, 0]);\n      console.log(\"after set\", this.yScale.range());\n\n      const scaleY = `scaleY(${!this.upsideDown ? 1 : -1})`;\n\n      //#region reverse the every canvas\n      const canvasList = [\n        \"canvas\",\n        \"selectionCanvas\",\n        \"selectionLayer\",\n        \"rep_layer\",\n        \"raw_lines\",\n        \"mouseLayer\",\n        \"hoverLayer\",\n      ];\n      for (let id of canvasList) {\n        document.getElementById(id).style.transform = scaleY;\n      }\n      //#regionend\n\n      this.svg.select(\"#xaxis\").remove();\n      this.svg.select(\"#yaxis\").remove();\n      // svg.append(\"g\").attr(\"transform\", \"translate(30,this.option.height)\").call(xAxis);\n      this.svg\n          .append('g')\n          .attr('id', 'yaxis')\n          .attr('transform', 'translate(50,20)')\n          .call(unobserve.yAxis);\n      this.svg\n          .append('g')\n          .attr('id', 'xaxis')\n          .attr('transform', `translate(50,${this.upsideDown ? 20 : unobserve.screenHeight + 20})`)\n          .call(this.upsideDown ? unobserve.xAxisR : unobserve.xAxis);\n    },\n    getStaticInformation(ids) {\n      if (!ids || !ids.length) return {};\n      // ids = new Array(unobserve.result.length).fill(0).map((_,i) => i);\n      const minX = d3.min(ids, (id) => unobserve.result[id][0].x);\n      const maxX = d3.max(ids, (id) => unobserve.result[id][0].x);\n      const minY = d3.min(ids, (id) =>\n          d3.min(unobserve.result[id], (d) => this.yScaleC.invert(d.y))\n      );\n      const maxY = d3.max(ids, (id) =>\n          d3.max(unobserve.result[id], (d) => this.yScaleC.invert(d.y))\n      );\n      const means = ids.map((id) =>\n          d3.mean(unobserve.result[id], (d) => this.yScaleC.invert(d.y))\n      );\n      const mean = d3.mean(means);\n      const variance =\n          means.length > 1\n              ? d3.variance(means)\n              : d3.variance(unobserve.result[ids[0]], (d) =>\n                  this.yScaleC.invert(d.y)\n              );\n\n      return {\n        minT: moment(this.xScale.invert(minX)).format(\"YYYY-M-D\"),\n        maxT: moment(this.xScale.invert(maxX)).format(\"YYYY-M-D\"),\n        minV: minY.toFixed(2),\n        maxV: maxY.toFixed(2),\n        count: ids.length,\n        points: ids.reduce((p, v) => p + unobserve.result[v]?.length ?? 0, 0),\n        mean: mean.toFixed(2),\n        var: variance.toFixed(2),\n      };\n    },\n\n    getColor(id) {\n      if (this.colorCache[id]) return this.colorCache[id];\n\n      function luminance(r, g, b) {\n        var a = [r, g, b].map(function (v) {\n          v /= 255;\n          return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);\n        });\n        return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;\n      }\n\n      function contrast(rgb1, rgb2) {\n        var lum1 = luminance(rgb1[0], rgb1[1], rgb1[2]);\n        var lum2 = luminance(rgb2[0], rgb2[1], rgb2[2]);\n        var brightest = Math.max(lum1, lum2);\n        var darkest = Math.min(lum1, lum2);\n        return (brightest + 0.05) / (darkest + 0.05);\n      }\n\n      const r = seedrandom(id);\n      let res = new Array(3).fill(0).map(() => Math.floor(r() * 255));\n      while (contrast(res, [255, 255, 255]) < 3) {\n        res = new Array(3).fill(0).map(() => Math.floor(r() * 255));\n      }\n      this.colorCache[id] = res;\n      return res;\n    },\n\n    calcRepLines(ids) {\n      console.time('calc line weight')\n      const lineCount = this.repCount;\n      const lineWeights = ids\n          .map((id) => ({\n            id,\n            w: this.calcLineWeight(id),\n          }))\n      console.timeEnd('calc line weight')\n      lineWeights.sort(\n              (a, b) => b.w[0] * Math.sqrt(b.w[1]) - a.w[0] * Math.sqrt(a.w[1])\n          );\n      // if (!this.calculatedMaxDiverse) {\n      //   this.maxDiverse = d3.max(lineWeights, line => d3.max(line.cur, d=>d.y));\n      //   console.log('calculated maxdiverse', this.maxDiverse, lineWeights);\n      //   this.calculatedMaxDiverse = true;\n      // }\n      // const extend0 = d3.extent(lineWeights, d => d.cur[0]);\n      // const extend1 = d3.extent(lineWeights, d => d.cur[1]);\n      // const scale0 = d3.scaleLinear().domain(extend0).range([0, 1]);\n      // const scale1 = d3.scaleLinear().domain(extend1).range([0, 1]);\n      //\n      // lineWeights.forEach(d => {\n      //   d.cur[0] = scale0(d.cur[0]);\n      //   d.cur[1] = scale1(d.cur[1]);\n      // })\n      return (\n          lineWeights\n              .reduce((p, v) => {\n                // if (document.getElementById(\"show-all-clusters\").checked) {\n                //   p.push(v);\n                //   return p;\n                // }\n                \n                if (\n                    p.length >= lineCount) {\n                  return p;\n                } \n                v.cur = calculateCurvature(\n                    unobserve.result[v.id]\n                        .filter((point) =>\n                        unobserve.querys.length <= 0 && !unobserve.preview\n                            ? true\n                            : (unobserve.preview\n                                ? [unobserve.preview]\n                                : unobserve.querys\n                            ).find((query) => {\n                              if (query.type === \"knn\") {\n                                return true; // TODO: only line in knn\n                              } else if (query.type === \"rnn\") {\n                                return (\n                                    Math.sqrt(\n                                        Math.pow(point.x - query.start[0], 2) +\n                                        Math.pow(point.y - query.start[1], 2)\n                                    ) <= query.n\n                                );\n                              } else if (query.type === \"brush\") {\n                                const startX = Math.min(query.start[0], query.end[0]);\n                                const startY = Math.min(query.start[1], query.end[1]);\n                                const endX = Math.max(query.start[0], query.end[0]);\n                                const endY = Math.max(query.start[1], query.end[1]);\n                                return (\n                                    point.x >= startX &&\n                                    point.y >= startY &&\n                                    point.x <= endX &&\n                                    point.y <= endY\n                                );\n                              } else if (query.type === \"ang\") {\n                                const startX = Math.min(query.start[0], query.end[0]);\n                                const endX = Math.max(query.start[0], query.end[0]);\n                                return point.x >= startX && point.x <= endX;\n                              }\n                            })\n                    )\n                );\n                if(p.find((a) => calculateDifference(a.cur, v.cur) < this.diverse)) {\n                  return p;\n                }\n                p.push(v);\n                return p;\n              }, [])\n              // .slice(0, lineCount)\n              .map((x) => x.id)\n      );\n    },\n    drawLineWithLayer(ids, layer) {\n      const width = Math.min(Math.max(1, unobserve.screenHeight /  this.option.height), 5);\n      layer.lineWidth = width;\n      for (let id of ids) {\n        const line = unobserve.screenResult[id];\n        // console.log(JSON.stringify(line), JSON.stringify(unobserve.screenResult[id]));\n        layer.strokeStyle = `rgb(${this.getColor(id).join(',')})`;\n        layer.beginPath();\n        layer.moveTo(line[0].x, line[0].y);\n        for (let point of line) {\n          layer.lineTo(point.x, point.y);\n        }\n        layer.stroke();\n      }\n    },\n    drawLine(ids) {\n      // Selected Part =====================\n      if (this.preview) {\n        ids = ids.slice(0, 5);\n      }\n      if (!this.preview) {\n        this.drawLineWithLayer(ids, unobserve.selectionLayerContext);\n        unobserve.selectedLines = ids;\n      }\n\n      // REP PART =====================\n\n      if (this.preview) {\n        ids = [...this.preview.cache];\n      } else if (!unobserve.querys.length) {\n        ids = new Array(unobserve.result.length).fill(0).map((_, i) => i);\n      }\n      const topIds = this.calcRepLines(ids);\n\n      if (!unobserve.querys.length) {\n        unobserve.globalRep = topIds;\n      }\n      this.drawLineWithLayer(topIds, unobserve.repLayerContext);\n      unobserve.repIds = topIds;\n    },\n    calcLineWeight(id) {\n      let weight = 0;\n      let passedPixels = 0;\n      let lineLen = 0;\n      const hasBrush = unobserve.querys.find((q) => q.type === \"brush\");\n      const brushes = unobserve.querys\n          .filter((q) => q.type === \"brush\")\n          .map((b) => [\n            Math.min(b.start[0], b.end[0]),\n            Math.max(b.start[0], b.end[0]),\n            Math.min(b.start[1], b.end[1]),\n            Math.max(b.start[1], b.end[1]),\n          ]);\n      // if (unobserve.weightCache[id] !== undefined && !hasBrush) return unobserve.weightCache[id];\n      const line = unobserve.result[id];\n      const width = this.option.width;\n      const height = this.option.height;\n      const cache = this.initDensityBufferCache;\n\n      for (let i = 0; i < line.length - 1; i++) {\n        let xx = Math.floor(line[i + 1].x);\n        let yy = Math.floor(line[i + 1].y);\n        let x = Math.floor(line[i].x);\n        let y = Math.floor(line[i].y);\n        // BRENSENHAM\n        let dx = Math.abs(xx - x);\n        let sx = x < xx ? 1 : -1;\n        let dy = -Math.abs(yy - y);\n        let sy = y < yy ? 1 : -1;\n        let err = dx + dy;\n        let errC; // error value\n        let end = false;\n        let x1 = x;\n        let y1 = y;\n        let px = 0;\n\n        while (!end) {\n          if (\n              (!hasBrush ||\n                  brushes.find(\n                      (b) => b[0] <= x1 && b[1] >= x1 && b[2] <= y1 && b[3] >= y1\n                  )) &&\n              x1 >= 0 &&\n              x1 < width &&\n              y1 >= 0 &&\n              y1 < height\n          ) {\n            weight += cache[x1 * height + y1];\n            passedPixels++;\n            if (x1 !== px) {\n              px = x1;\n              lineLen++;\n            }\n          }\n          if (x1 === xx && y1 === yy) {\n            end = true;\n          } else {\n            errC = 2 * err;\n            if (errC >= dy) {\n              err += dy;\n              x1 += sx;\n            }\n            if (errC <= dx) {\n              err += dx;\n              y1 += sy;\n            }\n          }\n        }\n      }\n\n      let oldWeight = weight;\n      weight /= passedPixels;\n\n      if (!isFinite(weight) || isNaN(weight)) {\n        weight = 0.00001;\n      }\n\n      if (!hasBrush) {\n        unobserve.weightCache[id] = [\n          weight * Math.sqrt(lineLen),\n          line[line.length - 1].x - line[0].x,\n        ];\n      }\n      return [weight * Math.sqrt(lineLen), line[line.length - 1].x - line[0].x];\n    },\n  },\n  mounted() {\n    // change the canvas size\n\n    unobserve.screenWidth = 1000;\n    unobserve.screenHeight = 500;\n\n    const width = unobserve.screenWidth + 'px';\n    const height = unobserve.screenHeight + 'px';\n    let elementIds = [\n        'blank-div',\n        'canvas',\n        'selectionCanvas',\n        // 'selectionLayer',\n        // 'rep_layer',\n        // 'raw_lines',\n        // 'mouseLayer',\n        // 'hoverLayer',\n        // 'axisHelper'\n    ];\n    for (let i of elementIds) {\n      const ele = document.getElementById(i);\n      console.log(ele);\n      ele.style.width = width;\n      ele.style.height = height;\n    }\n\n\n\n    unobserve.querys = [];\n    unobserve.weightCache = [];\n    unobserve.layers = this.layers;\n    unobserve.upsideDown = this.upsideDown;\n\n    this.headers = unobserve.headers.map((title, key) => {\n      return {title, key, minWidth: 150};\n    });\n\n    const headerMap = new Map();\n    const sets = [];\n    unobserve.headers.forEach(() => {\n      sets.push(new Set());\n    });\n\n    unobserve.data.forEach((column) => {\n      column.forEach((d, i) => {\n        sets[i].add(d);\n      });\n    });\n    unobserve.headers.forEach((d, i) => {\n      headerMap.set(d, [...sets[i]]);\n    });\n    unobserve.headerMap = headerMap;\n\n    const data = unobserve.aggregatedData;\n    console.log(data);\n    const minX = d3.min(data, (line) => d3.min(line[this.timeIndex]));\n    const maxX = d3.max(data, (line) => d3.max(line[this.timeIndex]));\n    const minY = d3.min(data, (line) => d3.min(line[this.valueIndex]));\n    const maxY = d3.max(data, (line) => d3.max(line[this.valueIndex]));\n    console.log(minX, maxX, minY, maxY);\n\n    const xScaleData = d3\n        .scaleLinear()\n        .domain([minX, maxX])\n        .range([0, this.option.width]);\n    this.xScale =\n        unobserve.inferX == \"date\"\n            ? d3\n                .scaleTime()\n                .domain([\n                  new Date(minX * 3600 * 24 * 1000),\n                  new Date(maxX * 3600 * 24 * 1000),\n                ])\n                .range([0, this.option.width])\n            : xScaleData;\n    this.yScale = d3\n        .scaleLinear()\n        .domain([minY, maxY])\n        .range([this.option.height, 0]);\n    this.yScaleC = this.yScale.copy()\n\n    unobserve.screenXScale = xScaleData.copy().range([0, unobserve.screenWidth]);\n    unobserve.axisXScle = this.xScale.copy().range([0, unobserve.screenWidth]);\n    unobserve.screenyScale = this.yScale.copy().range([unobserve.screenHeight, 0]);\n    unobserve.screenyScaleC = this.yScale.copy().range([unobserve.screenHeight, 0]);\n\n    const conversion = [];\n    const conversion2 = [];\n\n    let result = data.map((line) => {\n      let res = [];\n      line[this.timeIndex].forEach((d, i) => {\n        conversion2.push([d, xScaleData(d)]);\n        res.push({\n          x: xScaleData(d),\n          y: this.yScale(line[this.valueIndex][i]),\n        });\n      });\n      return res;\n    });\n\n    let screenResult = data.map((line) => {\n      const res = []\n      line[this.timeIndex].forEach((d, i) => {\n        conversion.push([d, unobserve.screenXScale(d)]);\n        res.push({\n          x: unobserve.screenXScale(d),\n          y: unobserve.screenyScale(line[this.valueIndex][i]),\n        });\n      });\n      return res;\n    });\n    unobserve.result = result;\n    unobserve.screenResult = screenResult;\n    let drawMode = \"all\";\n    let reverseY = false;\n    //#endregion\n\n    // #region init tree\n\n    this.tr = {}; // Avoid tracking properties in tree\n    this.tr.ee = new KDTree(result);\n    console.log(this.tr.ee);\n    // this.tr.ee.buildKDTree();\n\n    // tree.render(\n    //   document.getElementById(\"canvas\"),\n    //   [\n    //     [0, this.option.width],\n    //     [0, this.option.height],\n    //   ],\n    //   [\n    //     [0, this.option.width],\n    //     [0, this.option.height],\n    //   ],\n    //   [[1]]\n    // ); // GPU will be faster\n    // In order to have a high performance, we use JS fallback instead\n    this.renderAllDensity(true);\n    this.renderDensity();\n    //#endregion\n\n    //#region init helpers\n    unobserve.selectionLayerContext = document\n        .getElementById(\"selectionLayer\")\n        .getContext(\"2d\");\n    unobserve.mouseLayerContext = document\n        .getElementById(\"mouseLayer\")\n        .getContext(\"2d\");\n    unobserve.repLayerContext = document\n        .getElementById(\"rep_layer\")\n        .getContext(\"2d\");\n    unobserve.rawLinesLayerContext = document\n        .getElementById(\"raw_lines\")\n        .getContext(\"2d\");\n    unobserve.hoverLayer = document\n        .getElementById('hoverLayer')\n        .getContext(\"2d\");\n    this.svg = d3.select(document.getElementById(\"axisHelper\"));\n    // this.svg.attr('viewBox', [0, 0, this.option.width, this.option.height]);\n    this.cursorHelper = d3.select(document.getElementById(\"cursorHelper\"));\n\n    const xAxis = d3.axisBottom(unobserve.axisXScle);\n    const xAxisR = d3.axisTop(unobserve.axisXScle);\n    const yAxis = d3.axisLeft(unobserve.screenyScale);\n    unobserve.yAxis = yAxis;\n    unobserve.xAxis = xAxis;\n    unobserve.xAxisR = xAxisR;\n\n    this.svg\n        .append('g')\n        .attr('id', 'xaxis')\n        .attr('transform', `translate(50,${unobserve.screenHeight + 20})`)\n        .call(xAxis);\n    // svg.append(\"g\").attr(\"transform\", \"translate(50,0)\").call(yAxis);\n    this.svg\n        .append('g')\n        .attr('id', 'yaxis')\n        .attr('transform', 'translate(50,20)')\n        .call(yAxis);\n\n    //#endregion\n\n    //#region init functions\n\n    //#endregion\n\n    // renderQuerys();\n    this.renderBoxes();\n    this.drawRawLines();\n    this.rearrangeLayer(this.layers);\n    this.cnt++;\n    // console.log(this.layers);\n    // this.colormapIndexCache = 1;\n    this.renderColorMap();\n    this.renderColorMapOverlay();\n    // const colormapList = document.querySelector('#colormap > div.ivu-select-dropdown > ul.ivu-select-dropdown-list');\n\n    // const table = document.querySelector(\n    //   \"#app > div > div.ivu-layout-content > div:nth-child(2) > div > div > div > div > div.ivu-table-wrapper.ivu-table-wrapper-with-border > div.ivu-table.ivu-table-default.ivu-table-border\"\n    // );\n    const tableId = document.getElementById(\"informationTable\");\n    tableId.addEventListener(\"mousemove\", (e) => {\n      let ele = null;\n      if (e.path.length >= 18) ele = e.path[e.path.length - 18];\n      if (\n          !ele ||\n          !(\n              ele.tagName.toLowerCase() === \"tr\" &&\n              ele.parentNode.tagName.toLowerCase() === \"tbody\"\n          )\n      ) {\n        this.hoveringInd = null;\n        this.renderBoxes(\"mouseLayer\");\n      } else {\n        let ind;\n        const children = ele.parentNode.children;\n        let counter = 0;\n        for (let i = 0; i < children.length; i++) {\n          const e = children[i];\n          if (e.className?.includes(\"ivu-table-row\")) {\n            counter++;\n          }\n          if (e === ele) {\n            ind = counter - 1;\n            break;\n          }\n        }\n        if (ind >= unobserve.querys.length) {\n          this.renderBoxes(\"mouseLayer\");\n          this.hoveringInd = null;\n          return;\n        }\n        this.hoveringQuery(ind);\n      }\n    });\n\n    tableId.addEventListener(\"mouseleave\", () => {\n      this.renderBoxes(\"mouseLayer\");\n      this.hoveringInd = null;\n    });\n  },\n  beforeDestroy() {\n    if (this.contextHandler) {\n      this.contextHandler.destroy();\n    }\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.control-panel {\n  display: flex;\n  flex-direction: column;\n  margin-left: 50px;\n\n  > * {\n    margin-bottom: 8px !important;\n  }\n}\n\n.color-map {\n  //background-image: linear-gradient(\n  //        to right,\n  //        #fcfdbf,\n  //        #fece91 10%,\n  //        #fe9f6d 20%,\n  //        #f76f5c 30%,\n  //        #de4968 40%,\n  //        #b6377a 50%,\n  //        #8c2981 60%,\n  //        #651a80 70%,\n  //        #3b0f70 80%,\n  //        #150e37 90%,\n  //        #000004\n  //);\n  display: inline-block;\n  width: 200px;\n  height: 32px;\n  margin: 0 10px;\n  vertical-align: middle;\n  border-radius: 4px;\n\n  &#color-map-overlay {\n    width: 160px;\n  }\n}\n\n.select-colormap {\n  width: 90px;\n  display: inline-block;\n  vertical-align: middle;\n  // margin: 0 7px;\n}\n\n#informationTable {\n  > .ivu-table {\n    > .ivu-table-body {\n      > table > .ivu-table-tbody {\n        > tr.ivu-table-row-hover {\n          outline: 2px solid red;\n          outline-offset: -2px;\n\n          > td {\n            background: transparent;\n          }\n        }\n\n        > tr.selected-table-row td {\n          background: #d3ebff;\n        }\n\n        .ivu-btn-ghost.ivu-btn-default {\n          color: #000;\n          border-color: #888;\n        }\n      }\n    }\n  }\n}\n\n#colormap,\n#colormapOverlay {\n  width: 200px;\n  position: absolute;\n  left: 107px;\n  top: 0;\n\n  &#colormapOverlay {\n    width: 160px;\n  }\n\n  .ivu-select-selection {\n    background: transparent;\n    border: none;\n\n    .ivu-select-selected-value,\n    .ivu-select-placeholder {\n      display: none;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CanvasBox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CanvasBox.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CanvasBox.vue?vue&type=template&id=28abe7f2&\"\nimport script from \"./CanvasBox.vue?vue&type=script&lang=js&\"\nexport * from \"./CanvasBox.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CanvasBox.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport parse from \"csv-parse/lib/sync\";\nimport axios from \"axios\";\nvar exampleDataURL = [\n    require(\"../data/stocks.filtered.csv\").default,\n    require(\"../data/airline.filtered.csv\").default,\n    require(\"../data/weather.filtered.csv\").default,\n    require(\"../data/reading.filtered.csv\").default,\n    require(\"../data/mergeSMART194month.filtered.csv\").default,\n];\n/**\n * Generate test time series with a random walk.\n * @param numSeries Number of series.\n * @param numDataPoints Number of data points per series.\n */\nexport function generateData(idx) {\n    return __awaiter(this, void 0, void 0, function () {\n        var result, data;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, axios.get(exampleDataURL[idx - 1])];\n                case 1:\n                    result = _a.sent();\n                    data = parse(result.data, {\n                        skip_empty_lines: true,\n                    });\n                    return [2 /*return*/, data];\n            }\n        });\n    });\n}\nexport function readData(file) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, new Promise(function (res) {\n                    var reader = new FileReader();\n                    reader.onload = function () {\n                        res(parse(reader.result, {\n                            skip_empty_lines: true,\n                        }));\n                    };\n                    reader.readAsText(file);\n                })];\n        });\n    });\n}\n","<template>\n  <div id=\"app\">\n    <Layout>\n      <Header>\n        <h1 class=\"layout-logo\">KD-Box</h1>\n        <Menu mode=\"horizontal\" theme=\"dark\" @on-select=\"eventHandler\">\n          <div class=\"layout-nav\">\n            <Upload\n              action=\"/\"\n              v-show=\"false\"\n              ref=\"upload\"\n              :before-upload=\"readFileHandler\"\n            />\n            <Submenu name=\"3\">\n              <template slot=\"title\">\n                <Icon type=\"ios-archive\"></Icon>\n                Example data\n              </template>\n              <MenuItem name=\"1-1\">Stocks(25.2MB)</MenuItem>\n              <MenuItem name=\"1-2\">Airline(10.6MB)</MenuItem>\n              <MenuItem name=\"1-3\">Weather(29.6MB)</MenuItem>\n              <MenuItem name=\"1-4\">Reading(18.5MB)</MenuItem>\n              <MenuItem name=\"1-5\">HardDrive(66.3MB)</MenuItem>\n            </Submenu>\n            <MenuItem name=\"2\">\n              <Icon type=\"ios-cloud-upload-outline\"></Icon>\n              Load data\n            </MenuItem>\n          </div>\n        </Menu>\n      </Header>\n      <Content\n        :style=\"{\n          width: '1850px',\n          margin: '0 auto',\n          padding: '0 50px',\n          display: 'flex',\n          flexDirection: 'row',\n        }\"\n      >\n        <Card class=\"sticky-content\">\n          <div>\n            <Button @click=\"eventHandler('2')\" style=\"width: 200px\" type=\"info\">\n              <Icon type=\"ios-cloud-upload-outline\"></Icon>\n              Load data\n            </Button>\n            <Poptip style=\"width: 200px; display: block;\">\n              <Button style=\"width: 200px\">Example Data</Button>\n              <div\n                style=\"display: flex; flex-direction: column;\"\n                slot=\"content\"\n              >\n                <Button style=\"width: 200px\" @click=\"eventHandler('1-1')\"\n                  >Stocks(25.2MB)</Button\n                >\n                <Button style=\"width: 200px\" @click=\"eventHandler('1-2')\"\n                  >Airline(10.6MB)</Button\n                >\n                <Button style=\"width: 200px\" @click=\"eventHandler('1-3')\"\n                  >Weather(29.6MB)</Button\n                >\n                <Button style=\"width: 200px\" @click=\"eventHandler('1-4')\"\n                  >Reading(18.5MB)</Button\n                >\n                <Button style=\"width: 200px\" @click=\"eventHandler('1-5')\"\n                  >HardDrive(66.3MB)</Button\n                >\n              </div>\n            </Poptip>\n            <Upload\n              action=\"/\"\n              v-show=\"false\"\n              ref=\"upload\"\n              :before-upload=\"readFileHandler\"\n            />\n            <!--            <Menu-->\n            <!--                active-name=\"2\"-->\n            <!--                :open-names=\"[]\"-->\n            <!--                style=\"margin-bottom: 100px; width: 200px;\"-->\n            <!--                @on-select=\"eventHandler\"-->\n            <!--            >-->\n            <!--              <MenuItem name=\"2\">-->\n            <!--                <Icon type=\"ios-cloud-upload-outline\"></Icon>-->\n            <!--                Load data-->\n            <!--              </MenuItem>-->\n            <!--              <Submenu name=\"1\">-->\n            <!--                <template slot=\"title\">-->\n            <!--                  <Icon type=\"ios-archive\"/>-->\n            <!--                  Example Data-->\n            <!--                </template>-->\n            <!--                <MenuItem name=\"1-1\">Stocks(25.2M)</MenuItem>-->\n            <!--                <MenuItem name=\"1-2\">Airline(10.6M)</MenuItem>-->\n            <!--                <MenuItem name=\"1-3\">Weather(29.6M)</MenuItem>-->\n            <!--                <MenuItem name=\"1-4\">Reading(18.5M)</MenuItem>-->\n            <!--              </Submenu>-->\n            <!--            </Menu>-->\n\n            <p style=\"margin-top: 100px\">Line Aggregation Attribute:</p>\n            <Select v-model=\"aggregateAttr\" style=\"width:200px\">\n              <Option v-for=\"(attr, i) in headers\" :value=\"i\" :key=\"i\"\n                >{{ attr }}\n              </Option>\n            </Select>\n            <p>Time Attribute:</p>\n            <Select v-model=\"timeAttr\" style=\"width:200px\">\n              <template v-for=\"(attr, i) in headers\">\n                <Option v-if=\"inferTypes[i] != 'string'\" :value=\"i\" :key=\"i\"\n                  >{{ attr }}\n                </Option>\n              </template>\n            </Select>\n            <p>Value Attribute:</p>\n            <Select v-model=\"valueAttr\" style=\"width:200px\">\n              <template v-for=\"(attr, i) in headers\">\n                <Option v-if=\"inferTypes[i] == 'number'\" :value=\"i\" :key=\"i\"\n                  >{{ attr }}\n                </Option>\n              </template>\n            </Select>\n            <br />\n            <br />\n            <p>Resolution:</p>\n            <div style=\"margin-bottom: 20px\">\n              <InputNumber\n                  v-model=\"canvasWidth\"\n              >\n              </InputNumber>\n              <Icon type=\"ios-close\"></Icon>\n              <InputNumber\n                  v-model=\"canvasHeight\"\n              >\n              </InputNumber>\n            </div>\n            <Button\n              @click=\"generateCharts\"\n              type=\"primary\"\n              style=\"width:200px\"\n              :disabled=\"!headers.length\"\n              >generate chart\n            </Button>\n            <div style=\"margin-top:100px\">\n              <Button type=\"primary\" @click=\"exportFig\" style=\"width:200px\"\n                >export figure\n              </Button>\n              <br />\n              <Button\n                type=\"primary\"\n                @click=\"exportData(1)\"\n                style=\"margin-top:12px;width:200px\"\n                >export representative lines\n              </Button>\n              <br />\n              <Button\n                type=\"primary\"\n                @click=\"exportData(0)\"\n                style=\"margin-top:12px;width:200px\"\n                >export select lines\n              </Button>\n              <!-- <p>Layers:</p> -->\n              <!-- <draggable v-model=\"layers\">\n                <div\n                  v-for=\"layer in layers\"\n                  :key=\"layer.id\"\n                  style=\"display:flex;align-items:center;border:1px solid gray;margin-top:4px;background:white;cursor:pointer\"\n                >\n                  <Icon type=\"md-menu\" style=\"cursor:move\" />\n                  <Poptip\n                    :width=\"200\"\n                    style=\"flex-grow:1\"\n                    trigger=\"click\"\n                    :title=\"'Layer: ' + layer.name\"\n                  >\n                    <p style=\"width:170px;padding-left: 12px\">\n                      {{ layer.name }}\n                    </p>\n                    <div slot=\"content\" style=\"display:flex;align-items:center\">\n                      <span style=\"margin-right:8px\">Opacity</span>\n                      <Slider\n                        v-model=\"layer.opacity\"\n                        :min=\"0\"\n                        :max=\"1\"\n                        :step=\"0.01\"\n                        show-tip=\"never\"\n                        style=\"flex-grow:1\"\n                      />\n                      <span style=\"margin-left:8px;white-space:pre-wrap;\"\n                        >{{\n                          Math.round(layer.opacity * 100)\n                            .toString()\n                            .padStart(3)\n                        }}%</span\n                      >\n                    </div>\n                  </Poptip>\n                  <Icon\n                    :type=\"layer.opacity === 0 ? 'md-eye-off' : 'md-eye'\"\n                    :style=\"{ opacity: layer.opacity * 0.7 + 0.3 }\"\n                    @click=\"layer.opacity = layer.opacity === 0 ? 1 : 0\"\n                  />\n                </div>\n              </draggable> -->\n            </div>\n          </div>\n        </Card>\n        <Card style=\"padding-left: 20px;flex-grow:1\" dis-hover :bordered=\"false\">\n          <div style=\"min-height: 200px;color:red\" v-if=\"!headers.length\">\n            Please load a dataset (.csv file) first!\n            <Button\n              @click=\"eventHandler('1-1')\"\n              type=\"primary\"\n              icon=\"ios-archive\"\n              style=\"margin:0 12px\"\n              >Example Stocks(25.2MB)\n            </Button>\n            <Button\n              @click=\"eventHandler('1-2')\"\n              type=\"primary\"\n              icon=\"ios-archive\"\n              style=\"margin:0 12px\"\n              >Example Airline(10.6MB)\n            </Button>\n            <Button\n              @click=\"eventHandler('1-3')\"\n              type=\"primary\"\n              icon=\"ios-archive\"\n              style=\"margin:0 12px\"\n              >Example Weather(29.6MB)\n            </Button>\n            <Button\n              @click=\"eventHandler('1-4')\"\n              type=\"primary\"\n              icon=\"ios-archive\"\n              style=\"margin:0 12px\"\n              >Example Reading(18.5MB)\n            </Button>\n            <Button\n              @click=\"eventHandler('1-5')\"\n              type=\"primary\"\n              icon=\"ios-archive\"\n              style=\"margin:0 12px\"\n              >Example HardDrive(66.3MB)\n            </Button>\n            <Button\n              @click=\"eventHandler('2')\"\n              type=\"primary\"\n              icon=\"ios-cloud-upload-outline\"\n              style=\"margin:0 12px\"\n              >Load data\n            </Button>\n          </div>\n          <div v-else>\n            <div\n              style=\"min-height: 200px;color:red\"\n              v-if=\"!chartConfigs.length\"\n            >\n              Please use a valid configuration in left panel!\n            </div>\n            <div v-else>\n              <template v-for=\"(config, i) in chartConfigs\">\n                <CanvasBox\n                  :key=\"\n                    config.aggregateName +\n                      '#' +\n                      config.timeName +\n                      '#' +\n                      config.valueName +\n                      '#' +\n                      width +\n                      '#' +\n                      height\n                  \"\n                  :timeIndex=\"config.timeIndex\"\n                  :valueIndex=\"config.valueIndex\"\n                  :timeName=\"config.timeName\"\n                  :valueName=\"config.valueName\"\n                  :filter=\"config.filter\"\n                  :layers=\"layers\"\n                  :option=\"{height, width}\"\n                  @filterChange=\"handleFilterChange(i, $event)\"\n                />\n              </template>\n            </div>\n          </div>\n        </Card>\n      </Content>\n      <!-- <Footer class=\"layout-footer-center\">2020 &copy; VisLab.Wang</Footer> -->\n    </Layout>\n  </div>\n</template>\n\n<script>\nimport { exportCanvas } from \"./core/utils\";\nimport CanvasBox from \"./components/CanvasBox.vue\";\nimport { generateData, readData } from \"./core/data-gen\";\nimport unobserve from \"./store\";\nimport download from \"downloadjs\";\n\nfunction parseField(value, type) {\n  switch (type) {\n    case \"string\":\n      return 0;\n    case \"date\":\n      return Math.floor(new Date(value) / (24 * 3600 * 1000));\n    case \"number\":\n      return parseFloat(value);\n  }\n}\n\nexport default {\n  name: \"App\",\n  components: {\n    CanvasBox,\n  },\n  data() {\n    return {\n      canvasWidth: 1000,\n      canvasHeight: 500,\n      width: 1000,\n      height: 500,\n      headers: [],\n      inferTypes: [],\n      aggregateAttr: 0,\n      timeAttr: 0,\n      valueAttr: 0,\n      chartConfigs: [],\n      filters: [],\n      layers: [\n        {\n          id: \"rep_layer\",\n          name: \"representative line\",\n          opacity: 1,\n        },\n        {\n          id: \"selectionCanvas\",\n          name: \"selected density\",\n          opacity: 0,\n        },\n        {\n          id: \"selectionLayer\",\n          name: \"selected line\",\n          opacity: 0.4,\n        },\n        {\n          id: \"canvas\",\n          name: \"density\",\n          opacity: 1,\n        },\n        {\n          id: \"raw_lines\",\n          name: \"raw line\",\n          opacity: 0,\n        },\n      ],\n    };\n  },\n  methods: {\n    eventHandler(type) {\n      this.$Spin.show();\n      if (type.startsWith(\"1\")) {\n        generateData(type.split(\"-\")[1]).then((data) => {\n          this.$Spin.hide();\n          this.preProcessData(data);\n          this.generateCharts();\n        });\n      } else if (type == \"2\") {\n        this.$refs.upload.handleClick();\n        this.$Spin.hide();\n      }\n    },\n    readFileHandler(file) {\n      this.$Spin.show();\n      readData(file).then((data) => {\n        this.$Spin.hide();\n        this.preProcessData(data);\n        this.generateCharts();\n      });\n      return false;\n    },\n    preProcessData(data) {\n      this.headers = data[0];\n      unobserve.headers = data[0];\n      unobserve.data = data.slice(1);\n      if (data.length > 1) {\n        this.inferTypes = data[1].map((attr) => {\n          if (attr.includes(\"-\") || attr.includes(\"/\")) {\n            let isDate = new Date(attr).toString();\n            if (isDate.startsWith(\"Invalid\")) {\n              return \"string\";\n            }\n            return \"date\";\n          }\n          if (/^\\d*(\\.\\d*)?$/.test(attr)) {\n            return \"number\";\n          }\n          return \"string\";\n        });\n        this.aggregateAttr = this.inferTypes.indexOf(\"string\");\n        this.timeAttr = this.inferTypes.indexOf(\"date\");\n        if (this.aggregateAttr < 0) this.aggregateAttr = 0;\n        if (this.timeAttr < 0) {\n          this.timeAttr = this.inferTypes.indexOf(\"number\");\n          if (this.aggregateAttr === this.timeAttr)\n            this.timeAttr = this.inferTypes.indexOf(\n              \"number\",\n              this.aggregateAttr + 1\n            );\n        }\n        if (this.timeAttr < 0) this.timeAttr = 0;\n        this.valueAttr = this.inferTypes.indexOf(\"number\");\n        if (\n          this.valueAttr === this.timeAttr ||\n          this.valueAttr === this.aggregateAttr\n        )\n          this.valueAttr = this.inferTypes.indexOf(\"number\", this.timeAttr + 1);\n        if (this.valueAttr < 0) this.valueAttr = 0;\n      }\n    },\n    generateCharts() {\n      this.width = this.canvasWidth;\n      this.height = this.canvasHeight;\n      this.$Spin.show();\n      if (\n        this.headers[this.aggregateAttr] !=\n          (this.chartConfigs.length && this.chartConfigs[0].aggregateName) ||\n        !this.chartConfigs.find(\n          (config) => config.valueIndex === this.valueAttr\n        )\n      ) {\n        unobserve.aggregatedData = [];\n        let aggrMap = new Map();\n        const infers = {\n          [this.timeAttr]: this.inferTypes[this.timeAttr],\n          [this.valueAttr]: this.inferTypes[this.valueAttr],\n        };\n        unobserve.data.forEach((row, i) => {\n          let aggrList;\n          const aggrKey = row[this.aggregateAttr];\n          if (!aggrMap.has(aggrKey)) {\n            aggrList = {\n              ref: [],\n              [this.timeAttr]: [],\n              [this.valueAttr]: [],\n            };\n            aggrMap.set(aggrKey, aggrList);\n          } else {\n            aggrList = aggrMap.get(aggrKey);\n          }\n          aggrList.ref.push(i);\n          aggrList[this.timeAttr].push(\n            parseField(row[this.timeAttr], infers[this.timeAttr])\n          );\n          aggrList[this.valueAttr].push(\n            parseField(row[this.valueAttr], infers[this.valueAttr])\n          );\n        });\n        for (let [key, aggregated] of aggrMap.entries()) {\n          unobserve.aggregatedData.push(\n            Object.entries(aggregated).reduce(\n              (p, v) => {\n                return {\n                  ...p,\n                  [v[0]]: new Float32Array(v[1]),\n                };\n              },\n              { key }\n            )\n          );\n        }\n        aggrMap.clear();\n      }\n      if (this.valueAttr === this.timeAttr) {\n        this.chartConfigs = [];\n      } else {\n        this.chartConfigs = [\n          {\n            aggregateIndex: this.aggregateAttr,\n            timeIndex: this.timeAttr,\n            valueIndex: this.valueAttr,\n            aggregateName: this.headers[this.aggregateAttr],\n            timeName: this.headers[this.timeAttr],\n            valueName: this.headers[this.valueAttr],\n            filter: undefined,\n            emitFilter: undefined,\n          },\n        ];\n        unobserve.aggregateName = this.headers[this.aggregateAttr];\n        unobserve.slopePixelCache = null;\n        unobserve.inferX = this.inferTypes[this.timeAttr];\n      }\n      this.filters = this.chartConfigs.map((_) => undefined);\n      this.$Spin.hide();\n    },\n    handleFilterChange(index, filter) {\n      this.filters.splice(index, 1, filter);\n      if (!this.filters.find((f) => f)) {\n        this.chartConfigs.forEach((config) => {\n          this.$set(config, \"filter\", undefined);\n        });\n        return;\n      }\n      const set = new Float32Array(\n        new Set(\n          this.filters\n            .reduce((p, v) => [...p, ...(v ? v : [])], [])\n            .filter((x) => !this.filters.find((f) => !(f && f.includes(x))))\n        )\n      );\n      this.chartConfigs.forEach((config) => {\n        this.$set(config, \"filter\", set);\n      });\n    },\n    exportFig() {\n      // exportCanvas(\n      //     [this.$refs.canvas, this.$refs.canvasOverlay, this.$refs.canvasRawLine],\n      //     this.upsideDown\n      // );\n      exportCanvas(\n        unobserve.layers\n          .map((layer) => document.getElementById(layer.id))\n          .reverse(),\n        unobserve.upsideDown,\n        unobserve.layers.map((layer) => layer.opacity).reverse()\n      );\n    },\n    exportData(mode) {\n      let ids = unobserve[mode ? \"repIds\" : \"selectedLines\"];\n      if (!ids || !ids.length) return;\n      let previousName = \"\";\n      let previousId = -1;\n      const exportData = unobserve.data.filter((raw) => {\n        if (raw[this.aggregateAttr] !== previousName) {\n          previousId++;\n          previousName = raw[this.aggregateAttr];\n        }\n        if (ids.includes(previousId)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      download(\n        unobserve.headers.join(\",\") +\n          \"\\n\" +\n          exportData.map((d) => d.join(\",\")).join(\"\\n\"),\n        \"export.csv\",\n        \"text/csv\"\n      );\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n#app {\n  min-width: 1850px;\n}\n\n.layout {\n  border: 1px solid #d7dde4;\n  background: #f5f7f9;\n  position: relative;\n  border-radius: 4px;\n}\n\n.layout-logo {\n  float: left;\n  position: relative;\n  left: 20px;\n  color: white;\n  z-index: 999;\n}\n\n.layout-nav {\n  // width: 420px;\n  float: right;\n  margin: 0 auto;\n  margin-right: 20px;\n}\n\n.layout-footer-center {\n  text-align: center;\n}\n\n.sticky-content > * {\n  position: sticky;\n  top: 0;\n}\n.ivu-poptip-body {\n  padding: 0 !important;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=e20941be&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport iView from \"view-design\";\n\nimport \"view-design/dist/styles/iview.css\";\nimport locale from \"view-design/dist/locale/en-US\"\n\nVue.use(iView, {locale});\n\nVue.config.productionTip = false;\n\nnew Vue({\n  render: h => h(App)\n}).$mount(\"#app\");\n\n// Detect integrated GPU\nconst canvas = document.createElement(\"canvas\");\nconst gl = canvas.getContext(\"webgl\");\nconst debugInfo = gl.getExtension(\"WEBGL_debug_renderer_info\");\nconst gpuInfo = gl\n  .getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)\n  .toLowerCase();\n","export default __webpack_public_path__ + \"795f7099aa693d52f5fcf4efb9c47976.csv\";","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./expandRow.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./expandRow.vue?vue&type=style&index=0&lang=css&\"","export default __webpack_public_path__ + \"455214f84fb18c0faf82859fa62bd0ae.csv\";","export default __webpack_public_path__ + \"0e775b5251260720ce1235fc0b4d6138.csv\";","export default __webpack_public_path__ + \"b9c8219653d8ec39d5473283116881ee.csv\";"],"sourceRoot":""}